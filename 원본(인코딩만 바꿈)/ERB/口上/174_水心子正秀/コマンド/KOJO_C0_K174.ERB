;≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡
;eraeraA新口上テンプレートv1.00
;174をキャラ番号に置換して使用してください(フェリシアーノなら1、アルフレッドなら10)
;≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡≡
;==================================================
;○○口上
;==================================================
;コマンド口上の直前に呼ばれる
;RETURN 1すると口上が表示されなくなり、地の文だけ表示される
;個別に設定したい場合はこの関数内でスキップする/しないの判定を行う
;-------------------------------------------------
@KOJO_TRAIN_MESSAGE_SKIP_K174

;==================================================
;特定の条件を満たしている場合、コマンドを実行する度にソースが追加
;露出癖とかマゾっ気とか趣味に合ったコマンドや状態で体力・気力回復する仕様に。
;マゾっ気くそ高いのにすぐ気絶するのなんとかしたかったんでテスト。
;==================================================
;奉仕系のコマンド実行時に体力／気力回復。
IF ABL:奉仕精神 >= 3
	SELECTCASE SELECTCOM
		;受け身奉仕は体力回復
		CASE 70,71,73 TO 80,85 TO 87,317,420,421,422
			BASE:0 += ABL:奉仕精神*2
		;攻め奉仕は気力回復
		CASE 220 TO 225,260,261,263,264,318
			BASE:1 += ABL:奉仕精神*2
		;体力気力両方回復する
		CASE 243 TO 245,319,503,504
			BASE:0 += ABL:奉仕精神*2
			BASE:1 += ABL:奉仕精神*2
	ENDSELECT
ENDIF

;服を着てないと気力回復、露出プレイ中は体力回復。
IF ABL:露出癖 >= 3
	;全裸ルート
	IF !TEQUIP:全身上着 && !TEQUIP:上衣 && !TEQUIP:下衣 && !TEQUIP:下着（上） && !TEQUIP:下着（下） && !TEQUIP:特殊２ && !TEQUIP:特殊１
		BASE:1 += ABL:露出癖*2
	;半裸ルート
	ELSEIF (TEQUIP:全身上着 || (TEQUIP:上衣 && TEQUIP:下衣)) && !TEQUIP:下着（上） && !TEQUIP:下着（下）
		BASE:1 += ABL:露出癖*2
	ENDIF
	SIF TEQUIP:ビデオカメラ || TEQUIP:野外プレイ || TEQUIP:羞恥プレイ || SELECTCOM == 3
		BASE:0 += ABL:露出癖*2
ENDIF

;拘束されてると気力回復。
;苦痛コマンド実行時に体力回復。
IF ABL:マゾっ気 >= 3
	SIF TEQUIP:縄 || TEQUIP:アイマスク || TEQUIP:ボールギャグ || TEQUIP:貞操帯 || TEQUIP:射精止め || TEQUIP:全身上着 == 9
		BASE:1 += ABL:マゾっ気*2
	SELECTCASE SELECTCOM
		CASE 16,25,44,56,62,140 TO 155
			BASE:0 += ABL:マゾっ気*2
	ENDSELECT
ENDIF

;奴隷攻めコマンド実行時に体力／気力回復。
IF ABL:サドっ気 >= 3
	SIF TEQUIP:靴 > 0 && SELECTCOM == 80
		BASE:0 += ABL:サドっ気*2
	SIF ABL:PLAYER:マゾっ気 >= 3 && (SELECTCOM == 226 || SELECTCOM == 227)
		BASE:0 += ABL:サドっ気*2
		BASE:1 += ABL:サドっ気*2
	SIF SELECTCOM >= 226 && SELECTCOM <= 227
		BASE:1 += ABL:サドっ気*2
ENDIF

;自慰をすると体力・気力回復。
IF ABL:自慰中毒 >= 3
	SELECTCASE SELECTCOM
		CASE 4,5,6,7
			BASE:1 += ABL:自慰中毒*2
	ENDSELECT
ENDIF

;精液飲んで体力回復。
;精液がもらえそうなコマンド実行時は気力回復。
IF ABL:精液中毒 >= 3
	SIF TFLAG:0 == 0 && TFLAG:43 == 13
		BASE:0 += ABL:精液中毒*2
	SELECTCASE SELECTCOM
		CASE 70 TO 75,226,227,407,420,421,516
			BASE:1 += ABL:精液中毒*2
		CASE 410,412
			BASE:0 += ABL:精液中毒*2
	ENDSELECT
ENDIF

;セックスすると体力・気力回復。淫乱√なら特殊セックスでも回復。
IF ABL:セックス中毒 >= 3
	IF TALENT:淫乱 || TALENT:娼婦
		SELECTCASE SELECTCOM
			CASE 322,381,405,406,430,431,511 TO 515,517 TO 525
				BASE:0 += ABL:セックス中毒*2
				BASE:1 += ABL:セックス中毒*2
		ENDSELECT
	ENDIF
	SELECTCASE SELECTCOM
		CASE 100 TO 116,260 TO 265,507 TO 510,526
			BASE:0 += ABL:セックス中毒*2
			BASE:1 += ABL:セックス中毒*2
	ENDSELECT
ENDIF

;スカ系コマンド実行で体力回復。
;便意／尿意のあるときに気力回復。
IF ABL:スカ中毒 >= 3
	SIF BASE:4 >= 60 || BASE:6 >= 60
		BASE:1 += ABL:スカ中毒*2
	SELECTCASE SELECTCOM
		CASE 182 TO 185,285,286,302,304
			BASE:0 += ABL:スカ中毒*2
	ENDSELECT
	;動くかわからんけど一応入れてみる
	SIF TFLAG:58 == 1 || TFLAG:68 == 1
		BASE:0 += ABL:スカ中毒*2
ENDIF



;==================================================
;その他制御
;==================================================
;装備品補完口上を使用しない
;TFLAG:59 = 1

;ボールギャグ付き、触手口辱中の場合は地の文のみ
SIF TEQUIP:ボールギャグ || TEQUIP:触手口辱
	RETURN 1

;崩壊している場合は地の文のみ
SIF TALENT:崩壊
	RETURN 1

;主人が清麿でない　もしくは助手がいる場合
SIF NO:MASTER != 176 || ASSI > 0
	RETURN 1


;==================================================
;口上制御
;==================================================
;CFLAG5005で制御
;基本的な優先度は　怯え＞妄執＞反発蕩け＞反発＞蕩け強＞マゾ＞サド＞蕩け弱＞素＞祖
;※場合によっては前後する

;怯え　恐怖LV4以上、もしくは恐怖LV3以上+妄執フラグオン+妄信未取得、もしくは恐怖LV3+未陥落
SIF PALAM:恐怖 >= PALAMLV:4 || (PALAM:恐怖 >= PALAMLV:3 && (CFLAG:5002 && 4) && TALENT:妄信 == 0) || (PALAM:恐怖 >= PALAMLV:3 && !KANRAKU(TARGET))
	CFLAG:5005 |= 64

;妄執　妄執フラグオン
SIF (CFLAG:5002 & 4)
	CFLAG:5005 |= 4

;反発蕩け　欲情LV4+(反発刻印3、もしくはPALAM:反感LV4以上)
SIF PALAM:欲情 >= 4 && (MARK:反発刻印 == 3 || PALAM:反感 >= PALAMLV:4)
	CFLAG:5005 |= 128

;反発　反発刻印3、もしくはPALAM:反感LV4以上
SIF MARK:反発刻印 == 3 || PALAM:反感 >= PALAMLV:4
	CFLAG:5005 |= 32

;蕩け強　陥落済み+欲情LV4、もしくは未陥落+欲情LV5　前提：反発刻印3未満、もしくはPALAM:反感LV4未満
SIF ((KANRAKU(TARGET) && PALAM:欲情 >= PALAMLV:4) || (!KANRAKU(TARGET) && PALAM:欲情 >= PALAMLV:5)) && (MARK:反発刻印 != 3 || PALAM:反感 < PALAMLV:4)
	CFLAG:5005 |= 16

;排他　反発と蕩け強が両方付いた場合は反発のみとする
SIF (CFLAG:5005 & 32) && (CFLAG:5005 & 16)
	CFLAG:5005 -= 16

;排他　怯えと蕩け強が両方付いてて、開始時に発情イベント見てた場合は蕩け強のみとする
SIF (CFLAG:5005 & 64) && (CFLAG:5005 & 16) && (CFLAG:5004 & 4)
	CFLAG:5005 -= 64

;マゾ　TALENT:マゾ、もしくはマゾっ気5以上
SIF TALENT:マゾ || ABL:マゾっ気 >= 5
	CFLAG:5005 |= 256

;サド　TALENT:サド、もしくはサドっ気5以上
SIF TALENT:サド || ABL:サドっ気 >= 5
	CFLAG:5005 |= 512

;蕩け弱　欲情LV3以上
SIF PALAM:欲情 >= PALAMLV:3
	CFLAG:5005 |= 8

;素　真友√
SIF (CFLAG:5001 & 2)
	CFLAG:5005 |= 2

;祖　ハートフルモード
SIF (CFLAG:5001 & 1)
	CFLAG:5005 |= 1


;==================================================
;ランダム小口上
;==================================================
;絶頂回数
IF (EX:0 + EX:1 + EX:2 + EX:3 >= 20)
	PRINTFORML 二十回以上の絶頂を経て、%CALLNAME%は頭のネジが飛んでしまったようだ
	PRINTFORML だらしなく顔を緩ませ、呂律の回らない口調で品の無い喘ぎを洩らしている
ELSEIF (EX:0 + EX:1 + EX:2 + EX:3 >= 10) && (EX:0 + EX:1 + EX:2 + EX:3 < 20)  && MARK:反発刻印 != 3
	PRINTFORML 絶頂を何度も味あわされ、%CALLNAME%は息も絶え絶えに喘いでいる
ENDIF

RETURN 0



