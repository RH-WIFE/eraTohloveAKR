;=======================================================
;調教開始時に、着衣の初期設定を行う
;着ている服の詳細はここを参照してください
;※衣装を増やす場合の可変必要箇所はCLOTHES2.ERBに移動させました
;=======================================================
@EVENTTRAIN
#PRI
;デフォ動物耳以外の動物耳はいったん解除。
SIF TALENT:動物耳 > 10
	TALENT:動物耳 = 0
;初期衣装が記録されているとき、読み込みます
;※CFLAG:120は、全裸キャラ以外の簡易初調教記録フラグにもなります
B = CFLAG:120
C = NO:TARGET
VARSET T


;=======================================================
;衣装のファイル膨張してるので分けます
CALL CLOTHES_SET(TARGET)
;=======================================================


;-------------------------------------------------
;デート用にいじってます。各キャラの正装？を記録。特殊と顔装飾は別個判定。
;-------------------------------------------------
;特殊衣装は基本的にコスプレ扱い
IF TARGET >= 0
	;着衣状態の保存処理
	REPEAT 7
		E = COUNT
		D:E = T:E
	REND
	D:9 = T:9
	;フラグいっぱい使うの申し訳ないので一個に押し込みます
	CFLAG:120 = D:0 + (D:1 * 10) + (D:2 * 100) + (D:3 * 1000) + (D:4 * 10000) + (D:5 * 100000) + (D:6 * 1000000) + (D:9 * 10000000)
ENDIF


;=======================================================
;特殊衣装が有効のときは、それを着せる
;=======================================================
;-------------------------------------------------
;キャラ毎に設定された衣装とか。※現在未実装
;-------------------------------------------------
;SIF CFLAG:22
;	CALL CLOTHES_SET2(TARGET)
;-------------------------------------------------
;着衣設定（内番）が有効
;-------------------------------------------------
SIF FLAG:1 == 10
	CALL CLOTHES_SET3(TARGET)
;-------------------------------------------------
;着衣設定（軽装）が有効　かつ　軽装入手済みのキャラ
;-------------------------------------------------
SIF FLAG:1 == 9 && CFLAG:614 == 1
	CALL CLOTHES_SET4(TARGET)

;-------------------------------------------------
;独自設定が有効　かつ　衣装の独自設定が設定済み（※全裸は不可）
;-------------------------------------------------
;CFLAG:133にTEQUIP:0～TEQUIP:4（特殊、靴下、下着（下）、下着（上）、下衣）
;CFLAG:134にTEQUIP:5～TEQUIP:9（上衣、全身上着、頭部装飾、眼鏡、靴）
;CFLAG:135にTEQUIP:10（アクセサリー）を記録
IF FLAG:1 == 99 && (CFLAG:133 > 0 || CFLAG:134 > 0 || CFLAG:135 > 0)
	REPEAT 11
		SELECTCASE COUNT
			CASE 0 TO 4
				LOCAL = COUNT
				;N桁目を求めたいときは　10のN乗の余りを10のN-1乗で割ればよい
				;例）8,7桁目を求めたいときは　COUNT=LOCAL= 3となり、10の8乗(=(3+1)*2)の余りを10の6乗(=3*2)で割る
				LOCAL:1 = CFLAG:133 % POWER(10, (LOCAL+1)*2) / POWER(10, LOCAL*2)
				
				T:COUNT = LOCAL:1
			CASE 5 TO 9
				LOCAL = COUNT - 5
				;処理は上と同様
				LOCAL:1 = CFLAG:134 % POWER(10, (LOCAL+1)*2) / POWER(10, LOCAL*2)
				
				T:COUNT = LOCAL:1
			;アクセサリー
			CASEELSE
				T:10 = CFLAG:135
		ENDSELECT
	REND
ENDIF
;-------------------------------------------------
;実際に着せるのはここ
;-------------------------------------------------
;服の種別が全部で11種類あるので、Ａで数える。
REPEAT 11
	A = COUNT
	TEQUIP:A = T:A
REND

;初回に調教フラグの有無をチェック
IF B == 0
	REPEAT CHARANUM
		A = NO:COUNT
		X = 999 + A
		SIF A != 0
			FLAG:X = 0
	REND
	;フリーミッションモードのとき
	SIF FLAG:5 == 8
		CALL FREE_MISSION_SALEITEM_CHECK
ENDIF
;初期着衣設定に応じて、服の設定をする
;前回設定…全裸デフォキャラ以外は初回にスキップ
A = 0
;-------------------------------------------------
;前回終了時
;-------------------------------------------------
IF FLAG:1 == 4  && B != 0
	REPEAT 10
		A = COUNT + 123
		TEQUIP:COUNT = CFLAG:A
	REND
	TEQUIP:アクセサリ = CFLAG:122
	;エプロン、アイマスクは強制取り外し
	SIF TEQUIP:特殊１ == 2
	TEQUIP:特殊１ = 0
	SIF TEQUIP:特殊３ == 2
	TEQUIP:特殊３ = 0
;-------------------------------------------------
;全裸
;-------------------------------------------------
ELSEIF FLAG:1 == 3
	TEQUIP:特殊１ = 0
	TEQUIP:特殊２ = 0
	TEQUIP:下着（下） = 0
	TEQUIP:下着（上） = 0
	TEQUIP:下衣 = 0
	TEQUIP:上衣 = 0
	TEQUIP:全身上着 = 0
	TEQUIP:靴 = 0
	;帽子/ネクタイ/リボンタイははずす
	CLEARBIT TEQUIP:アクセサリ, 1
	CLEARBIT TEQUIP:アクセサリ, 3
	CLEARBIT TEQUIP:アクセサリ, 4
;-------------------------------------------------
;下着姿
;-------------------------------------------------
ELSEIF FLAG:1 == 2
	TEQUIP:下衣 = 0
	TEQUIP:上衣 = 0
	TEQUIP:全身上着 = 0
	;帽子/ネクタイ/リボンタイははずす
	CLEARBIT TEQUIP:アクセサリ, 1
	CLEARBIT TEQUIP:アクセサリ, 3
	CLEARBIT TEQUIP:アクセサリ, 4
;-------------------------------------------------
;半裸(上)
;-------------------------------------------------
ELSEIF FLAG:1 == 5
	TEQUIP:下着（上） = 0
	TEQUIP:上衣 = 0
	TEQUIP:全身上着 = 0
	;帽子/ネクタイ/リボンタイははずす
	CLEARBIT TEQUIP:アクセサリ, 1
	CLEARBIT TEQUIP:アクセサリ, 3
	CLEARBIT TEQUIP:アクセサリ, 4
	
	;上下セットならど下も脱げる
	SIF TEQUIP:下衣 >= 1 && TEQUIP:下衣 <= 10 || TEQUIP:下衣 == 25
		TEQUIP:下衣 = 0
;-------------------------------------------------
;半裸(下)
;-------------------------------------------------
ELSEIF FLAG:1 == 6
	TEQUIP:下着（下） = 0
	TEQUIP:下衣 = 0
	;上下セットならど上も脱げる
	SIF TEQUIP:上衣 >= 1 && TEQUIP:上衣 <= 10 || TEQUIP:上衣 == 25
		TEQUIP:上衣 = 0
;-------------------------------------------------
;ノーパン
;-------------------------------------------------
ELSEIF FLAG:1 == 1
	TEQUIP:下着（下） = 0
ENDIF

;-------------------------------------------------
;動物耳を反映させる。オプションで設定を変更した場合用。
;-------------------------------------------------
SIF TEQUIP:頭部装飾 == 1
	TALENT:動物耳 = 11
SIF TEQUIP:頭部装飾 == 2
	TALENT:動物耳 = 12
SIF TEQUIP:頭部装飾 == 3
	TALENT:動物耳 = 13
VARSET T


;=======================================================
@EVENTEND
;=======================================================
;調教終了後の処理
#PRI
IF TARGET >= 0
	;破れたストッキングは脱がす
	IF (TEQUIP:特殊２ == 5 || TEQUIP:特殊２ == 6) && TFLAG:55
		TEQUIP:特殊２ = 0
	ENDIF
	;着衣状態の保存処理
	REPEAT 10
		A = COUNT + 123
		CFLAG:A = TEQUIP:COUNT
	REND
	CFLAG:122 = TEQUIP:アクセサリ
ENDIF

;初期衣装が前回設定の場合、全員の着衣状態を取得
;BEGIN TRAINで全てのキャラのTEQUIPに0が代入されるため
IF FLAG:1 == 4
	FOR LOCAL, 0, CHARANUM
		REPEAT 10
			A = COUNT + 123
			TEQUIP:(LOCAL):COUNT = CFLAG:(LOCAL):A
		REND
		TEQUIP:(LOCAL):アクセサリ = CFLAG:(LOCAL):122
	NEXT
ENDIF

;初期衣装が前回設定でない場合、デフォ動物耳以外の動物耳は解除。
SIF FLAG:1 != 4 && TALENT:動物耳 > 10
	TALENT:動物耳 = 0

;=======================================================
;着衣の表示（「着替えさせる」選択時のページ）
;=======================================================
@CLOTHES_CHANGE
C = NO:TARGET

A = 0
Y = 0
VARSET T
VARSET X
VARSET Z

PRINTL 
PRINTFORML 【%CALLNAME:TARGET%】の着衣を設定します
PRINTL 
CALL CLOTHES_LIST

IF (CFLAG:121 & 1024) == 0
	;アクセサリ
	B = 0
	E = 0
	CALL ACCESSORY
ENDIF

PRINTL 
SIF TEQUIP:特殊１ != 2 && TEQUIP:特殊３ != 2
	PRINT [200]外出着の着用　
;表示制限
PRINT [400]表示制限　

SIF TEQUIP:特殊１ || TEQUIP:特殊２ || TEQUIP:下着（下） || TEQUIP:下着（上） || TEQUIP:下衣 || TEQUIP:上衣 || TEQUIP:全身上着 || TEQUIP:靴
	PRINT [800]ひんむく　
PRINTL [900]戻る
DRAWLINE
PRINTFORM 現在：
CALL PRINT_CLOTHES
SIF TEQUIP:アクセサリ
	CALL PRINT_ACCESSORY

PRINTL 
PRINTL 

$INPUT_LOOP
INPUT
Z = RESULT

SIF Z > 999
	GOTO INPUT_LOOP


;----------------------------------------------------
;戻る
;----------------------------------------------------
IF Z == 900
	RETURN 0

;----------------------------------------------------
;表示制限関係
;----------------------------------------------------
ELSEIF Z == 400
	;詳細設定画面に飛ぶ
	CALL CLOTHES_CONTROL
	RESTART

;----------------------------------------------------
;外出着の着用
;----------------------------------------------------
ELSEIF Z == 200
	;汚れ処理のため先に全裸にしてしまう
	;事前に動物耳解除
	SIF TEQUIP:頭部装飾 == 1 || TEQUIP:頭部装飾 == 2 || TEQUIP:頭部装飾 == 3
		TALENT:動物耳 = 0
	REPEAT 11
		A = COUNT
		;着替え不必要な下着（靴下と上下）以外の着衣汚れをリセット。眼鏡もそのまま。
		IF (TEQUIP:A != T:A && A != 1 && A != 2 && A != 3) || A != 8
			TEQUIP:A = 0
			X = 8 + A
			STAIN:X = 0
		ENDIF
	REND
	CALL CLOTHES_SET(TARGET)
	;汚れ
	REPEAT 11
		A = COUNT
		CALL CLOTHES_STAIN
		TEQUIP:A = T:A
		COUNT = A
	REND
	RESTART

;----------------------------------------------------
;ひんむく
;----------------------------------------------------
ELSEIF Z == 800 && (TEQUIP:特殊１ || TEQUIP:特殊２ || TEQUIP:下着（下） || TEQUIP:下着（上） || TEQUIP:下衣 || TEQUIP:上衣 || TEQUIP:全身上着 || TEQUIP:靴)
	REPEAT 10
		A = 9 - COUNT
		SIF A == 7 || A == 8
			CONTINUE
		SIF A == 2 && TEQUIP:下着（下） == 5
			CONTINUE
		IF TEQUIP:A
			T:A = TEQUIP:A
			TEQUIP:A = 0
			CALL CLOTHES_MESSAGE
		ENDIF
		X = 8 + A
		STAIN:X = 0
		;マフラー、ネクタイ、リボンタイ、マントは一緒に外す
		SIF TEQUIP:アクセサリ & 1
			TEQUIP:アクセサリ -= 1
		SIF TEQUIP:アクセサリ & 4
			TEQUIP:アクセサリ -= 4
		SIF TEQUIP:アクセサリ & 8
			TEQUIP:アクセサリ -= 8
		SIF TEQUIP:アクセサリ & 256
			TEQUIP:アクセサリ -= 256
		
		TEQUIP:特殊１ = 0
	REND
	RESTART


;アクセサリは150-200に格納。
ELSEIF Z >= 150 && Z < 200
	CALL ACCESSORY_CHANGE
	RESTART

;コスプレ処理。
;番号移動して処理を簡略化してみた。
;我慢できずに増やしてしまったんだぜ
ELSEIF Z != 200 && Z != 400 && Z != 800 && Z != 900
	;Zの10の位が0のときは全身上着（ただし、200、300などは使えない）
	B = Z / 10
	B = B % 10
	IF B == 0
		;全身上着のいちばん上の桁が足りなくなった……ので(Z = X0X)において指定。TEQUIP:6 == XX
		A = 6
		;Zの100の位をYの10の位にし、Zの1の位をYの1の位に足す。服の種類の指定に使用する
		Y = (Z / 10) + (Z % 100)
	ELSEIF Z > 100
		;Aに100の位を格納・着用部位の指定に使用する(6までは数値が反転してるので元に戻す)
		A = Z / 100
		SIF A <= 6
			A = 6 - A
		;Yに10の位以下を格納・服の種類の指定に使用する
		Y = Z % 100
	ELSE
		;Aに10の位を格納・着用部位の指定に使用する(6までは数値が反転してるので元に戻す)
		A = Z / 10
		SIF A <= 6
			A = 6 - A
		;Yに1の位を格納・服の種類の指定に使用する
		Y = Z % 10
	ENDIF
	SIF A > 9
		GOTO INPUT_LOOP
	;T:Xに仮格納。脱がす場合も脱がす予定の衣装
	T:A = Y

	;エプロン判定。
	;着脱と口上呼び出しは新妻プレイ側で処理。表示に制限かけたので基本的には大丈夫なはずですが念には念を……
	
	;PREVCOM = -2になるのは、衣装の独自設定画面から呼び出された場合
	;貞操帯判定
	IF Z == 45 && X:45 == 1 && PREVCOM != -2
		CALL COM_ABLE133
		IF RESULT
			SELECTCOM = 133
			CALL COM133
			CALL SP_CLOTHES
			RESTART
		ELSE
			PRINTFORMW 今は貞操帯をつけられない。
			RESTART
		ENDIF
	ENDIF
	;エプロン（新妻プレイ）判定
	IF Z == 62 && X:62 == 1 && PREVCOM != -2
		CALL COM_ABLE319
		IF RESULT && PREVCOM != -2
			SELECTCOM = 319
			CALL COM319
			CALL SP_CLOTHES
			RESTART
		;着衣設定が内番衣装　キャラが小豆、福島　の場合はエプロンが着脱可能
		ELSEIF FLAG:1 == 10 && (C == 148 || C == 204)
		ELSE
			PRINTFORMW 新妻プレイを提案するにはまだ早すぎたようだ
			RESTART
		ENDIF
	ENDIF
	;アイマスク判定
	IF Z == 82 && X:82 == 1 && PREVCOM != -2
		CALL COM_ABLE131
		IF RESULT && PREVCOM != -2
			SELECTCOM = 131
			CALL COM131
			CALL SP_CLOTHES
			RESTART
		ELSE
			PRINTFORMW 今はアイマスクをつけられない。
			RESTART
		ENDIF
	ENDIF
	
	;今着ている物と、RESULTが同じ場合
	IF TEQUIP:A == Y
		;脱がせた後の状態が分かるように脱がせてからテキストを呼ぶように変更
		TEQUIP:A = 0
		CALL CLOTHES_MESSAGE
		
		;靴下を脱がすとき靴も脱げる
		IF A == 1
			TEQUIP:靴 = 0
			
			;ストッキングを脱がす時スカート以外の下衣も脱げる
			;また、もし破れていなければITEMに足す
			IF BOTTOMS(TARGET) >= 3
				TEQUIP:下衣 = 0
				IF TEQUIP:特殊２ == 5 || TEQUIP:特殊２ == 6 || TEQUIP:特殊２ == 7
					TFLAG:55 = 0
					IF TFLAG:55 == 0
						SIF TEQUIP:特殊２ == 5
							ITEM:36 += 1
						SIF TEQUIP:特殊２ == 6
							ITEM:37 += 1
					ENDIF
				ENDIF
			ENDIF
		ENDIF
		
		;下着（下）を脱がす時スカート以外の下衣も脱げる
		IF A == 2 && (BOTTOMS(TARGET) >= 3 || TEQUIP:特殊２ == 5 || TEQUIP:特殊２ == 6 || TEQUIP:特殊２ == 7)
			TEQUIP:下衣 = 0
			
			;ストッキング、タイツのとき、靴下と靴が脱げる
			IF TEQUIP:特殊２ == 5 || TEQUIP:特殊２ == 6 || TEQUIP:特殊２ == 7
				TEQUIP:特殊２ = 0
				TEQUIP:靴 = 0
				IF TFLAG:55 == 0
					SIF TEQUIP:特殊２ == 5
						ITEM:36 += 1
					SIF TEQUIP:特殊２ == 6
						ITEM:37 += 1
				ENDIF
			ENDIF
		ENDIF
		
		;下着（上）を脱がす時上衣と全身上着も脱げる
		IF A == 3
			TEQUIP:上衣 = 0
			TEQUIP:全身上着 = 0
			;ネクタイとリボンタイを外す
			TEQUIP:アクセサリ -= TEQUIP:アクセサリ & 4
			TEQUIP:アクセサリ -= TEQUIP:アクセサリ & 8
		ENDIF
		
		;上衣を脱がす時、全身上着も脱げる
		IF A == 5 || A == 6
			IF TEQUIP:下着（上） != 3
				;ネクタイとリボンタイを外す
				TEQUIP:アクセサリ -= TEQUIP:アクセサリ & 4
				TEQUIP:アクセサリ -= TEQUIP:アクセサリ & 8
			ENDIF
			TEQUIP:全身上着 = 0
		ENDIF
		
		;セット衣装を脱いだとき、もう片方も脱げる
		IF T:A >= 1 && T:A <= 10 || T:A == 25
			TEQUIP:上衣 = 0
			TEQUIP:下衣 = 0
		ENDIF
		
		;脱ぐと着衣の汚れがリセットされる
		X = 8 + A
		STAIN:X = 0
		CALL CLOTHES_STAIN
	;服を着せる場合
	ELSE
		;着用条件が満たされてない(番号が表示されてない)場合は戻る
		SIF X:Z == 0
			GOTO INPUT_LOOP
		
		;ストッキング・タイツは着るごとに一枚減る。ストッキングびりびりフラグ初期化。
		IF A == 1
			IF T:1 == 5 || T:1 == 6
				SIF T:1 == 5
					ITEM:36 -= 1
				SIF T:1 == 6
					ITEM:37 -= 1
				TFLAG:55 = 0
			ENDIF
		ENDIF
		
		;頭部装飾で動物耳装着判定
		IF A == 7
			SIF Y == 1
				TALENT:動物耳 = 11
			SIF Y == 2
				TALENT:動物耳 = 12
			SIF Y == 3
				TALENT:動物耳 = 13
			SIF Y > 3 && Y < 9 && (TEQUIP:頭部装飾 == 1 || TEQUIP:頭部装飾 == 2 || TEQUIP:頭部装飾 == 3)
				TALENT:動物耳 = 0
		ENDIF
		
		;エプロン、アイマスクが外れるときに口上呼び出し。A値をLOCAL:1に仮格納。
		LOCAL:1 = A
		IF TEQUIP:特殊１ == 2 && T:A != 2 && A == 0
			SELECTCOM = 319
			CALL COM319
			CALL SP_CLOTHES
		ENDIF
		IF TEQUIP:特殊３ == 2 && T:A != 2 && A == 8
			SELECTCOM = 131
			CALL COM131
			CALL SP_CLOTHES
		ENDIF
		IF TEQUIP:下着（下） == 5 && T:A != 5 && A == 2
			SELECTCOM = 133
			CALL COM133
			CALL SP_CLOTHES
		ENDIF
		A = LOCAL:1
		
		;脱げる処理を先にした方が汚れ判定にはいいかな
		;上衣を着る時全身上着が脱げる
		IF A == 5
			TEQUIP:全身上着 = 0
		ENDIF
		;靴下を着るとき靴が脱げる
		IF A == 1
			TEQUIP:靴 = 0
			;ストッキング、タイツ、レギンスのときはズボン系も脱げる
			IF (TEQUIP:特殊２ == 5 || TEQUIP:特殊２ == 6 || TEQUIP:特殊２ == 7) && BOTTOMS(TARGET) >= 3
				;セット衣装を脱いだとき、もう片方も脱げる
				SIF TEQUIP:下衣 >= 1 && TEQUIP:下衣 <= 10 || TEQUIP:下衣 == 25
					TEQUIP:上衣 = 0
				TEQUIP:下衣 = 0
			ENDIF
		ENDIF
		;下着（下）を着るときズボン系、ストッキング、タイツ、レギンスと靴が脱げる
		IF A == 2
			IF BOTTOMS(TARGET) >= 3
				;セット衣装を脱いだとき、もう片方も脱げる
				SIF TEQUIP:下衣 >= 1 && TEQUIP:下衣 <= 10 || TEQUIP:下衣 == 25
					TEQUIP:上衣 = 0
				TEQUIP:下衣 = 0
			ENDIF
			IF TEQUIP:特殊２ == 5 || TEQUIP:特殊２ == 6 || TEQUIP:特殊２ == 7
				TEQUIP:特殊２ = 0
				TEQUIP:靴 = 0
				IF TFLAG:55 == 0
					SIF TEQUIP:特殊２ == 5
						ITEM:36 += 1
					SIF TEQUIP:特殊２ == 6
						ITEM:37 += 1
				ENDIF
			ENDIF
		ENDIF
		;下着（上）を着るとき上衣と全身上着が脱げる
		IF A == 3
			SIF TEQUIP:上衣 >= 1 && TEQUIP:上衣 <= 10 || TEQUIP:上衣 == 25
				TEQUIP:下衣 = 0
			TEQUIP:上衣 = 0
			TEQUIP:全身上着 = 0
			;ネクタイとリボンタイを外す
			TEQUIP:アクセサリ -= TEQUIP:アクセサリ & 4
			TEQUIP:アクセサリ -= TEQUIP:アクセサリ & 8
		ENDIF
		;セット衣装を着るとき、他のセット衣装は脱げる
		IF A == 4 && ( TEQUIP:上衣 >= 1 && TEQUIP:上衣 <= 10 || TEQUIP:上衣 == 25 )
				TEQUIP:上衣 = 0
		ELSEIF A == 5 && ( TEQUIP:下衣 >= 1 && TEQUIP:下衣 <= 10 || TEQUIP:下衣 == 25 )
				TEQUIP:下衣 = 0
		ENDIF
		
		;着せる前に服の汚れを判定
		CALL CLOTHES_STAIN
		
		TEQUIP:A = T:A
		;セット衣装を着たとき、もう片方も着る
		IF T:A >= 1 && T:A <= 10 || T:A == 25
			IF A == 4
				TEQUIP:上衣 = TEQUIP:下衣
			ELSE
				TEQUIP:下衣 = TEQUIP:上衣
			ENDIF
		ENDIF
		
		;着せる処理の後にテキストを呼ぶ
		CALL CLOTHES_MESSAGE
	ENDIF
	RESTART
ENDIF



;=======================================================
;衣装の表示制限
;=======================================================
@CLOTHES_CONTROL
$CONTROL
DRAWLINE
PRINTL 
PRINTL 【衣装表示制限】

PRINT [ 0] 全身上着　 
IF CFLAG:121 & 1
	PRINT ×
ELSE
	PRINT ○
ENDIF
PRINTL 

PRINT [ 1] 上衣　　　 
IF CFLAG:121 & 2
	PRINT ×
ELSE
	PRINT ○
ENDIF
PRINTL 

PRINT [ 2] 下衣　　　 
IF CFLAG:121 & 4
	PRINT ×
ELSE
	PRINT ○
ENDIF
PRINTL 

PRINT [ 3] 下着(上)　 
IF CFLAG:121 & 8
	PRINT ×
ELSE
	PRINT ○
ENDIF
PRINTL 

PRINT [ 4] 下着(下)　 
IF CFLAG:121 & 16
	PRINT ×
ELSE
	PRINT ○
ENDIF
PRINTL 

PRINT [ 5] 靴下　　　 
IF CFLAG:121 & 32
	PRINT ×
ELSE
	PRINT ○
ENDIF
PRINTL 

PRINT [ 6] 特殊衣装　 
IF CFLAG:121 & 64
	PRINT ×
ELSE
	PRINT ○
ENDIF
PRINTL 

PRINT [ 7] 頭部装飾　 
IF CFLAG:121 & 128
	PRINT ×
ELSE
	PRINT ○
ENDIF
PRINTL 

PRINT [ 8] 顔装飾　　 
IF CFLAG:121 & 256
	PRINT ×
ELSE
	PRINT ○
ENDIF
PRINTL 

PRINT [ 9] 靴　　　　 
IF CFLAG:121 & 512
	PRINT ×
ELSE
	PRINT ○
ENDIF
PRINTL 

PRINT [10] アクセサリ 
IF CFLAG:121 & 1024
	PRINT ×
ELSE
	PRINT ○
ENDIF
PRINTL 

PRINTL 
SIF CFLAG:121 != 2047
	PRINTL [20]　全てオフにする
SIF CFLAG:121 & 2047
	PRINTL [25]　全てオンにする
SIF (CFLAG:121 & 8) == 0 || (CFLAG:121 & 16) == 0 || (CFLAG:121 & 32) == 0 || (CFLAG:121 & 1) == 0 || (CFLAG:121 & 2) == 0 || (CFLAG:121 & 4) == 0
	PRINTL [30]　衣類の表示をオフにする
SIF CFLAG:121 & 63
	PRINTL [35]　衣類の表示をオンにする
SIF (CFLAG:121 & 64) == 0 || (CFLAG:121 & 128) == 0 || (CFLAG:121 & 256) == 0 || (CFLAG:121 & 512) == 0 || (CFLAG:121 & 1024) == 0
	PRINTL [40]　装飾品の表示をオフにする
SIF CFLAG:121 & 1984
	PRINTL [45]　装飾品の表示をオンにする
PRINTL 
PRINTL [90] 現在の表示設定を反転
PRINTL [100] 戻る

$INPUT_LOOP
Z = 0
INPUT
IF RESULT >= 0 && RESULT <= 10
	IF RESULT == 0
		PRINT 全身上着
		IF CFLAG:121 & 1
			CFLAG:121 -= 1
		ELSE
			CFLAG:121 |= 1
			Z = 1
		ENDIF
	ELSEIF RESULT == 1
		PRINT 上衣
		IF CFLAG:121 & 2
			CFLAG:121 -= 2
		ELSE
			CFLAG:121 |= 2
			Z = 1
		ENDIF
	ELSEIF RESULT == 2
		PRINT 下衣
		IF CFLAG:121 & 4
			CFLAG:121 -= 4
		ELSE
			CFLAG:121 |= 4
			Z = 1
		ENDIF
	ELSEIF RESULT == 3
		PRINT 下着（上）
		IF CFLAG:121 & 8
			CFLAG:121 -= 8
		ELSE
			CFLAG:121 |= 8
			Z = 1
		ENDIF
	ELSEIF RESULT == 4
		PRINT 下着（下）
		IF CFLAG:121 & 16
			CFLAG:121 -= 16
		ELSE
			CFLAG:121 |= 16
			Z = 1
		ENDIF
	ELSEIF RESULT == 5
		PRINT 靴下
		IF CFLAG:121 & 32
			CFLAG:121 -= 32
		ELSE
			CFLAG:121 |= 32
			Z = 1
		ENDIF
	ELSEIF RESULT == 6
		PRINT 特殊衣装
		IF CFLAG:121 & 64
			CFLAG:121 -= 64
		ELSE
			CFLAG:121 |= 64
			Z = 1
		ENDIF
	ELSEIF RESULT == 7
		PRINT 頭部装飾
		IF CFLAG:121 & 128
			CFLAG:121 -= 128
		ELSE
			CFLAG:121 |= 128
			Z = 1
		ENDIF
	ELSEIF RESULT == 8
		PRINT 顔装飾
		IF CFLAG:121 & 256
			CFLAG:121 -= 256
		ELSE
			CFLAG:121 |= 256
			Z = 1
		ENDIF
	ELSEIF RESULT == 9
		PRINT 靴
		IF CFLAG:121 & 512
			CFLAG:121 -= 512
		ELSE
			CFLAG:121 |= 512
			Z = 1
		ENDIF
	ELSEIF RESULT == 10
		PRINT アクセサリ
		IF CFLAG:121 & 1024
			CFLAG:121 -= 1024
		ELSE
			CFLAG:121 |= 1024
			Z = 1
		ENDIF
	ENDIF
	SIF Z == 0
		PRINTL を表示します
	SIF Z == 1
		PRINTL の表示を制限します
	GOTO CONTROL
ELSEIF RESULT == 20
	PRINTL 全ての衣装を表示します
			CFLAG:121 |= 2047
	GOTO CONTROL
ELSEIF RESULT == 25
	PRINTL 全ての衣装の表示を制限します
			CFLAG:121 = 0
	GOTO CONTROL
ELSEIF RESULT == 30
	PRINTL 衣類の表示を制限します
			CFLAG:121 |= 63
	GOTO CONTROL
ELSEIF RESULT == 35
	PRINTL 衣類を表示します
		SIF CFLAG:121 & 1
			CFLAG:121 -= 1
		SIF CFLAG:121 & 2
			CFLAG:121 -= 2
		SIF CFLAG:121 & 4
			CFLAG:121 -= 4
		SIF CFLAG:121 & 8
			CFLAG:121 -= 8
		SIF CFLAG:121 & 16
			CFLAG:121 -= 16
		SIF CFLAG:121 & 32
			CFLAG:121 -= 32
	GOTO CONTROL
ELSEIF RESULT == 40
	PRINTL 装飾品の表示を制限します
			CFLAG:121 |= 1984
	GOTO CONTROL
ELSEIF RESULT == 45
	PRINTL 装飾品を表示します
		SIF CFLAG:121 & 64
			CFLAG:121 -= 64
		SIF CFLAG:121 & 128
			CFLAG:121 -= 128
		SIF CFLAG:121 & 256
			CFLAG:121 -= 256
		SIF CFLAG:121 & 512
			CFLAG:121 -= 512
		SIF CFLAG:121 & 1024
			CFLAG:121 -= 1024
	GOTO CONTROL

ELSEIF RESULT == 90
	PRINTL 表示設定を反転します
	CALL CLOTHES_RE
	GOTO CONTROL
ELSEIF RESULT == 100
	RETURN 0
ELSE
	GOTO INPUT_LOOP
ENDIF



;=======================================================
;衣装の表示制限を反転する
;=======================================================
@CLOTHES_RE
IF CFLAG:121 & 1
	CFLAG:121 -= 1
ELSE
	CFLAG:121 |= 1
ENDIF
IF CFLAG:121 & 2
	CFLAG:121 -= 2
ELSE
	CFLAG:121 |= 2
ENDIF
IF CFLAG:121 & 4
	CFLAG:121 -= 4
ELSE
	CFLAG:121 |= 4
ENDIF
IF CFLAG:121 & 8
	CFLAG:121 -= 8
ELSE
	CFLAG:121 |= 8
ENDIF
IF CFLAG:121 & 16
	CFLAG:121 -= 16
ELSE
	CFLAG:121 |= 16
ENDIF
IF CFLAG:121 & 32
	CFLAG:121 -= 32
ELSE
	CFLAG:121 |= 32
ENDIF
IF CFLAG:121 & 64
	CFLAG:121 -= 64
ELSE
	CFLAG:121 |= 64
ENDIF
IF CFLAG:121 & 128
	CFLAG:121 -= 128
ELSE
	CFLAG:121 |= 128
ENDIF
IF CFLAG:121 & 256
	CFLAG:121 -= 256
ELSE
	CFLAG:121 |= 256
ENDIF
IF CFLAG:121 & 512
	CFLAG:121 -= 512
ELSE
	CFLAG:121 |= 512
ENDIF
IF CFLAG:121 & 1024
	CFLAG:121 -= 1024
ELSE
	CFLAG:121 |= 1024
ENDIF


;=======================================================
;着衣の状態によって、調教中のソースが若干変動する
;=======================================================
@EQUIP_CLOTHES
;着衣状態によるソースを付加（手以外の１箇所ごとに露出+10、未陥落時反感+10）
REPEAT 7
	;手の着衣は計算しない
	SIF COUNT == 0
		CONTINUE
	;靴下の着衣は計算しない
	SIF COUNT == 1
		CONTINUE
	;上衣はコーデチェック有効のとき計算しない
	SIF COUNT == 5 && CODE_CHECK(TARGET)
		CONTINUE
	;全身上着はコーデチェック有効のとき計算しない
	SIF COUNT == 6 && CODE_CHECK(TARGET)
		CONTINUE
	;男は下着（上）に関する計算はしない
	SIF COUNT == 3 && MALE(TARGET)
		CONTINUE
	IF TEQUIP:COUNT == 0
		SOURCE:露出 += 10
		;陥落時は反感を加算しない
		SIF TALENT:恋慕 || TALENT:淫乱 || TALENT:服従 || TALENT:親愛 || TALENT:娼婦 || TALENT:隷属
			CONTINUE
		SOURCE:反発 += 10
	ENDIF
REND

;汚れた着衣だと一過所ごとに不潔+10
P = 0
O = 0
REPEAT 9
	P = COUNT + 8
	SIF STAIN:P
		O += 1
REND
IF TALENT:汚れ無視
	O = 0
ELSEIF TALENT:汚臭鈍感 || TALENT:倒錯的 || TALENT:恥薄い
	TIMES O , 0.50
ELSEIF TALENT:恥じらい || TALENT:汚臭敏感
	TIMES O , 1.50
ENDIF
SOURCE:露出 += O*10

RETURN 1


;=======================================================
;着衣の実行時のメッセージ処理
;=======================================================
@CLOTHES_MESSAGE


;脱がす場合
IF TEQUIP:A == 0
	;コスプレ口上呼び出し
	TFLAG:13 = 76
	CALL KOJO_MESSAGE_EVENT
	
	C = NO:TARGET
	CALL CLOTHES_NAME
	PRINT を
	;さらし
	IF A == 3 && T:3 == 3
		PRINTW 解いた
	;頭部装飾と特殊装飾、一部装飾品っぽいもの
	ELSEIF A == 7 || T:2 == 5 || A == 8 || A == 10
		PRINTW 外した
		;動物耳を外した
		SIF T:7 == 1 || T:7 == 2 || T:7 == 3
			TALENT:動物耳 = 0
	ELSE
		PRINTW 脱がした
	ENDIF
;着せる場合
ELSE
	;コスプレ口上呼び出し
	TFLAG:13 = 25
	CALL KOJO_MESSAGE_EVENT
	
	C = NO:TARGET
	CALL CLOTHES_NAME
	PRINT を
	;貞操帯
	IF T:2 == 5
		PRINTW 施錠した
	;さらし
	ELSEIF T:3 == 3
		PRINTW 巻いた
	;頭部装飾と下着上下と特殊装飾。眼鏡も入れてみた。
	ELSEIF A == 0 || T:2 == 3 || (A == 3 && T:3 < 4) || A == 7 || A == 8 || A == 10
		PRINTW つけた
	ELSEIF A == 1 || A == 2 || A == 9 || (A == 4 && T:4 >= 11)
		PRINTW 履かせた
	ELSE
		PRINTW 着せた
	ENDIF
ENDIF


;=======================================================
;特殊な着衣状態の表示処理
;全裸（裸コート、裸白衣、裸羽織り、半裸、裸マント、裸エプロン、裸靴下）
;下着姿、半裸(上)、半裸(下)、ノーパン、ノーブラ
;=======================================================
@PRINT_CLOTHES
VARSET T

;女装チェック
SIF TEQUIP_FEMALE(TARGET) && MALE(TARGET)
	PRINT 【女装】

;まずは上半身のコーデチェック
;上半身が外出に耐えないものである場合：全裸、下着姿、半裸(上)
IF !CODE_CHECK(TARGET)
	;下衣も着てない
	IF TEQUIP:下衣 == 0
		;下着チェック
		;どちらかでも、下着はちゃんと着けている
		IF TEQUIP:下着（下） || (TEQUIP:下着（下） && TEQUIP:下着（上） < 7)
			PRINT 【下着姿】
		;下着も着けていない
		ELSEIF TEQUIP:下着（下） == 0
			;コートとか着てるときはそっち優先。半裸
			IF TEQUIP:全身上着
				IF TEQUIP:全身上着 == 5
					PRINT 【裸コート】
				ELSEIF TEQUIP:全身上着 == 6
					PRINT 【裸白衣】
				ELSEIF TEQUIP:全身上着 == 10 || TEQUIP:全身上着 == 11
					PRINT 【裸羽織り】
				ELSE
					PRINT 【半裸】
				ENDIF
			ELSE
				IF TEQUIP:特殊１ == 2
					PRINT 【裸エプロン】
				ELSEIF TEQUIP:特殊２
					PRINT 【裸靴下】
				ELSEIF TEQUIP:アクセサリ & 256
					PRINT 【裸マント】
				ELSE
					PRINT 【全裸】
				ENDIF
			ENDIF
		ENDIF
	;下衣はちゃんと着ている
	ELSE
		PRINT 【半裸(上)】
	ENDIF
;上半身が外出できるものの場合、下衣チェック
ELSE
	;下衣を着てない
	IF TEQUIP:下衣 == 0
		PRINT 【半裸(下)】
	;下衣もちゃんと着ている
	ELSE
		;男の場合
		IF MALE(TARGET)
			;下着を着けていない
			SIF TEQUIP:下着（下） == 0
				PRINT 【ノーパン】
		;女の場合
		ELSE
			;両方の下着を着けていない
			IF TEQUIP:下着（下） == 0 && (TEQUIP:下着（上） == 0 || TEQUIP:下着（上） >= 7)
				PRINT 【ノーパン＆ノーブラ】
			;上だけ下着を着けていない
			ELSEIF TEQUIP:下着（上） == 0 || TEQUIP:下着（上） >= 7
				PRINT 【ノーブラ】
			;下だけ下着を着けていない
			ELSEIF TEQUIP:下着（下） == 0
				PRINT 【ノーパン】
			ENDIF
		ENDIF
	ENDIF
ENDIF

;着衣名関数から着衣を呼び出していく
REPEAT 10
	IF COUNT < 7
		A = 6 - COUNT
	ELSE
		A = COUNT
	ENDIF
	
	;セット衣装を着てるとき、セット衣装(下)は表示しない
	SIF A == 4 && ( TEQUIP:上衣 >= 1 && TEQUIP:上衣 <= 10 || TEQUIP:上衣 == 25 )
		CONTINUE
	IF TEQUIP:A
		PRINT [
		CALL CLOTHES_NAME
		PRINT ]
	ENDIF
REND



;=======================================================
;改行処理(伝統的にeraで使用されてるので確実)
;=======================================================
@LINE_FEED
E += 1
IF E % 4 == 0
	PRINTL 
ENDIF



;=======================================================
;パラメータ変動のある衣装のときに調教ターンエンドと同じ処理？
;=======================================================
@SP_CLOTHES
CALL SOURCE_CHECK
REPEAT 5
	G = 21 + COUNT
	TFLAG:G = 0
REND
REPEAT 19
	SOURCE:COUNT = 0
REND
G = 0
LOSEBASE:体力 = 0
LOSEBASE:気力 = 0



;=======================================================
;相互に汚れるんだったらまとめて処理できないかな
;=======================================================
@CLOTHES_STAIN
B = 8 + A
S = 0
REPEAT 20
	S = COUNT
	;特殊１条件
	IF A == 0
		;手袋、エプロン以外は汚れ判定無し
		SIF T:0 != 1 && T:0 != 2
			CONTINUE
		;手袋は手の汚れ以外つかない
		SIF T:0 == 1 && S != 2
			CONTINUE
		;エプロンには胸、ペニス、下着(下)、下着(上)、下衣、上衣、全身上着
		IF T:0 == 2
			SIF S != 3 && S != 4 && S != 13 && S != 14 && S != 15 && S != 16 && S != 17
				CONTINUE
		ENDIF
	;靴下条件
	ELSEIF A == 1
		;ストッキング系は、ペニス、ヴァギナの汚れ、下着（下）の汚れも加味
		IF (T:A ==5 || T:A ==6) && S != 9 && S != 4 && S != 5 && S != 17
			CONTINUE
		;それ以外は足の汚れのみ
		ELSEIF S != 9
			CONTINUE
		ENDIF
	;下着（下）条件
	ELSEIF A == 2
		;ペニス、ヴァギナの汚れ
		SIF S != 4 && S != 5
			CONTINUE
	;下着（上）条件
	ELSEIF A == 3
		;胸の汚れ
		SIF S != 3
			CONTINUE
	;下衣条件
	ELSEIF A == 4
		;ペニス、ヴァギナの汚れ、下着（下）の汚れ
		SIF S != 4 && S != 5 && S != 17
			CONTINUE
	;上衣条件
	ELSEIF A == 5
		;胸の汚れ、下着（上）の汚れ
		SIF S != 3 && S != 16
			CONTINUE
	;全身上着条件
	ELSEIF A == 6
		;胸の汚れ、下着（上）の汚れ
		SIF S != 3 && S != 16
			CONTINUE
	;頭部装飾
	ELSEIF A == 7
		;髪の汚れ以外つかない
		SIF S != 0
			CONTINUE
	;顔は汚れる予定なし
	ELSEIF A == 8
		CONTINUE
	;靴
	ELSEIF A == 9
		;足の汚れ、靴下の汚れ
		SIF S != 9 && S != 18
			CONTINUE
	ENDIF
	M = TARGET
	CALL CLOTHES_STAIN_2
REND



;=======================================================
;服汚し関数独立させてみた（口上内から呼び出しとかで使い道あるかも）
;付着させるSTAIN:Sの可否を判定
;=======================================================
@CLOTHES_STAIN_2
S:1 = 0
S:2 = 0
S:3 = 0
;ペニス・ヴァギナ・アナル・膣内・腸内の汚れ
IF S == 4 || S == 5 || S == 6 || S == 7 || S == 8
	;下着（下）があるときは付着しない
	SIF TEQUIP:下着（下）
		RETURN
	;着せるのが下着（下）以外のときに、下衣を着ている
	SIF A != 2 && TEQUIP:下衣
		RETURN
;胸の汚れ
ELSEIF S == 3
	;下着（上）があるときは付着しない
	SIF TEQUIP:下着（上）
		RETURN
	;着せるのが下着（上）以外のときに、上衣or全身上着を着ている
	SIF A != 3 && (TEQUIP:上衣 || TEQUIP:全身上着)
		RETURN
;足の汚れ
ELSEIF S == 9 && (TEQUIP:特殊２ || TEQUIP:靴)
	;靴下があるときは付着しない
	SIF TEQUIP:特殊２
		RETURN
	;付着させるのが靴下以外のときに、靴を履いている
	SIF A != 1 && TEQUIP:靴
		RETURN
;靴下の汚れ
ELSEIF S == 18
	;靴がある時汚れない
	SIF TEQUIP:靴
		RETURN
	;靴下と同じ汚れが足にあるとき内側の汚れとみなす
	S:1 |= STAIN:足
	S:2 = S:1 - STAIN:足装飾
	SIF S:2 > 0
		S:3 = 1
	SIF (S:1 & STAIN:足) == STAIN:足装飾
		RETURN
;靴
ELSEIF S == 19
	;同じ汚れが靴下or足にあるとき内側の汚れとみなす
	IF TEQUIP:特殊２
		S:1 |= STAIN:足装飾
	ELSE
		S:1 |= STAIN:足
	ENDIF
	S:2 = S:1 - STAIN:靴
	SIF S:2 > 0
		S:3 = 1
	SIF (S:1 & STAIN:靴) == STAIN:靴
		RETURN
;下着（下）
ELSEIF S == 17
	;下衣があるときは汚れない
	SIF (TEQUIP:下衣 || TEQUIP:全身上着)
		RETURN
	;同じ汚れがペニス、ヴァギナ、アナル、膣内にあるとき内側の汚れとみなす
	S:1 |= STAIN:ペニス
	S:1 |= STAIN:ヴァギナ
	S:1 |= STAIN:アナル
	S:1 |= STAIN:膣内
	S:2 = S:1 - STAIN:下着（下）
	SIF S:2 > 0
		S:3 = 1
	SIF (S:1 & STAIN:下着（下）) == STAIN:下着（下）
		RETURN
;下着（上）
ELSEIF S == 16
	;下衣or全身上着があるときは汚れない
	SIF (TEQUIP:上衣 || TEQUIP:全身上着)
		RETURN
	;同じ汚れが胸にあるとき内側の汚れとみなす
	S:1 |= STAIN:胸
	S:2 = S:1 - STAIN:下着（上）
	SIF S:2 > 0
		S:3 = 1
	SIF (S:1 & STAIN:下着（上）) == STAIN:下着（上）
		RETURN
;下衣
ELSEIF S == 15
	;同じ汚れがペニス、ヴァギナ、アナル、膣内or下着（下）にあるとき内側の汚れとみなす
	IF TEQUIP:下着（下）
		S:1 |= STAIN:下着（下）
	ELSE
		S:1 |= STAIN:ペニス
		S:1 |= STAIN:ヴァギナ
		S:1 |= STAIN:アナル
		S:1 |= STAIN:膣内
	ENDIF
	S:2 = S:1 - STAIN:下衣
	SIF S:2 > 0
		S:3 = 1
	SIF (S:1 & STAIN:下衣) == STAIN:下衣
		RETURN
;上衣
ELSEIF S == 14
	;同じ汚れが胸or下着（上）にあるとき内側の汚れとみなす
	IF TEQUIP:下着（上）
		S:1 |= STAIN:下着（下）
	ELSE
		S:1 |= STAIN:胸
	ENDIF
	S:2 = S:1 - STAIN:上衣
	SIF S:2 > 0
		S:3 = 1
	SIF (S:1 & STAIN:上衣) == STAIN:上衣
		RETURN
;全身上着
ELSEIF S == 13
	;同じ汚れが胸or下着（上）にあるとき内側の汚れとみなす
	IF TEQUIP:下着（上）
		S:1 |= STAIN:下着（下）
	ELSE
		S:1 |= STAIN:胸
	ENDIF
	S:2 = S:1 - STAIN:全身上着
	SIF S:2 > 0
		S:3 = 1
	SIF (S:1 & STAIN:全身上着) == STAIN:全身上着
		RETURN
ENDIF

IF S:3 == 1
	STAIN:M:B |= S:2
ELSE
	STAIN:M:B |= STAIN:S
ENDIF


;愛液・ペニス・アナル汚れは除く
SIF STAIN:B & 1
	STAIN:B -= 1
SIF STAIN:B & 2
	STAIN:B -= 2
SIF STAIN:B & 8
	STAIN:B -= 8



;=======================================================
;着てない服に汚れが付いてしまうことがあるので暫定処置的な？
;=======================================================
@CLOTHES_STAIN_3
SIF TEQUIP:頭部装飾 == 0
	STAIN:10 = 0
SIF TEQUIP:特殊３ == 0
	STAIN:11 = 0
SIF TEQUIP:特殊１ == 0
	STAIN:12 = 0
SIF TEQUIP:全身上着 == 0
	STAIN:13 = 0
SIF TEQUIP:上衣 == 0
	STAIN:14 = 0
SIF TEQUIP:下衣 == 0
	STAIN:15 = 0
SIF TEQUIP:下着（上） == 0
	STAIN:16 = 0
SIF TEQUIP:下着（下） == 0
	STAIN:17 = 0
SIF TEQUIP:特殊２ == 0
	STAIN:18 = 0
SIF TEQUIP:靴 == 0
	STAIN:19 = 0

;=======================================================
;アクセサリの付け替え関数
;=======================================================
@ACCESSORY_CHANGE

IF Z >= 150
	Y = 100
	;他の着衣口上が呼び出されないようにT:Xをからっぽに
	REPEAT 11
		T:COUNT = 0
	REND
	T:10 = TEQUIP:アクセサリ
	A = Z - 150
	CALL ACCESSORY_BIT
	IF A != 0
		IF T:10 & Z
			T:10 -= Z
			Y = 150
		ELSE
			T:10 |= Z
			Y = 160
			;特殊な着脱条件。
			;ネクタイとリボンタイが同時につかないようにする
			IF A == 3
					T:10 -= T:10 & 8
			ELSEIF A == 4
					T:10 -= T:10 & 4
			ENDIF
		ENDIF
	ELSE
		T:10 = 0
	ENDIF
	;コスプレ口上呼び出し Y == 150or160で分岐させつつAorZの入力値を指定したら口上を表示できるはず
	IF Y == 150
		TFLAG:13 = 76
	ELSEIF Y == 160
		TFLAG:13 = 25
	ENDIF
	CALL KOJO_MESSAGE_EVENT
	TEQUIP:アクセサリ = T:10
	C = NO:TARGET
ENDIF



;=======================================================
;ビット演算のぶんを力技で取得してるけどどうなの
;=======================================================
@ACCESSORY_BIT
Z = 1
IF A < 3
	Z = A
ELSE
	REPEAT (A - 1)
			Z *= 2
	REND
ENDIF




;=======================================================
;表示をそろえるために空白を読み込む
;=======================================================
@CLOTHES_SPACE
SIF S < 1
	RETURN
REPEAT S
	PRINT  
REND



;=======================================================
;コスプレセットのために、着用条件を満たしている衣装を先に読み込む
;=======================================================
@CLOTHES_LIST2
IF A < 7
	C:3 = 6 - A
ELSE
	C:3 = A
ENDIF
D = B
IF C:3 == 0 && B < 10
	D = B
ELSEIF C:3 == 0
	D = ((B / 10) * 100) + (B % 10)
ELSEIF B < 10
	D += (C:3 * 10)
ELSE
	D += (C:3 * 100)
ENDIF
Z:D = 1



;=======================================================
;衣類名称呼びだしのため、現在の服装を一度保存し、TEQUIP:Aを0にする
;=======================================================
@CLOTHES_LIST3
C:2 = TEQUIP:A
TEQUIP:A = 0
T:A = B
IF A < 7
	C:3 = 6 - A
ELSE
	C:3 = A
ENDIF
IF C:3 == 0 && B < 10
	PRINTFORM [ {B}] 
ELSEIF C:3 == 0
	B = ((B / 10) * 100) + (B % 10)
	PRINTFORM [{B}]
ELSEIF B < 10
	B += (C:3 * 10)
	PRINTFORM [{B}] 
ELSE
	B += (C:3 * 100)
	PRINTFORM [{B}]
ENDIF
CALL CLOTHES_NAME
CALL CLOTHES_SPACE
CALL LINE_FEED
X:B = 1
TEQUIP:A = C:2
T:A = 0
COUNT = F


