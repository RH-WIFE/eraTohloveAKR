@SOURCE_CHECK
;-------------------------------------------------
;残り時間の減少処理
;-------------------------------------------------
SELECTCASE SELECTCOM
	;軽拘束、薬、酒、移動系（野外プレイ以外）、触手召喚/送還、触手口辱は減らない。
	CASE 131 TO 134,300 TO 306,310,312,313,315,316,319,323,340,350
	;デート
	CASE 207
		TFLAG:74 -= 20
	;家具にする、まったり、家事、歌の練習、ビデオ鑑賞、輪姦
	CASE 150,203,204,205,311,322
		TFLAG:74 -= 5
	;セックス系は-3。抜かないフラグがある場合は-1
	CASE 100 TO 106,110 TO 116,181,260 TO 265,270,271,405,406,430,431,440,441,507 TO 515,517 TO 526
		IF TFLAG:60
			TFLAG:74 -= 1
		ELSE
			TFLAG:74 -= 3
		ENDIF
	;それ以外
	CASEELSE
		TFLAG:74 -= 1
ENDSELECT
;-------------------------------------------------
;ハードなコマンドでSUN値が削れる
;-------------------------------------------------
SELECTCASE SELECTCOM
	;拷問/烙印/片腕切断/片脚切断/抜歯
	CASE 151,156,390 TO 392
		;調教者に対して服従陥落、ドМ以外
		SIF !TALENT:服従 && !TALENT:隷属 && TALENT:マゾ != 2
			CFLAG:10 += 5
	;食糞させる/食糞する
	CASE 185,286
		;食糞経験30未満でマゾでないか、ドМでない
		SIF (EXP:食糞経験 < 30 && !TALENT:マゾ) || TALENT:マゾ != 2
			CFLAG:10 += 3
	;触手系
	CASE 340 TO 370
		;触手経験５０未満かつ異常経験３以下かつ陥落していない
		SIF EXP:触手経験 < 50 && EXP:異常経験 <= 3 && !KANRAKU2(TARGET)
			CFLAG:10 += 1
	;輪姦
	CASE 322
		;淫乱服従陥落していない
		SIF KANRAKU2(TARGET) < 2
			CFLAG:10 += 5
ENDSELECT
;-------------------------------------------------
;コマンド実行時の尿意上昇
;-------------------------------------------------
;そもそも尿意がない場合は上がらないよ
IF BASE:尿意 >= 60
	SELECTCASE SELECTCOM
		;Ｃ・Ｐ・Ｖ系コマンド
		CASE 20 TO 44,404
			BASE:尿意 += 5
		;Ｕ系コマンド
		CASE 60 TO 61
			BASE:尿意 += 30
		;衝撃を与えるコマンド（軽度）
		;スパンキング、乳スパンキング、蝋燭、家具にする
		CASE 140,141,144,150
			BASE:尿意 += 3
		;衝撃を与えるコマンド（重度）
		;Ａセックス系、鞭、針、三角木馬、拷問、首絞め、烙印
		CASE 110 TO 116,142,143,145,151,155,156,404
			BASE:尿意 += 10
		;直接攻撃
		;足で踏む、腹パン
		CASE 153,154
			BASE:尿意 += 50
	ENDSELECT
ENDIF
;-------------------------------------------------
;コマンド実行時の便意上昇
;-------------------------------------------------
;そもそも便意がない場合は上がらないよ
IF BASE:便意 >= 60
	SELECTCASE SELECTCOM
		;Ａ系コマンド
		CASE 50 TO 56,404
			BASE:便意 += 5
		;衝撃を与えるコマンド（軽度）
		;スパンキング、乳スパンキング、蝋燭、家具にする
		CASE 140,141,144,150
			BASE:便意 += 3
		;衝撃を与えるコマンド（重度）
		;Ａセックス系、鞭、針、三角木馬、拷問、首絞め、烙印
		CASE 110 TO 116,142,143,145,151,155,156,404
			BASE:便意 += 10
		;直接攻撃
		;足で踏む、腹パン
		CASE 153,154
			BASE:便意 += 50
	ENDSELECT
ENDIF

;-------------------------------------------------
;コマンド実行時の吐き気上昇
;-------------------------------------------------
;そもそも吐き気がない場合は上がらないよ
IF BASE:吐き気 >= 60
	SELECTCASE SELECTCOM
		;口を使うコマンド
		CASE 1,71,75,77,222,224,407,411,412,420,516
			BASE:吐き気 += 5
		;セックス系、Ａセックス系
		CASE 100 TO 106,110 TO 116,260 TO 265,405,406,430,431,507 TO 515,517 TO 527
			BASE:吐き気 += 10
		;衝撃を与えるコマンド（軽度）
		;スパンキング、乳スパンキング、蝋燭、家具にする
		CASE 140,141,144,150
			BASE:吐き気 += 5
		;衝撃を与えるコマンド（重度）
		;イマラチオ、鞭、針、三角木馬、拷問、首絞め、烙印
		CASE 72,110 TO 116,142,143,145,151,155,156,404
			BASE:吐き気 += 10
		;直接攻撃
		;足で踏む、腹パン
		CASE 153,154
			BASE:吐き気 += 50
	ENDSELECT
ENDIF

;-------------------------------------------------
;バイブなど付けっぱなしアイテムのチェック
;-------------------------------------------------
CALL EQUIP_CHECK
;-------------------------------------------------
;主人、同性、調教者の能力の処理
;-------------------------------------------------
CALL SOURCE_SEX_CHECK
CALL PLAYER_SKILL_CHECK

;-------------------------------------------------
;処女喪失の処理
;-------------------------------------------------
CALL LOST_VIRGIN
;-------------------------------------------------
;童貞喪失の処理
;-------------------------------------------------
CALL LOST_VIRGIN_DT
;-------------------------------------------------
;バックバージン喪失の処理
;-------------------------------------------------
CALL LOST_VIRGIN_BACK


;-------------------------------------------------
;依存度チェック
;-------------------------------------------------
CALL MASTER_DEPENDENCE_CHECK

;-------------------------------------------------
;技巧のチェック
;-------------------------------------------------
CALL TECHNIQUE_CHECK

;-------------------------------------------------
;潤滑で服を汚したかのチェック
;-------------------------------------------------
CALL JUNKATU_TYAKUI

;-------------------------------------------------
;尿意・便意ゲージのチェック
;-------------------------------------------------
CALL DEFECATION_CHECK

;-------------------------------------------------
;吐き気ゲージのチェック
;-------------------------------------------------
CALL NAUSEA_CHECK


;-------------------------------------------------
;【失意】チェック
;-------------------------------------------------
SIF TALENT:失意
	SOURCE:反発 += ((TALENT:失意 * 5) / 2)

;-------------------------------------------------
;快Ｃのソース
;-------------------------------------------------
;Ｃ敏感とＣ鈍感はここで処理
SIF TALENT:Ｃ鈍感
	TIMES SOURCE:快Ｃ , 0.50
SIF TALENT:Ｃ敏感
	TIMES SOURCE:快Ｃ , 1.50

;掻痒剤使ってる場合、快感が跳ね上がる
SIF STAIN:4 & 1024 || STAIN:5 & 1024
	TIMES SOURCE:快Ｃ , 2.00

;C感覚
SIF ABL:Ｃ感覚 == 0
	TIMES SOURCE:快Ｃ , 0.50
SIF ABL:Ｃ感覚 == 1
	TIMES SOURCE:快Ｃ , 1.50
SIF ABL:Ｃ感覚 == 2
	TIMES SOURCE:快Ｃ , 2.00
SIF ABL:Ｃ感覚 == 3
	TIMES SOURCE:快Ｃ , 3.00
SIF ABL:Ｃ感覚 == 4
	TIMES SOURCE:快Ｃ , 4.50
SIF ABL:Ｃ感覚 == 5
	TIMES SOURCE:快Ｃ , 6.00
SIF ABL:Ｃ感覚 == 6
	TIMES SOURCE:快Ｃ , 8.00
SIF ABL:Ｃ感覚 == 7
	TIMES SOURCE:快Ｃ , 10.00
SIF ABL:Ｃ感覚 == 8
	TIMES SOURCE:快Ｃ , 12.00
SIF ABL:Ｃ感覚 == 9
	TIMES SOURCE:快Ｃ , 13.50
SIF ABL:Ｃ感覚 >= 10
	TIMES SOURCE:快Ｃ , 15.00

LOCAL = SOURCE:快Ｃ

;PALAM:欲情をみる
SIF PALAM:欲情 < PALAMLV:1
	TIMES LOCAL , 0.80
SIF PALAM:欲情 < PALAMLV:2
	TIMES LOCAL , 1.00
SIF PALAM:欲情 < PALAMLV:3
	TIMES LOCAL , 1.20
SIF PALAM:欲情 < PALAMLV:4
	TIMES LOCAL , 1.50
SIF PALAM:欲情 >= PALAMLV:4
	TIMES LOCAL , 1.80

LOCAL:1 = SOURCE:快Ｃ

;ABL:欲望をみる
SIF ABL:欲望 == 0
	TIMES LOCAL:1 , 0.50
SIF ABL:欲望 == 1
	TIMES LOCAL:1 , 0.60
SIF ABL:欲望 == 2
	TIMES LOCAL:1 , 0.70
SIF ABL:欲望 == 3
	TIMES LOCAL:1 , 0.80
SIF ABL:欲望 == 4
	TIMES LOCAL:1 , 0.90
SIF ABL:欲望 == 5
	TIMES LOCAL:1 , 1.00
SIF ABL:欲望 == 6
	TIMES LOCAL:1 , 1.05
SIF ABL:欲望 == 7
	TIMES LOCAL:1 , 1.10
SIF ABL:欲望 == 8
	TIMES LOCAL:1 , 1.15
SIF ABL:欲望 == 9
	TIMES LOCAL:1 , 1.20
SIF ABL:欲望 >= 10
	TIMES LOCAL:1 , 1.40

UP:快Ｃ += LOCAL
UP:欲情 += LOCAL:1

;-------------------------------------------------
;快Ｖのソース
;-------------------------------------------------
;Ｖ敏感とＶ鈍感はここで処理
SIF TALENT:Ｖ鈍感
	TIMES SOURCE:快Ｖ , 0.50
SIF TALENT:Ｖ敏感
	TIMES SOURCE:快Ｖ , 1.50

;掻痒剤使ってる場合、快感が跳ね上がる
SIF STAIN:6 & 1024 || STAIN:5 & 1024
	TIMES SOURCE:快Ｖ , 2.00

;V感覚
SIF ABL:Ｖ感覚 == 0
	TIMES SOURCE:快Ｖ , 0.50
SIF ABL:Ｖ感覚 == 1
	TIMES SOURCE:快Ｖ , 1.50
SIF ABL:Ｖ感覚 == 2
	TIMES SOURCE:快Ｖ , 2.00
SIF ABL:Ｖ感覚 == 3
	TIMES SOURCE:快Ｖ , 3.00
SIF ABL:Ｖ感覚 == 4
	TIMES SOURCE:快Ｖ , 4.50
SIF ABL:Ｖ感覚 == 5
	TIMES SOURCE:快Ｖ , 6.00
SIF ABL:Ｖ感覚 == 6
	TIMES SOURCE:快Ｖ , 8.00
SIF ABL:Ｖ感覚 == 7
	TIMES SOURCE:快Ｖ , 10.00
SIF ABL:Ｖ感覚 == 8
	TIMES SOURCE:快Ｖ , 12.00
SIF ABL:Ｖ感覚 == 9
	TIMES SOURCE:快Ｖ , 13.00
SIF ABL:Ｖ感覚 >= 10
	TIMES SOURCE:快Ｖ , 15.00

;EXP:Ｖ経験をみる
SIF EXP:Ｖ経験 < EXPLV:1
	TIMES SOURCE:快Ｖ , 0.50
SIF EXP:Ｖ経験 < EXPLV:2
	TIMES SOURCE:快Ｖ , 0.60
SIF EXP:Ｖ経験 < EXPLV:3
	TIMES SOURCE:快Ｖ , 1.00
SIF EXP:Ｖ経験 < EXPLV:4
	TIMES SOURCE:快Ｖ , 1.20
SIF EXP:Ｖ経験 < EXPLV:5
	TIMES SOURCE:快Ｖ , 1.40
SIF EXP:Ｖ経験 >= EXPLV:5
	TIMES SOURCE:快Ｖ , 1.60

;PALAM:潤滑をみる
SIF PALAM:潤滑 < PALAMLV:1
	TIMES SOURCE:快Ｖ , 0.10
SIF PALAM:潤滑 < PALAMLV:2
	TIMES SOURCE:快Ｖ , 0.40
SIF PALAM:潤滑 < PALAMLV:3
	TIMES SOURCE:快Ｖ , 1.00
SIF PALAM:潤滑 < PALAMLV:4
	TIMES SOURCE:快Ｖ , 1.40
SIF PALAM:潤滑 >= PALAMLV:4
	TIMES SOURCE:快Ｖ , 1.80

LOCAL = SOURCE:快Ｖ

;PALAM:欲情をみる
SIF PALAM:欲情 < PALAMLV:1
	TIMES LOCAL , 0.60
SIF PALAM:欲情 < PALAMLV:2
	TIMES LOCAL , 0.80
SIF PALAM:欲情 < PALAMLV:3
	TIMES LOCAL , 1.00
SIF PALAM:欲情 < PALAMLV:4
	TIMES LOCAL , 1.50
SIF PALAM:欲情 >= PALAMLV:4
	TIMES LOCAL , 2.00

LOCAL:1 = SOURCE:快Ｖ

;ABL:欲望をみる
SIF ABL:欲望 == 0
	TIMES LOCAL:1 , 0.50
SIF ABL:欲望 == 1
	TIMES LOCAL:1 , 0.60
SIF ABL:欲望 == 2
	TIMES LOCAL:1 , 0.70
SIF ABL:欲望 == 3
	TIMES LOCAL:1 , 0.80
SIF ABL:欲望 == 4
	TIMES LOCAL:1 , 0.90
SIF ABL:欲望 == 5
	TIMES LOCAL:1 , 1.00
SIF ABL:欲望 == 6
	TIMES LOCAL:1 , 1.05
SIF ABL:欲望 == 7
	TIMES LOCAL:1 , 1.10
SIF ABL:欲望 == 8
	TIMES LOCAL:1 , 1.15
SIF ABL:欲望 == 9
	TIMES LOCAL:1 , 1.20
SIF ABL:欲望 >= 10
	TIMES LOCAL:1 , 1.40

;小人体型
IF TALENT:小人体型
	TIMES LOCAL , 0.80
	TIMES LOCAL:1 , 1.20
	UP:習得 += LOCAL:1/2
ENDIF

UP:快Ｖ += LOCAL
UP:欲情 += LOCAL:1
;-------------------------------------------------
;快Ａのソース
;-------------------------------------------------
;Ａ敏感とＡ鈍感はここで処理
SIF TALENT:Ａ鈍感
	TIMES SOURCE:快Ａ , 0.50
SIF TALENT:Ａ敏感
	TIMES SOURCE:快Ａ , 1.50

;掻痒剤使ってる場合、快感が跳ね上がる
SIF STAIN:7 & 1024 || STAIN:8 & 1024
	TIMES SOURCE:快Ａ , 2.00

;A感覚
SIF ABL:Ａ感覚 == 0
	TIMES SOURCE:快Ａ , 0.50
SIF ABL:Ａ感覚 == 1
	TIMES SOURCE:快Ａ , 1.50
SIF ABL:Ａ感覚 == 2
	TIMES SOURCE:快Ａ , 2.00
SIF ABL:Ａ感覚 == 3
	TIMES SOURCE:快Ａ , 3.00
SIF ABL:Ａ感覚 == 4
	TIMES SOURCE:快Ａ , 4.50
SIF ABL:Ａ感覚 == 5
	TIMES SOURCE:快Ａ , 6.00
SIF ABL:Ａ感覚 == 6
	TIMES SOURCE:快Ａ , 8.00
SIF ABL:Ａ感覚 == 7
	TIMES SOURCE:快Ａ , 10.00
SIF ABL:Ａ感覚 == 8
	TIMES SOURCE:快Ａ , 12.00
SIF ABL:Ａ感覚 == 9
	TIMES SOURCE:快Ａ , 13.50
SIF ABL:Ａ感覚 >= 10
	TIMES SOURCE:快Ａ , 15.00

;EXP:Ａ経験をみる
SIF EXP:Ａ経験 < EXPLV:1
	TIMES SOURCE:快Ａ , 0.10
SIF EXP:Ａ経験 < EXPLV:2
	TIMES SOURCE:快Ａ , 0.30
SIF EXP:Ａ経験 < EXPLV:3
	TIMES SOURCE:快Ａ , 0.50
SIF EXP:Ａ経験 < EXPLV:4
	TIMES SOURCE:快Ａ , 1.00
SIF EXP:Ａ経験 < EXPLV:5
	TIMES SOURCE:快Ａ , 1.40
SIF EXP:Ａ経験 >= EXPLV:5
	TIMES SOURCE:快Ａ , 1.60

;PALAM:潤滑をみる
SIF PALAM:潤滑 < PALAMLV:1
	TIMES SOURCE:快Ａ , 0.10
SIF PALAM:潤滑 < PALAMLV:2
	TIMES SOURCE:快Ａ , 0.40
SIF PALAM:潤滑 < PALAMLV:3
	TIMES SOURCE:快Ａ , 1.00
SIF PALAM:潤滑 < PALAMLV:4
	TIMES SOURCE:快Ａ , 1.40
SIF PALAM:潤滑 >= PALAMLV:4
	TIMES SOURCE:快Ａ , 1.80

LOCAL = SOURCE:快Ａ

;PALAM:欲情をみる
;快ＡはあまりPALAM:欲情では差が出ない
SIF PALAM:欲情 < PALAMLV:1
	TIMES LOCAL , 0.80
SIF PALAM:欲情 < PALAMLV:2
	TIMES LOCAL , 1.00
SIF PALAM:欲情 < PALAMLV:3
	TIMES LOCAL , 1.20
SIF PALAM:欲情 < PALAMLV:4
	TIMES LOCAL , 1.40
SIF PALAM:欲情 >= PALAMLV:4
	TIMES LOCAL , 1.60

LOCAL:1= SOURCE:快Ａ

;ABL:欲望をみる
SIF ABL:欲望 == 0
	TIMES LOCAL:1, 0.50
SIF ABL:欲望 == 1
	TIMES LOCAL:1, 0.60
SIF ABL:欲望 == 2
	TIMES LOCAL:1, 0.70
SIF ABL:欲望 == 3
	TIMES LOCAL:1, 0.80
SIF ABL:欲望 == 4
	TIMES LOCAL:1, 0.90
SIF ABL:欲望 == 5
	TIMES LOCAL:1, 1.00
SIF ABL:欲望 == 6
	TIMES LOCAL:1, 1.05
SIF ABL:欲望 == 7
	TIMES LOCAL:1, 1.10
SIF ABL:欲望 == 8
	TIMES LOCAL:1, 1.15
SIF ABL:欲望 == 9
	TIMES LOCAL:1, 1.20
SIF ABL:欲望 >= 10
	TIMES LOCAL:1, 1.40

;小人体型
IF TALENT:小人体型
	TIMES LOCAL , 0.50
	TIMES LOCAL:1, 1.50
ENDIF

;快Aのソースが0以上で処女で貞操観念のとき、屈服のソースを三分の一にする
IF EXP:Ｖ経験 == 0 && TALENT:貞操観念 && SOURCE:快Ａ > 0
	SOURCE:屈従 /= 3
ENDIF

UP:快Ａ += LOCAL
UP:欲情 += LOCAL:1
;-------------------------------------------------
;快Ｂのソース
;-------------------------------------------------
;Ｂ敏感とＢ鈍感はここで処理
SIF TALENT:Ｂ鈍感
	TIMES SOURCE:快Ｂ , 0.50
SIF TALENT:Ｂ敏感
	TIMES SOURCE:快Ｂ , 1.50

;陥没乳首
IF TALENT:陥没乳首
	;欲情のPLAMLV3以上
	IF PALAM:欲情 >= PALAMLV:3
		TIMES SOURCE:快Ｂ , 1.50
	ELSE
		TIMES SOURCE:快Ｂ , 0.50
	ENDIF
ENDIF

;掻痒剤使ってる場合、快感が跳ね上がる
SIF STAIN:3 & 1024
	TIMES SOURCE:快Ｂ , 2.00

;B感覚
SIF ABL:Ｂ感覚 == 0
	TIMES SOURCE:快Ｂ , 0.50
SIF ABL:Ｂ感覚 == 1
	TIMES SOURCE:快Ｂ , 1.50
SIF ABL:Ｂ感覚 == 2
	TIMES SOURCE:快Ｂ , 2.00
SIF ABL:Ｂ感覚 == 3
	TIMES SOURCE:快Ｂ , 3.00
SIF ABL:Ｂ感覚 == 4
	TIMES SOURCE:快Ｂ , 4.50
SIF ABL:Ｂ感覚 == 5
	TIMES SOURCE:快Ｂ , 6.00
SIF ABL:Ｂ感覚 == 6
	TIMES SOURCE:快Ｂ , 8.00
SIF ABL:Ｂ感覚 == 7
	TIMES SOURCE:快Ｂ , 10.00
SIF ABL:Ｂ感覚 == 8
	TIMES SOURCE:快Ｂ , 12.00
SIF ABL:Ｂ感覚 == 9
	TIMES SOURCE:快Ｂ , 13.50
SIF ABL:Ｂ感覚 >= 10
	TIMES SOURCE:快Ｂ , 15.00

LOCAL = SOURCE:快Ｂ

;PALAM:欲情をみる
SIF PALAM:欲情 < PALAMLV:1
	TIMES LOCAL , 0.80
SIF PALAM:欲情 < PALAMLV:2
	TIMES LOCAL , 1.00
SIF PALAM:欲情 < PALAMLV:3
	TIMES LOCAL , 1.20
SIF PALAM:欲情 < PALAMLV:4
	TIMES LOCAL , 1.50
SIF PALAM:欲情 >= PALAMLV:4
	TIMES LOCAL , 1.80

LOCAL:1= SOURCE:快Ｂ

;ABL:欲望をみる
SIF ABL:欲望 == 0
	TIMES LOCAL:1, 0.50
SIF ABL:欲望 == 1
	TIMES LOCAL:1, 0.60
SIF ABL:欲望 == 2
	TIMES LOCAL:1, 0.70
SIF ABL:欲望 == 3
	TIMES LOCAL:1, 0.80
SIF ABL:欲望 == 4
	TIMES LOCAL:1, 0.90
SIF ABL:欲望 == 5
	TIMES LOCAL:1, 1.00
SIF ABL:欲望 == 6
	TIMES LOCAL:1, 1.05
SIF ABL:欲望 == 7
	TIMES LOCAL:1, 1.10
SIF ABL:欲望 == 8
	TIMES LOCAL:1, 1.15
SIF ABL:欲望 == 9
	TIMES LOCAL:1, 1.20
SIF ABL:欲望 >= 10
	TIMES LOCAL:1, 1.40

;小人体型
IF TALENT:小人体型
	TIMES LOCAL , 1.50
	TIMES LOCAL:1, 1.20
	UP:潤滑 += LOCAL:1/2
ENDIF

;Ｂ敏感が無いかＢ感覚３以下の時、Ｂでイキづらくなる
SIF (!TALENT:Ｂ敏感 || ABL:Ｂ感覚 <= 2) && PALAM:快Ｂ >= PALAMLV:4
	TIMES LOCAL , 0.30

UP:快Ｂ += LOCAL
UP:欲情 += LOCAL:1
;-------------------------------------------------
;同じコマンドの連続実行による上下の処理（快楽系）
;-------------------------------------------------
IF SELECTCOM == PREVCOM
	;UP:快Ｃ,UP:快Ｖ ,UP:快Ａ,UP:快Ｂは絶頂に絡むので先に処理してある
	UP:快Ｃ /= 2
	UP:快Ｖ /= 2
	UP:快Ａ /= 2
	UP:快Ｂ /= 2
ENDIF

;-------------------------------------------------
;気力０による上下の処理（快楽系）
;-------------------------------------------------
IF BASE:気力 <= 0
	;UP:快Ｃ,UP:快Ｖ ,UP:快Ａ,UP:快Ｂは絶頂に絡むので先に処理してある
	UP:快Ｃ /= 2
	UP:快Ｖ /= 2
	UP:快Ａ /= 2
	UP:快Ｂ /= 2
ENDIF

;-------------------------------------------------
;相性による上下の処理（快楽系）
;-------------------------------------------------
R = NO:PLAYER
SIF RELATION:R == 0
	LOCAL:2 = 100
;女好き、男好き、子供好き
IF (TALENT:女好き && MALE(PLAYER) == 0 && TALENT:PLAYER:小人体型 == 0) || (TALENT:男好き && MALE(PLAYER) && TALENT:PLAYER:小人体型 == 0) || (TALENT:子供好き && TALENT:PLAYER:小人体型)
	IF RELATION:R == 0
		C = 150
	ELSE
		C = RELATION:R + 50
		SIF C > 200
			C = 200
	ENDIF
;男嫌い、女嫌い(恋慕陥落で無効)
ELSEIF (TALENT:男嫌い && MALE(PLAYER) && (TALENT:恋慕 == 0 && TALENT:親愛 == 0)) || (TALENT:女嫌い && MALE(PLAYER) == 0 && (TALENT:恋慕 == 0 && TALENT:親愛 == 0))
	IF RELATION:R == 0
		C = 50
	ELSE
		C = RELATION:R - 50
		SIF C <= 0
		C = 10
	ENDIF
ELSE
	C = RELATION:R
ENDIF
IF C != 0
	UP:快Ｃ *= C
	UP:快Ｃ /= 100
	UP:快Ｖ *= C
	UP:快Ｖ /= 100
	UP:快Ａ *= C
	UP:快Ａ /= 100
	UP:快Ｂ *= C
	UP:快Ｂ /= 100
ENDIF

;-------------------------------------------------
;快感の否定は、快ソースの数値に応じて、抑鬱増加（淫乱、娼婦で無効）
;-------------------------------------------------
SIF TALENT:快感の否定 && !TALENT:淫乱 && !TALENT:娼婦
	SOURCE:鬱屈 += (UP:快Ｃ+UP:快Ｖ +UP:快Ａ+UP:快Ｂ)/10

;-------------------------------------------------
;素質などによる上下の処理（快楽系）
;-------------------------------------------------
;媚薬
IF TEQUIP:媚薬
	TIMES UP:快Ｃ , 2.00
	TIMES UP:快Ｖ , 2.00
	TIMES UP:快Ａ , 2.00
	TIMES UP:快Ｂ , 2.00
ENDIF

;掻痒剤
IF ZUIKI(TARGET)
	TIMES UP:快Ｃ , 2.00
	TIMES UP:快Ｖ , 2.00
	TIMES UP:快Ａ , 2.00
	TIMES UP:快Ｂ , 2.00
ENDIF

;利尿剤
IF TEQUIP:利尿剤
	TIMES UP:快Ｃ , 0.70
	TIMES UP:快Ｖ , 0.70
	TIMES UP:快Ａ , 0.70
	TIMES UP:快Ｂ , 0.70
ENDIF

;酩酊プレイ
IF TEQUIP:酩酊プレイ
	;日本酒　もしくは　日本酒・ビールを飲んだ下戸
	IF TFLAG:76 == 3 || (TALENT:下戸 && TFLAG:76 != 1)
		TIMES UP:快Ｃ , 0.50
		TIMES UP:快Ｖ , 0.50
		TIMES UP:快Ａ , 0.50
		TIMES UP:快Ｂ , 0.50
	;ビール
	ELSEIF TFLAG:76 == 2
		TIMES UP:快Ｃ , 0.70
		TIMES UP:快Ｖ , 0.70
		TIMES UP:快Ａ , 0.70
		TIMES UP:快Ｂ , 0.70
	;甘酒
	ELSE
		;上戸を持たない
		IF !TALENT:上戸
			TIMES UP:快Ｃ , 0.90
			TIMES UP:快Ｖ , 0.90
			TIMES UP:快Ａ , 0.90
			TIMES UP:快Ｂ , 0.90
		ENDIF
	ENDIF
ENDIF

;-------------------------------------------------
;陥落素質
;-------------------------------------------------
;淫乱
IF TALENT:淫乱
	TIMES UP:快Ｃ , 1.20
	TIMES UP:快Ｖ , 1.20
	TIMES UP:快Ａ , 1.20
	TIMES UP:快Ｂ , 1.20
ENDIF

;娼婦
IF TALENT:娼婦
	TIMES UP:快Ｃ , 1.50
	TIMES UP:快Ｖ , 1.50
	TIMES UP:快Ａ , 1.50
	TIMES UP:快Ｂ , 1.50
ENDIF

;-------------------------------------------------
;素質
;-------------------------------------------------
;自制心
IF TALENT:自制心
	TIMES UP:快Ｃ , 0.70
	TIMES UP:快Ｖ , 0.90
	TIMES UP:快Ａ , 1.00
	TIMES UP:快Ｂ , 0.70
ENDIF

;即落ち
IF TALENT:即落ち
	TIMES UP:快Ｃ , 2.00
	TIMES UP:快Ｖ , 2.00
	TIMES UP:快Ａ , 2.00
	TIMES UP:快Ｂ , 2.00
ENDIF
;自慰狂い
SIF TALENT:自慰狂い
	TIMES UP:快Ｃ , 1.20
;淫壺
SIF TALENT:淫壺
	TIMES UP:快Ｖ , 1.20
;尻穴狂い
SIF TALENT:尻穴狂い
	TIMES UP:快Ａ , 1.20
;淫乳
SIF TALENT:淫乳
	TIMES UP:快Ｂ , 1.20
;セックス狂
IF TALENT:セックス狂 && (SEXPLAY(TARGET) || SELECTCOM == 430 || SELECTCOM == 431 || SELECTCOM == 405 || SELECTCOM == 406)
	TIMES UP:快Ｃ , 1.20
	TIMES UP:快Ｖ , 1.20
	TIMES UP:快Ａ , 1.20
	TIMES UP:快Ｂ , 1.20
ENDIF
;包茎
SIF TALENT:包茎
	TIMES UP:快Ｃ , 0.90
;オトコ
IF TALENT:オトコ
	TIMES UP:快Ａ , 1.30
ENDIF

;経験豊富
IF TALENT:経験豊富
	IF ABL:PLAYER:技巧 > 8
		TIMES UP:快Ｃ , 1.20
		TIMES UP:快Ｖ , 1.20
		TIMES UP:快Ａ , 1.20
		TIMES UP:快Ｂ , 1.20
	ELSEIF ABL:PLAYER:技巧 < 3
		TIMES UP:快Ｃ , 0.20
		TIMES UP:快Ｖ , 0.20
		TIMES UP:快Ａ , 0.20
		TIMES UP:快Ｂ , 0.20
	ELSEIF ABL:PLAYER:技巧 < 5
		TIMES UP:快Ｃ , 0.50
		TIMES UP:快Ｖ , 0.50
		TIMES UP:快Ａ , 0.50
		TIMES UP:快Ｂ , 0.50
	ENDIF
ENDIF

;-------------------------------------------------
;難易度による上下の処理（快楽系）
;-------------------------------------------------
;EASY
IF FLAG:4 == 1
	TIMES UP:快Ｃ , 1.60
	TIMES UP:快Ｖ , 1.60
	TIMES UP:快Ａ , 1.60
	TIMES UP:快Ｂ , 1.60
;NORMAL
ELSEIF FLAG:4 == 2
	TIMES UP:快Ｃ , 1.20
	TIMES UP:快Ｖ , 1.20
	TIMES UP:快Ａ , 1.20
	TIMES UP:快Ｂ , 1.20
;HARD
ELSEIF FLAG:4 == 3
	TIMES UP:快Ｃ , 0.80
	TIMES UP:快Ｖ , 0.80
	TIMES UP:快Ａ , 0.80
	TIMES UP:快Ｂ , 0.80
ENDIF


;指挿入れの慣らしギミック用処理、V経験が0の時は快Vは99で最大にする
;LOCAL = UP:快Ｖ + PALAM:快Ｖ
;IF LOCAL >= 100 && EXP:Ｖ経験 == 0
;	UP:快Ｖ = 0
;	PALAM:快Ｖ = 99
;ENDIF
;-------------------------------------------------
;愛液処理
;-------------------------------------------------
LOCAL = UP:快Ｃ + UP:快Ｖ + UP:快Ａ + UP:快Ｂ
;快Ｃ＋快Ｖ＋快Ａ＋快Ｂが合わせて100以上上昇ならその20%の液体のソースが加わる
IF LOCAL > 100
	;濡れやすいと濡れにくいはここで処理
	SIF TALENT:濡れやすい
		TIMES LOCAL , 3.00
	SIF TALENT:濡れにくい
		TIMES LOCAL , 0.40
	SOURCE:液体 += LOCAL / 5
ENDIF

;-------------------------------------------------
;強精神薬による絶頂キャンセル
;-------------------------------------------------
SIF TEQUIP:強精神薬 > 1
	CALL ECST_CANCEL

;-------------------------------------------------
;絶頂チェック
;-------------------------------------------------
CALL ORGASM_ADD_CHECK
;-------------------------------------------------
;奴隷にペニスがある場合のＣ絶頂＆射精チェック
;-------------------------------------------------
CALL TARGET_EJAC_CORGASM_CHECK

;-------------------------------------------------
;絶頂処理
;-------------------------------------------------
CALL ORGASM_ADD
;-------------------------------------------------
;調教対象の射精処理
;-------------------------------------------------
CALL TARGET_EJAC_CHECK

;-------------------------------------------------
;調教対象の射精チェック（噴乳）
;-------------------------------------------------
CALL TARGET_MILK_CHECK

;-------------------------------------------------
;情愛のソース
;-------------------------------------------------
LOCAL = SOURCE:情愛

;ABL:従順をみる
SIF ABL:従順 == 0
	TIMES LOCAL , 0.10
SIF ABL:従順 == 1
	TIMES LOCAL , 0.50
SIF ABL:従順 == 2
	TIMES LOCAL , 1.00
SIF ABL:従順 == 3
	TIMES LOCAL , 1.50
SIF ABL:従順 == 4
	TIMES LOCAL , 2.00
SIF ABL:従順 == 5
	TIMES LOCAL , 2.50
SIF ABL:従順 == 6
	TIMES LOCAL , 3.00
SIF ABL:従順 == 7
	TIMES LOCAL , 3.50
SIF ABL:従順 == 8
	TIMES LOCAL , 4.00
SIF ABL:従順 == 9
	TIMES LOCAL , 5.00
SIF ABL:従順 >= 10
	TIMES LOCAL , 6.00

LOCAL:1 = SOURCE:情愛

;欲望を見る
SIF ABL:欲望 == 0
	TIMES LOCAL:1 , 0.00
SIF ABL:欲望 == 1
	TIMES LOCAL:1 , 0.40
SIF ABL:欲望 == 2
	TIMES LOCAL:1 , 0.80
SIF ABL:欲望 == 3
	TIMES LOCAL:1 , 1.20
SIF ABL:欲望 == 4
	TIMES LOCAL:1 , 1.60
SIF ABL:欲望 == 5
	TIMES LOCAL:1 , 2.00
SIF ABL:欲望 == 6
	TIMES LOCAL:1 , 2.40
SIF ABL:欲望 == 7
	TIMES LOCAL:1 , 2.80
SIF ABL:欲望 == 8
	TIMES LOCAL:1 , 3.20
SIF ABL:欲望 == 9
	TIMES LOCAL:1 , 3.60
SIF ABL:欲望 >= 10
	TIMES LOCAL:1 , 5.00

UP:恭順 += LOCAL
UP:欲情 += LOCAL:1
;-------------------------------------------------
;性行動のソース
;-------------------------------------------------
LOCAL = SOURCE:性行動

;ABL:技巧をみる
SIF ABL:技巧 == 0
	TIMES LOCAL , 0.60
SIF ABL:技巧 == 1
	TIMES LOCAL , 1.20
SIF ABL:技巧 == 2
	TIMES LOCAL , 1.80
SIF ABL:技巧 == 3
	TIMES LOCAL , 2.40
SIF ABL:技巧 == 4
	TIMES LOCAL , 3.00
SIF ABL:技巧 == 5
	TIMES LOCAL , 3.60
SIF ABL:技巧 == 6
	TIMES LOCAL , 4.20
SIF ABL:技巧 == 7
	TIMES LOCAL , 4.80
SIF ABL:技巧 == 8
	TIMES LOCAL , 5.40
SIF ABL:技巧 == 9
	TIMES LOCAL , 6.00
SIF ABL:技巧 >= 10
	TIMES LOCAL , 7.00

;ABL:奉仕精神をみる
SIF ABL:奉仕精神 == 0
	TIMES LOCAL , 0.60
SIF ABL:奉仕精神 == 1
	TIMES LOCAL , 0.80
SIF ABL:奉仕精神 == 2
	TIMES LOCAL , 1.00
SIF ABL:奉仕精神 == 3
	TIMES LOCAL , 1.20
SIF ABL:奉仕精神 == 4
	TIMES LOCAL , 1.40
SIF ABL:奉仕精神 == 5
	TIMES LOCAL , 1.70
SIF ABL:奉仕精神 == 6
	TIMES LOCAL , 2.00
SIF ABL:奉仕精神 == 7
	TIMES LOCAL , 2.40
SIF ABL:奉仕精神 == 8
	TIMES LOCAL , 2.80
SIF ABL:奉仕精神 == 9
	TIMES LOCAL , 4.00
SIF ABL:奉仕精神 >= 10
	TIMES LOCAL , 5.00

UP:習得 += LOCAL
;-------------------------------------------------
;達成のソース
;-------------------------------------------------
LOCAL = SOURCE:達成感

;ABL:従順をみる
SIF ABL:従順 == 0
	TIMES LOCAL , 0.50
SIF ABL:従順 == 1
	TIMES LOCAL , 1.00
SIF ABL:従順 == 2
	TIMES LOCAL , 1.50
SIF ABL:従順 == 3
	TIMES LOCAL , 2.00
SIF ABL:従順 == 4
	TIMES LOCAL , 2.50
SIF ABL:従順 == 5
	TIMES LOCAL , 3.00
SIF ABL:従順 == 6
	TIMES LOCAL , 3.50
SIF ABL:従順 == 7
	TIMES LOCAL , 4.00
SIF ABL:従順 == 8
	TIMES LOCAL , 4.50
SIF ABL:従順 == 9
	TIMES LOCAL , 5.00
SIF ABL:従順 >= 10
	TIMES LOCAL , 6.00

;ABL:奉仕精神をみる
SIF ABL:奉仕精神 == 0
	TIMES LOCAL , 0.00
SIF ABL:奉仕精神 == 1
	TIMES LOCAL , 0.50
SIF ABL:奉仕精神 == 2
	TIMES LOCAL , 1.00
SIF ABL:奉仕精神 == 3
	TIMES LOCAL , 1.50
SIF ABL:奉仕精神 == 4
	TIMES LOCAL , 2.00
SIF ABL:奉仕精神 == 5
	TIMES LOCAL , 2.50
SIF ABL:奉仕精神 == 6
	TIMES LOCAL , 3.00
SIF ABL:奉仕精神 == 7
	TIMES LOCAL , 3.50
SIF ABL:奉仕精神 == 8
	TIMES LOCAL , 4.00
SIF ABL:奉仕精神 == 9
	TIMES LOCAL , 4.50
SIF ABL:奉仕精神 >= 10
	TIMES LOCAL , 6.00

UP:恭順 += LOCAL
;-------------------------------------------------
;痛みのソース
;-------------------------------------------------
LOCAL = SOURCE:痛み
LOCAL:1 = SOURCE:痛み
LOCAL:2 = SOURCE:痛み/20

;マゾっ気
SIF ABL:マゾっ気 == 0
	TIMES LOCAL:1 , 0.00
SIF ABL:マゾっ気 == 1
	TIMES LOCAL:1 , 0.10
SIF ABL:マゾっ気 == 2
	TIMES LOCAL:1 , 0.20
SIF ABL:マゾっ気 == 3
	TIMES LOCAL:1 , 0.30
SIF ABL:マゾっ気 == 4
	TIMES LOCAL:1 , 0.45
SIF ABL:マゾっ気 == 5
	TIMES LOCAL:1 , 0.60
SIF ABL:マゾっ気 == 6
	TIMES LOCAL:1 , 0.75
SIF ABL:マゾっ気 == 7
	TIMES LOCAL:1 , 0.90
SIF ABL:マゾっ気 == 8
	TIMES LOCAL:1 , 1.20
SIF ABL:マゾっ気 == 9
	TIMES LOCAL:1 , 1.50
SIF ABL:マゾっ気 >= 10
	TIMES LOCAL:1 , 3.00

;小人体型
IF TALENT:小人体型
	TIMES LOCAL , 2.00
	TIMES LOCAL:1 , 0.75
ENDIF

;調教者が【サド、ドＳ】
SELECTCASE TALENT:PLAYER:サド
	CASE 1
		TIMES LOCAL:1 , 1.50
	CASE 2
		TIMES LOCAL:1 , 2.50
ENDSELECT

;臆病
SIF TALENT:臆病
	TIMES LOCAL:2 , 2.00

;マゾっ気があるとPALAM:欲情も上がる
;そのとき調教者が【サド】だと効果的
;苦痛に応じて恐怖のソースが増加する
UP:苦痛 += LOCAL
UP:欲情 += LOCAL:1
UP:恐怖 += LOCAL:2
;-------------------------------------------------
;恐れのソース
;-------------------------------------------------
LOCAL = SOURCE:恐れ

;ABL:従順をみる（恐怖よりは畏怖に近いと解釈）
SIF ABL:従順 == 0
	TIMES LOCAL , 1.00
SIF ABL:従順 == 1
	TIMES LOCAL , 1.50
SIF ABL:従順 == 2
	TIMES LOCAL , 2.00
SIF ABL:従順 == 3
	TIMES LOCAL , 2.50
SIF ABL:従順 == 4
	TIMES LOCAL , 3.00
SIF ABL:従順 == 5
	TIMES LOCAL , 3.50
SIF ABL:従順 == 6
	TIMES LOCAL , 4.00
SIF ABL:従順 == 7
	TIMES LOCAL , 4.50
SIF ABL:従順 == 8
	TIMES LOCAL , 5.00
SIF ABL:従順 == 9
	TIMES LOCAL , 5.50
SIF ABL:従順 >= 10
	TIMES LOCAL , 7.00

;調教者が[威圧](崩壊か感情乏しい場合は無効)
SIF TALENT:PLAYER:威圧 && !TALENT:崩壊 && !TALENT:感情乏しい
	TIMES LOCAL, 1.50

UP:恐怖 += LOCAL
;-------------------------------------------------
;中毒充足のソース
;-------------------------------------------------
LOCAL = SOURCE:中毒充足
LOCAL:1 = SOURCE:中毒充足

;欲望
IF ABL:欲望 == 0
	TIMES LOCAL , 0.40
	TIMES LOCAL:1 , 0.50
ELSEIF ABL:欲望 == 1
	TIMES LOCAL , 0.60
	TIMES LOCAL:1 , 0.70
ELSEIF ABL:欲望 == 2
	TIMES LOCAL , 0.80
	TIMES LOCAL:1 , 0.90
ELSEIF ABL:欲望 == 3
	TIMES LOCAL , 1.00
	TIMES LOCAL:1 , 1.10
ELSEIF ABL:欲望 == 4
	TIMES LOCAL , 1.20
	TIMES LOCAL:1 , 1.30
ELSEIF ABL:欲望 == 5
	TIMES LOCAL , 1.40
	TIMES LOCAL:1 , 1.50
ELSEIF ABL:欲望 == 6
	TIMES LOCAL , 1.60
	TIMES LOCAL:1 , 1.70
ELSEIF ABL:欲望 == 7
	TIMES LOCAL , 1.80
	TIMES LOCAL:1 , 1.90
ELSEIF ABL:欲望 == 8
	TIMES LOCAL , 2.00
	TIMES LOCAL:1 , 2.10
ELSEIF ABL:欲望 == 9
	TIMES LOCAL , 2.20
	TIMES LOCAL:1 , 2.30
ELSEIF ABL:欲望 >= 10
	TIMES LOCAL , 2.50
	TIMES LOCAL:1 , 2.70
ENDIF

UP:恭順 += LOCAL
UP:欲情 += LOCAL:1
;-------------------------------------------------
;液体のソース
;-------------------------------------------------
LOCAL = SOURCE:液体
SIF VAGINA(TARGET)
	LOCAL = LOCAL / 2
;小人体型
IF TALENT:小人体型 && TALENT:PLAYER:小人体型 == 0
	SIF SELECTCOM != 60 && SELECTCOM != 300
		TIMES LOCAL , 0.40
ENDIF

UP:潤滑 += LOCAL
;-------------------------------------------------
;欲情のソース
;-------------------------------------------------
LOCAL = SOURCE:欲情

;欲望を見る
SIF ABL:欲望 == 0
	TIMES LOCAL , 0.00
SIF ABL:欲望 == 1
	TIMES LOCAL , 0.40
SIF ABL:欲望 == 2
	TIMES LOCAL , 0.80
SIF ABL:欲望 == 3
	TIMES LOCAL , 1.20
SIF ABL:欲望 == 4
	TIMES LOCAL , 1.60
SIF ABL:欲望 == 5
	TIMES LOCAL , 2.00
SIF ABL:欲望 == 6
	TIMES LOCAL , 2.40
SIF ABL:欲望 == 7
	TIMES LOCAL , 2.80
SIF ABL:欲望 == 8
	TIMES LOCAL , 3.20
SIF ABL:欲望 == 9
	TIMES LOCAL , 3.60
SIF ABL:欲望 >= 10
	TIMES LOCAL , 5.00

UP:欲情 += LOCAL
;-------------------------------------------------
;恭順のソース
;-------------------------------------------------
LOCAL = SOURCE:恭順

;ABL:従順をみる
SIF ABL:従順 == 0
	TIMES LOCAL , 0.50
SIF ABL:従順 == 1
	TIMES LOCAL , 0.80
SIF ABL:従順 == 2
	TIMES LOCAL , 1.00
SIF ABL:従順 == 3
	TIMES LOCAL , 1.20
SIF ABL:従順 == 4
	TIMES LOCAL , 1.40
SIF ABL:従順 == 5
	TIMES LOCAL , 1.60
SIF ABL:従順 == 6
	TIMES LOCAL , 1.80
SIF ABL:従順 == 7
	TIMES LOCAL , 2.00
SIF ABL:従順 == 8
	TIMES LOCAL , 2.40
SIF ABL:従順 == 9
	TIMES LOCAL , 3.00
SIF ABL:従順 >= 10
	TIMES LOCAL , 5.00

UP:恭順 += LOCAL
;-------------------------------------------------
;露出のソース
;-------------------------------------------------
;恥じらいと恥薄いはここで処理
SIF TALENT:恥じらい
	TIMES SOURCE:露出 , 2.00
SIF TALENT:恥薄い
	TIMES SOURCE:露出 , 0.50

;潤滑アップの50％を露出のソースに加える
;ただし液体追加のソースのぶんは引く
SOURCE:露出 += (UP:潤滑-SOURCE:液体) / 2
SIF SOURCE:露出 < 0
	SOURCE:露出 = 0
LOCAL = SOURCE:露出

;ABL:露出癖をみる
SIF ABL:露出癖 == 0
	TIMES LOCAL , 0.00
SIF ABL:露出癖 == 1
	TIMES LOCAL , 0.10
SIF ABL:露出癖 == 2
	TIMES LOCAL , 0.20
SIF ABL:露出癖 == 3
	TIMES LOCAL , 0.40
SIF ABL:露出癖 == 4
	TIMES LOCAL , 0.60
SIF ABL:露出癖 == 5
	TIMES LOCAL , 0.80
SIF ABL:露出癖 == 6
	TIMES LOCAL , 1.00
SIF ABL:露出癖 == 7
	TIMES LOCAL , 1.20
SIF ABL:露出癖 == 8
	TIMES LOCAL , 1.40
SIF ABL:露出癖 == 9
	TIMES LOCAL , 1.60
SIF ABL:露出癖 >= 10
	TIMES LOCAL , 2.00

LOCAL:1 = SOURCE:露出

;PALAM:恥情をみる
;恥ずかしさを感じれば感じるほどあまり恥ずかしくなくなる
IF PALAM:恥情 < PALAMLV:1
	TIMES LOCAL:1 , 1.00
ELSEIF PALAM:恥情 < PALAMLV:2
	TIMES LOCAL:1 , 0.90
ELSEIF PALAM:恥情 < PALAMLV:3
	TIMES LOCAL:1 , 0.80
ELSEIF PALAM:恥情 < PALAMLV:4
	TIMES LOCAL:1 , 0.70
ELSEIF PALAM:恥情 >= PALAMLV:4
	TIMES LOCAL:1 , 0.60
ENDIF


UP:欲情 += LOCAL
UP:恥情 += LOCAL:1


;-------------------------------------------------
;屈従のソース
;-------------------------------------------------
LOCAL = SOURCE:屈従

;ABL:従順をみる
SIF ABL:従順 == 0
	TIMES LOCAL , 0.50
SIF ABL:従順 == 1
	TIMES LOCAL , 1.00
SIF ABL:従順 == 2
	TIMES LOCAL , 1.50
SIF ABL:従順 == 3
	TIMES LOCAL , 2.00
SIF ABL:従順 == 4
	TIMES LOCAL , 2.50
SIF ABL:従順 == 5
	TIMES LOCAL , 3.00
SIF ABL:従順 == 6
	TIMES LOCAL , 3.50
SIF ABL:従順 == 7
	TIMES LOCAL , 4.00
SIF ABL:従順 == 8
	TIMES LOCAL , 4.50
SIF ABL:従順 == 9
	TIMES LOCAL , 5.00
SIF ABL:従順 >= 10
	TIMES LOCAL , 6.00

;ABL:奉仕精神をみる
SIF ABL:奉仕精神 == 0
	TIMES LOCAL , 1.00
SIF ABL:奉仕精神 == 1
	TIMES LOCAL , 1.50
SIF ABL:奉仕精神 == 2
	TIMES LOCAL , 2.00
SIF ABL:奉仕精神 == 3
	TIMES LOCAL , 2.50
SIF ABL:奉仕精神 == 4
	TIMES LOCAL , 3.00
SIF ABL:奉仕精神 == 5
	TIMES LOCAL , 3.50
SIF ABL:奉仕精神 == 6
	TIMES LOCAL , 4.00
SIF ABL:奉仕精神 == 7
	TIMES LOCAL , 4.50
SIF ABL:奉仕精神 == 8
	TIMES LOCAL , 5.00
SIF ABL:奉仕精神 == 9
	TIMES LOCAL , 5.50
SIF ABL:奉仕精神 >= 10
	TIMES LOCAL , 7.00

UP:屈服 += LOCAL

;-------------------------------------------------
;不潔のソース
;-------------------------------------------------
LOCAL = SOURCE:不潔

;ABL:従順をみる
SIF ABL:従順 == 0
	TIMES LOCAL , 1.00
SIF ABL:従順 == 1
	TIMES LOCAL , 0.90
SIF ABL:従順 == 2
	TIMES LOCAL , 0.80
SIF ABL:従順 == 3
	TIMES LOCAL , 0.70
SIF ABL:従順 == 4
	TIMES LOCAL , 0.60
SIF ABL:従順 == 5
	TIMES LOCAL , 0.50
SIF ABL:従順 == 6
	TIMES LOCAL , 0.40
SIF ABL:従順 == 7
	TIMES LOCAL , 0.30
SIF ABL:従順 == 8
	TIMES LOCAL , 0.20
SIF ABL:従順 == 9
	TIMES LOCAL , 0.10
SIF ABL:従順 >= 10
	TIMES LOCAL , 0.00

UP:不快 += LOCAL

;-------------------------------------------------
;鬱屈のソース
;-------------------------------------------------
LOCAL = SOURCE:鬱屈

;ABL:従順をみる
SIF ABL:従順 == 0
	TIMES LOCAL , 1.00
SIF ABL:従順 == 1
	TIMES LOCAL , 0.80
SIF ABL:従順 == 2
	TIMES LOCAL , 0.60
SIF ABL:従順 == 3
	TIMES LOCAL , 0.40
SIF ABL:従順 == 4
	TIMES LOCAL , 0.30
SIF ABL:従順 == 5
	TIMES LOCAL , 0.20
SIF ABL:従順 == 6
	TIMES LOCAL , 0.10
SIF ABL:従順 == 7
	TIMES LOCAL , 0.08
SIF ABL:従順 == 8
	TIMES LOCAL , 0.06
SIF ABL:従順 == 9
	TIMES LOCAL , 0.04
SIF ABL:従順 >= 10
	TIMES LOCAL , 0.00

;ABL:欲望をみる
SIF ABL:欲望 == 0
	TIMES LOCAL , 1.00
SIF ABL:欲望 == 1
	TIMES LOCAL , 0.90
SIF ABL:欲望 == 2
	TIMES LOCAL , 0.80
SIF ABL:欲望 == 3
	TIMES LOCAL , 0.70
SIF ABL:欲望 == 4
	TIMES LOCAL , 0.60
SIF ABL:欲望 == 5
	TIMES LOCAL , 0.50
SIF ABL:欲望 == 6
	TIMES LOCAL , 0.40
SIF ABL:欲望 == 7
	TIMES LOCAL , 0.30
SIF ABL:欲望 == 8
	TIMES LOCAL , 0.20
SIF ABL:欲望 == 9
	TIMES LOCAL , 0.10
SIF ABL:欲望 >= 10
	TIMES LOCAL , 0.00

UP:抑鬱 += LOCAL

;-------------------------------------------------
;逸脱のソース
;-------------------------------------------------
;好奇心と保守的はここで処理
SIF TALENT:好奇心
	TIMES SOURCE:逸脱 , 0.80
SIF TALENT:保守的
	TIMES SOURCE:逸脱 , 2.00

LOCAL = SOURCE:逸脱

;ABL:従順をみる
SIF ABL:従順 == 0
	TIMES LOCAL , 1.00
SIF ABL:従順 == 1
	TIMES LOCAL , 0.80
SIF ABL:従順 == 2
	TIMES LOCAL , 0.60
SIF ABL:従順 == 3
	TIMES LOCAL , 0.40
SIF ABL:従順 == 4
	TIMES LOCAL , 0.30
SIF ABL:従順 == 5
	TIMES LOCAL , 0.20
SIF ABL:従順 == 6
	TIMES LOCAL , 0.10
SIF ABL:従順 == 7
	TIMES LOCAL , 0.08
SIF ABL:従順 == 8
	TIMES LOCAL , 0.06
SIF ABL:従順 == 9
	TIMES LOCAL , 0.04
SIF ABL:従順 >= 10
	TIMES LOCAL , 0.00

;ABL:マゾっ気をみる
SIF ABL:マゾっ気 == 0
	TIMES LOCAL , 1.00
SIF ABL:マゾっ気 == 1
	TIMES LOCAL , 0.90
SIF ABL:マゾっ気 == 2
	TIMES LOCAL , 0.80
SIF ABL:マゾっ気 == 3
	TIMES LOCAL , 0.70
SIF ABL:マゾっ気 == 4
	TIMES LOCAL , 0.60
SIF ABL:マゾっ気 == 5
	TIMES LOCAL , 0.50
SIF ABL:マゾっ気 == 6
	TIMES LOCAL , 0.40
SIF ABL:マゾっ気 == 7
	TIMES LOCAL , 0.30
SIF ABL:マゾっ気 == 8
	TIMES LOCAL , 0.20
SIF ABL:マゾっ気 == 9
	TIMES LOCAL , 0.10
SIF ABL:マゾっ気 >= 10
	TIMES LOCAL , 0.00

UP:反感 += LOCAL

;-------------------------------------------------
;反感のソース
;-------------------------------------------------
LOCAL = SOURCE:反発

;ABL:従順をみる
SIF ABL:従順 == 0
	TIMES LOCAL , 1.00
SIF ABL:従順 == 1
	TIMES LOCAL , 0.80
SIF ABL:従順 == 2
	TIMES LOCAL , 0.60
SIF ABL:従順 == 3
	TIMES LOCAL , 0.40
SIF ABL:従順 == 4
	TIMES LOCAL , 0.30
SIF ABL:従順 == 5
	TIMES LOCAL , 0.20
SIF ABL:従順 == 6
	TIMES LOCAL , 0.10
SIF ABL:従順 == 7
	TIMES LOCAL , 0.08
SIF ABL:従順 == 8
	TIMES LOCAL , 0.06
SIF ABL:従順 == 9
	TIMES LOCAL , 0.04
SIF ABL:従順 >= 10
	TIMES LOCAL , 0.00

;ABL:奉仕精神をみる
SIF ABL:奉仕精神 == 0
	TIMES LOCAL , 1.00
SIF ABL:奉仕精神 == 1
	TIMES LOCAL , 0.90
SIF ABL:奉仕精神 == 2
	TIMES LOCAL , 0.80
SIF ABL:奉仕精神 == 3
	TIMES LOCAL , 0.70
SIF ABL:奉仕精神 == 4
	TIMES LOCAL , 0.60
SIF ABL:奉仕精神 == 5
	TIMES LOCAL , 0.50
SIF ABL:奉仕精神 == 6
	TIMES LOCAL , 0.40
SIF ABL:奉仕精神 == 7
	TIMES LOCAL , 0.30
SIF ABL:奉仕精神 == 8
	TIMES LOCAL , 0.20
SIF ABL:奉仕精神 == 9
	TIMES LOCAL , 0.10
SIF ABL:奉仕精神 >= 10
	TIMES LOCAL , 0.00

;ABL:マゾっ気をみる
SIF ABL:マゾっ気 == 0
	TIMES LOCAL , 1.00
SIF ABL:マゾっ気 == 1
	TIMES LOCAL , 0.90
SIF ABL:マゾっ気 == 2
	TIMES LOCAL , 0.80
SIF ABL:マゾっ気 == 3
	TIMES LOCAL , 0.70
SIF ABL:マゾっ気 == 4
	TIMES LOCAL , 0.60
SIF ABL:マゾっ気 == 5
	TIMES LOCAL , 0.50
SIF ABL:マゾっ気 == 6
	TIMES LOCAL , 0.40
SIF ABL:マゾっ気 == 7
	TIMES LOCAL , 0.30
SIF ABL:マゾっ気 == 8
	TIMES LOCAL , 0.20
SIF ABL:マゾっ気 == 9
	TIMES LOCAL , 0.10
SIF ABL:マゾっ気 >= 10
	TIMES LOCAL , 0.00

UP:反感 += LOCAL

;-------------------------------------------------
;素質などによる上下の処理
;-------------------------------------------------
;-------------------------------------------------
;装備系（薬等）
;-------------------------------------------------
;媚薬
IF TEQUIP:媚薬
	TIMES UP:恭順 , 1.20
	TIMES UP:欲情 , 2.00
	TIMES UP:屈服 , 1.20
	TIMES UP:不快 , 0.75
ENDIF

;掻痒剤
IF ZUIKI(TARGET)
	TIMES UP:恭順 , 1.20
	TIMES UP:欲情 , 2.00
	TIMES UP:屈服 , 1.20
	TIMES UP:不快 , 0.75
ENDIF

;利尿剤
IF TEQUIP:利尿剤
	TIMES UP:恭順 , 0.80
	TIMES UP:欲情 , 0.80
	TIMES UP:恥情 , 1.20
	TIMES UP:反感 , 1.50
	TIMES UP:不快 , 1.20
ENDIF

;酩酊プレイ
IF TEQUIP:酩酊プレイ
	;日本酒　もしくは　日本酒・ビールを飲んだ下戸
	IF TFLAG:76 == 3 || (TALENT:下戸 && TFLAG:76 != 1)
		TIMES UP:屈服 , 0.50
		TIMES UP:習得 , 0.50
		TIMES UP:不快 , 0.50
	;ビール
	ELSEIF TFLAG:76 == 2
		TIMES UP:屈服 , 0.70
		TIMES UP:習得 , 0.70
		TIMES UP:不快 , 0.70
	;甘酒
	ELSE
		;上戸を持たない
		IF !TALENT:上戸
			TIMES UP:屈服 , 0.90
			TIMES UP:習得 , 0.90
			TIMES UP:不快 , 0.90
		ENDIF
	ENDIF
ENDIF

;-------------------------------------------------
;陥落素質
;-------------------------------------------------
;恋慕
IF TALENT:恋慕 && ASSIPLAY == 0
	TIMES UP:恭順 , 1.50
	TIMES UP:屈服 , 2.00
	TIMES UP:反感 , 0.50
	TIMES UP:不快 , 0.50
ELSEIF TALENT:恋慕 && ASSIPLAY > 0
	TIMES UP:恭順 , 0.80
	TIMES UP:反感 , 1.20
	TIMES UP:不快 , 1.20
ENDIF

;淫乱
IF TALENT:淫乱
	TIMES UP:恭順 , 1.20
	TIMES UP:屈服 , 1.20
	TIMES UP:反感 , 0.80
	TIMES UP:不快 , 0.80
	TIMES UP:抑鬱 , 0.40
ENDIF

;服従
IF TALENT:服従
	TIMES UP:恭順 , 0.50
	TIMES UP:屈服 , 2.00
	TIMES UP:恐怖 , 1.50
	TIMES UP:反感 , 0.50
ENDIF

;親愛
IF TALENT:親愛 && ASSIPLAY == 0
	TIMES UP:恭順 , 2.00
	TIMES UP:屈服 , 3.00
	TIMES UP:反感 , 0.20
	TIMES UP:不快 , 0.20
	TIMES UP:抑鬱 , 0.50
ELSEIF TALENT:親愛 && ASSIPLAY > 0
	TIMES UP:恭順 , 0.80
	TIMES UP:反感 , 1.20
	TIMES UP:不快 , 1.20
ENDIF

;娼婦
IF TALENT:娼婦
	TIMES UP:恭順 , 1.50
	TIMES UP:屈服 , 1.50
	TIMES UP:反感 , 0.60
	TIMES UP:不快 , 0.60
	TIMES UP:抑鬱 , 0.30
ENDIF

;隷属
IF TALENT:隷属
	TIMES UP:恭順 , 0.20
	TIMES UP:屈服 , 2.50
	TIMES UP:恐怖 , 3.00
	TIMES UP:反感 , 0.25
	TIMES UP:不快 , 0.25
	TIMES UP:抑鬱 , 0.25
ENDIF

;-------------------------------------------------
;素質
;-------------------------------------------------
;臆病
IF TALENT:臆病
	TIMES UP:恐怖 , 1.20
	TIMES UP:反感 , 1.20
ENDIF

;反抗的（服従、隷属で無効）
IF TALENT:反抗的 && (TALENT:服従 == 0 && TALENT:隷属 == 0)
	TIMES UP:恭順 , 0.80
	TIMES UP:屈服 , 0.80
	TIMES UP:反感 , 1.20
ENDIF
;気丈
IF TALENT:気丈
	TIMES UP:恭順 , 0.80
	TIMES UP:欲情 , 0.80
	TIMES UP:屈服 , 0.80
	TIMES UP:恐怖 , 0.80
	TIMES UP:反感 , 1.20
	TIMES UP:抑鬱 , 1.20
ENDIF
;素直
IF TALENT:素直
	TIMES UP:恭順 , 1.20
	TIMES UP:反感 , 0.80
ENDIF
;大人しい
IF TALENT:大人しい
	TIMES UP:恭順 , 0.80
	TIMES UP:反感 , 0.80
ENDIF
;プライド高い
IF TALENT:プライド高い
	TIMES UP:屈服 , 0.80
	TIMES UP:恐怖 , 0.80
	TIMES UP:反感 , 1.20
ENDIF
;生意気
IF TALENT:生意気
	TIMES UP:恭順 , 0.80
	TIMES UP:屈服 , 0.80
	TIMES UP:反感 , 1.20
ENDIF
;プライド低い
IF TALENT:プライド低い
	TIMES UP:屈服 , 1.20
	TIMES UP:恐怖 , 1.20
	TIMES UP:反感 , 0.80
ENDIF
;ツンデレ
IF TALENT:ツンデレ
	;陥落素質がある場合と無い場合で変化する
	IF TALENT:恋慕 || TALENT:淫乱 || TALENT:服従 || TALENT:親愛 || TALENT:娼婦 || TALENT:隷属
		TIMES UP:恭順 , 1.20
		TIMES UP:屈服 , 1.20
		TIMES UP:反感 , 0.80
	ELSE
		TIMES UP:恭順 , 0.80
		TIMES UP:屈服 , 0.80
		TIMES UP:反感 , 1.20
	ENDIF
ENDIF

;威圧(陥落していれば無効)
IF TALENT:威圧 && !TALENT:恋慕 && !TALENT:親愛 && !TALENT:淫乱 && !TALENT:娼婦 && !TALENT:服従 && !TALENT:隷属
	TIMES UP:屈服 , 0.80
	TIMES UP:恐怖 , 0.80
	TIMES UP:反感 , 1.20
ENDIF

;自制心
IF TALENT:自制心
	TIMES UP:屈服 , 0.80
	TIMES UP:恐怖 , 0.80
	TIMES UP:反感 , 1.20
ENDIF
;無関心
IF TALENT:無関心
	TIMES UP:恭順 , 0.80
	TIMES UP:欲情 , 0.80
	TIMES UP:屈服 , 0.80
	TIMES UP:恐怖 , 0.80
	TIMES UP:反感 , 0.80
ENDIF
;感情乏しい
IF TALENT:感情乏しい
	TIMES UP:恭順 , 0.80
	TIMES UP:欲情 , 0.80
	TIMES UP:屈服 , 0.80
	TIMES UP:恥情 , 0.80
	TIMES UP:恐怖 , 0.80
	TIMES UP:反感 , 0.80
	TIMES UP:不快 , 0.80
	TIMES UP:抑鬱 , 0.80
ENDIF
;好奇心
SIF TALENT:好奇心
	TIMES UP:習得 , 1.20
;保守的
SIF TALENT:保守的
	TIMES UP:習得 , 0.80
;楽観的
SIF TALENT:楽観的
	TIMES UP:抑鬱 , 0.80
;悲観的
SIF TALENT:悲観的
	TIMES UP:抑鬱 , 1.20
;目立ちたがり
SIF TALENT:目立ちたがり
	TIMES UP:恭順 , 1.20

;抑圧
IF TALENT:抑圧
	TIMES UP:欲情 , 0.80
	TIMES UP:反感 , 1.20
	TIMES UP:抑鬱 , 1.20
ENDIF
;解放
IF TALENT:解放
	TIMES UP:欲情 , 1.20
	TIMES UP:屈服 , 1.20
ENDIF
;抵抗
IF TALENT:抵抗
	TIMES UP:恭順 , 0.80
	TIMES UP:反感 , 1.20
	TIMES UP:抑鬱 , 1.20
ENDIF

;痛みに弱い
SIF TALENT:痛みに弱い
	TIMES UP:苦痛 , 1.20
;痛みに強い
SIF TALENT:痛みに強い
	TIMES UP:苦痛 , 0.80

;習得早い
SIF TALENT:習得早い
	TIMES UP:習得 , 1.20
;習得遅い
SIF TALENT:習得遅い
	TIMES UP:習得 , 0.80

;献身的
SIF TALENT:献身的
	TIMES UP:屈服 , 1.20

;快感に素直
SIF TALENT:快感に素直
	TIMES UP:欲情 , 1.20
;快感の否定（淫乱、娼婦で無効）
SIF TALENT:快感の否定 && (TALENT:淫乱 == 0 && TALENT:娼婦 == 0)
	TIMES UP:欲情 , 0.80
;即落ち
IF TALENT:即落ち
	TIMES UP:恭順 , 2.00
	TIMES UP:欲情 , 2.00
	TIMES UP:屈服 , 2.00
	TIMES UP:習得 , 2.00
	TIMES UP:恥情 , 2.00
	TIMES UP:恐怖 , 2.00
	TIMES UP:反感 , 0.50
	TIMES UP:不快 , 0.50
	TIMES UP:抑鬱 , 0.50
ENDIF
;自慰狂い
SIF TALENT:自慰狂い
	TIMES UP:欲情 , 1.20
;淫壺
SIF TALENT:淫壺
	TIMES UP:恭順 , 1.20
;尻穴狂い
SIF TALENT:尻穴狂い
	TIMES UP:屈服 , 1.20
;淫乳
SIF TALENT:淫乳
	TIMES UP:恥情 , 1.20
;セックス狂
IF TALENT:セックス狂 && (SEXPLAY(TARGET) || SELECTCOM == 430 || SELECTCOM == 431 || SELECTCOM == 405 || SELECTCOM == 406)
	TIMES UP:恭順 , 1.20
	TIMES UP:欲情 , 1.20
	TIMES UP:屈服 , 1.20
	TIMES UP:恥情 , 1.20
ENDIF

;倒錯的
IF TALENT:倒錯的
	TIMES UP:屈服 , 1.20
	TIMES UP:恥情 , 1.20
ENDIF

;サド、ドＳ
SELECTCASE TALENT:サド
	CASE 1
		TIMES UP:屈服 , 0.90
		TIMES UP:恐怖 , 0.90
	CASE 2
		TIMES UP:屈服 , 0.80
		TIMES UP:恐怖 , 0.80
ENDSELECT

;マゾ、ドМ
SELECTCASE TALENT:マゾ
	CASE 1
		TIMES UP:屈服 , 1.10
		TIMES UP:恐怖 , 1.10
		TIMES UP:抑鬱 , 0.90
	CASE 2
		TIMES UP:屈服 , 1.20
		TIMES UP:恐怖 , 1.20
		TIMES UP:抑鬱 , 0.80
ENDSELECT

;妄信
IF TALENT:妄信
	TIMES UP:屈服 , 1.20
	TIMES UP:反感 , 0.80
ENDIF

;包茎
SIF TALENT:包茎
	TIMES UP:不快 , 1.20
	
;経験豊富
IF TALENT:経験豊富
	IF ABL:PLAYER:技巧 > 8
		TIMES UP:恥情 , 1.20
		TIMES UP:恐怖 , 1.20
		TIMES UP:反感 , 1.20
		TIMES UP:抑鬱 , 1.20
	ELSEIF ABL:PLAYER:技巧 < 3
		TIMES UP:恥情 , 0.20
		TIMES UP:恐怖 , 0.20
		TIMES UP:反感 , 0.20
		TIMES UP:抑鬱 , 0.20
		TIMES UP:18 , 2.00
	ELSEIF ABL:PLAYER:技巧 < 5
		TIMES UP:恥情 , 0.50
		TIMES UP:恐怖 , 0.50
		TIMES UP:反感 , 0.50
		TIMES UP:抑鬱 , 0.50
		TIMES UP:18 , 1.50
	ENDIF
ENDIF

;発情期
IF TALENT:発情期
	TIMES UP:潤滑 , 1.50
	TIMES UP:欲情 , 2.00
	TIMES UP:屈服 , 1.20
	TIMES UP:苦痛 , 0.80
	;未陥落なら
	IF !TALENT:恋慕 && !TALENT:親愛 && !TALENT:淫乱 && !TALENT:娼婦 && !TALENT:服従 && !TALENT:隷属
		TIMES UP:抑鬱 , 1.20
	ENDIF

ENDIF
;-------------------------------------------------
;その他
;-------------------------------------------------
;苦痛刻印
IF MARK:苦痛刻印 == 3
	TIMES UP:苦痛 , 1.30
	TIMES UP:恐怖 , 1.30
ELSEIF MARK:苦痛刻印 == 2
	TIMES UP:苦痛 , 1.20
	TIMES UP:恐怖 , 1.20
ELSEIF MARK:苦痛刻印 == 1
	TIMES UP:苦痛 , 1.10
	TIMES UP:恐怖 , 1.10
ENDIF

;快楽刻印
IF MARK:快楽刻印 == 3
	TIMES UP:欲情 , 1.30
	TIMES UP:習得 , 1.30
ELSEIF MARK:快楽刻印 == 2
	TIMES UP:欲情 , 1.20
	TIMES UP:習得 , 1.20
ELSEIF MARK:快楽刻印 == 1
	TIMES UP:欲情 , 1.10
	TIMES UP:習得 , 1.10
ENDIF

;屈服刻印
IF MARK:屈服刻印 == 3
	TIMES UP:恭順 , 1.30
	TIMES UP:屈服 , 1.30
ELSEIF MARK:屈服刻印 == 2
	TIMES UP:恭順 , 1.20
	TIMES UP:屈服 , 1.20
ELSEIF MARK:屈服刻印 == 1
	TIMES UP:恭順 , 1.10
	TIMES UP:屈服 , 1.10
ENDIF

;反発刻印
IF MARK:反発刻印 >= 3
	TIMES UP:恭順 , 0.10
	TIMES UP:反感 , 1.30
ELSEIF MARK:反発刻印 == 2
	TIMES UP:恭順 , 0.40
	TIMES UP:反感 , 1.20
ELSEIF MARK:反発刻印 == 1
	TIMES UP:恭順 , 0.60
	TIMES UP:反感 , 1.10
ENDIF

;-------------------------------------------------
;難易度などによる上下の処理
;-------------------------------------------------
;EASY
IF FLAG:4 == 1
	TIMES UP:潤滑 , 1.60
	TIMES UP:恭順 , 1.60
	TIMES UP:欲情 , 1.60
	TIMES UP:屈服 , 1.60
	TIMES UP:習得 , 1.60
	TIMES UP:恥情 , 1.60
	TIMES UP:苦痛 , 1.60
	TIMES UP:恐怖 , 1.60
	TIMES UP:反感 , 0.80
	TIMES UP:不快 , 0.80
	TIMES UP:抑鬱 , 0.80
;NORMAL
ELSEIF FLAG:4 == 2
	TIMES UP:潤滑 , 1.20
	TIMES UP:恭順 , 1.20
	TIMES UP:欲情 , 1.20
	TIMES UP:屈服 , 1.20
	TIMES UP:習得 , 1.20
	TIMES UP:恥情 , 1.20
	TIMES UP:苦痛 , 1.20
	TIMES UP:恐怖 , 1.20
	TIMES UP:反感 , 1.20
	TIMES UP:不快 , 1.20
	TIMES UP:抑鬱 , 1.20
;HARD
ELSEIF FLAG:4 == 3
	TIMES UP:潤滑 , 0.80
	TIMES UP:恭順 , 0.80
	TIMES UP:欲情 , 0.80
	TIMES UP:屈服 , 0.80
	TIMES UP:習得 , 0.80
	TIMES UP:恥情 , 0.80
	TIMES UP:苦痛 , 0.80
	TIMES UP:恐怖 , 0.80
	TIMES UP:反感 , 1.60
	TIMES UP:不快 , 1.60
	TIMES UP:抑鬱 , 1.60
ENDIF

;-------------------------------------------------
;相性による上下の処理
;-------------------------------------------------
R = NO:PLAYER
;女好き、男好き、子供好き
IF (TALENT:女好き && MALE(PLAYER) == 0 && TALENT:PLAYER:小人体型 == 0) || (TALENT:男好き && MALE(PLAYER) && TALENT:PLAYER:小人体型 == 0) || (TALENT:子供好き && TALENT:PLAYER:小人体型)
	IF RELATION:R == 0
		LOCAL:2 = 150
	ELSE
		LOCAL:2 = RELATION:R + 50
		SIF LOCAL:2 > 200
			LOCAL:2 = 200
	ENDIF
;男嫌い、女嫌い(恋慕陥落で無効)
ELSEIF (TALENT:男嫌い && MALE(PLAYER) && (TALENT:恋慕 == 0 && TALENT:親愛 == 0)) || (TALENT:女嫌い && MALE(PLAYER) == 0 && (TALENT:恋慕 == 0 && TALENT:親愛 == 0))
	IF RELATION:R == 0
		LOCAL:2 = 50
	ELSE
		LOCAL:2 = RELATION:R - 50
		SIF LOCAL:2 <= 0
		LOCAL:2 = 10
	ENDIF
ELSE
	LOCAL:2 = RELATION:R
ENDIF
IF LOCAL:2 != 0
	UP:欲情 *= LOCAL:2
	UP:欲情 /= 100
	UP:屈服 *= LOCAL:2
	UP:屈服 /= 100
	UP:恥情 *= LOCAL:2
	UP:恥情 /= 100
	UP:反感 *= 100
	UP:反感 /= LOCAL:2
	UP:不快 *= 100
	UP:不快 /= LOCAL:2
	UP:抑鬱 *= 100
	UP:抑鬱 /= LOCAL:2
ENDIF

;-------------------------------------------------
;同じコマンドの連続実行による上下の処理
;-------------------------------------------------
IF SELECTCOM == PREVCOM
	;UP:快Ｃ,UP:快Ｖ ,UP:快Ａ,UP:快Ｂは絶頂に絡むので先に処理してある
	UP:恭順 /= 2
	UP:欲情 /= 2
	UP:屈服 /= 2
	UP:習得 /= 2
	UP:恥情 /= 2
	UP:苦痛 /= 2
	UP:恐怖 /= 2
ENDIF

;-------------------------------------------------
;気力０による上下の処理
;-------------------------------------------------
IF BASE:気力 <= 0
	;PRINTL ★気力０★
	;UP:快Ｃ,UP:快Ｖ ,UP:快Ａ,UP:快Ｂは絶頂に絡むので先に処理してある
	UP:恭順 /= 2
	UP:欲情 /= 2
	UP:屈服 /= 2
	UP:恥情 /= 2
	UP:恐怖 /= 2
	UP:抑鬱 /= 2

	LOSEBASE:体力 *= 2
	LOSEBASE:体力 += 80
ENDIF

;-------------------------------------------------
;苦痛からくる体力・気力の減少
;-------------------------------------------------
D = UP:苦痛/20
;ABL:マゾっ気をみる
IF ABL:マゾっ気 == 0
	TIMES D , 1.00
ELSEIF ABL:マゾっ気 == 1
	TIMES D , 0.95
ELSEIF ABL:マゾっ気 == 2
	TIMES D , 0.90
ELSEIF ABL:マゾっ気 == 3
	TIMES D , 0.80
ELSEIF ABL:マゾっ気 == 4
	TIMES D , 0.65
ELSE
	TIMES D , 0.50
ENDIF
;痛みに弱い
SIF TALENT:痛みに弱い
	TIMES D , 1.20
;痛みに強い
SIF TALENT:痛みに強い
	TIMES D , 0.80

LOSEBASE:体力 += D
LOSEBASE:気力 += D

;-------------------------------------------------
;体力・気力の減少
;-------------------------------------------------
;調教者が[威圧]持ちだと気疲れする(上位陥落・崩壊・感情乏しいだと無効)
IF TALENT:PLAYER:威圧 && !TALENT:親愛 && !TALENT:娼婦 && !TALENT:隷属 && !TALENT:崩壊 && !TALENT:感情乏しい
	TIMES LOSEBASE:体力 , 1.10
	TIMES LOSEBASE:気力 , 1.10
ENDIF
IF ZUIKI(TARGET)
	TIMES LOSEBASE:体力 , 1.20
	TIMES LOSEBASE:気力 , 1.20
ENDIF
BASE:体力 -= LOSEBASE:体力
IF BASE:体力 < 0
	BASE:体力 = 0
ELSEIF BASE:体力 > MAXBASE:体力
	BASE:体力 = MAXBASE:体力
ENDIF
BASE:気力 -= LOSEBASE:気力
IF BASE:気力 < 0
	BASE:気力 = 0
ELSEIF BASE:気力 > MAXBASE:気力
	BASE:気力 = MAXBASE:気力
ENDIF
;-------------------------------------------------
;苦痛快楽経験、奉仕快楽経験のチェック
;-------------------------------------------------
CALL EXP_GOT_CHECK

;-------------------------------------------------
;セックス時の挿入継続フラグ
;TFLAG:31 = 今回の調教で処女喪失
;-------------------------------------------------
TFLAG:60 = 0
SIF (SEXPLAY(TARGET) == 1 || SEXPLAY(TARGET) == 2) && !TFLAG:31 && CFLAG:TARGET:106 == 0
	TFLAG:60 = 1

;-------------------------------------------------
;調教者の射精時の口上
;-------------------------------------------------
CALL KOJO_MESSAGE_PALAMCNG_A
;-------------------------------------------------
;射精フラグはここで初期化
;-------------------------------------------------
CFLAG:TARGET:106 = 0
;-------------------------------------------------
;触手の射精時の口上
;-------------------------------------------------
CALL KOJO_MESSAGE_PALAMCNG_E
;-------------------------------------------------
;奴隷の絶頂時の口上
;-------------------------------------------------
CALL KOJO_MESSAGE_PALAMCNG_B
;-------------------------------------------------
;絶頂時の放尿処理
;-------------------------------------------------
CALL ORGASM_ADD_URINE


;=======================================================
;着てない服に汚れが付いてしまうことがあるので暫定処置的な？
;=======================================================
CALL CLOTHES_STAIN_3

;-------------------------------------------------
;調教後の口上
;-------------------------------------------------
CALL KOJO_MESSAGE_PALAMCNG_C
;-------------------------------------------------
;パラメータ変動による口上
;-------------------------------------------------
CALL KOJO_MESSAGE_PALAMCNG_D

;-------------------------------------------------
;媚薬の効果が切れたとき
;-------------------------------------------------
;効果が切れる
IF TFLAG:69 >= 10
	TEQUIP:媚薬 = 0
	TFLAG:13 = 73
	CALL KOJO_MESSAGE_EVENT
	TFLAG:69 = 0
ENDIF

;-------------------------------------------------
;お漏らし口上もここに入れてみる
;-------------------------------------------------
IF TFLAG:58 || TFLAG:68
	TFLAG:13 = 71
	CALL KOJO_MESSAGE_EVENT
ENDIF

;-------------------------------------------------
;嘔吐口上
;-------------------------------------------------
IF TFLAG:75
	TFLAG:13 = 78
	CALL KOJO_MESSAGE_EVENT
ENDIF

;-------------------------------------------
;輪姦後
;-------------------------------------------
IF SELECTCOM == 322
	TFLAG:13 = 77
	CALL KOJO_MESSAGE_EVENT
ENDIF

;-------------------------------------------------
;刻印取得のチェック
;-------------------------------------------------
CALL MARK_GOT_CHECK
;-------------------------------------------------
;刻印取得による口上
;-------------------------------------------------
CALL KOJO_MESSAGE_MARKCNG

;-------------------------------------------------
;コマンド実行後の口上
;-------------------------------------------------
CALL KOJO_MESSAGE_COMEND

;-------------------------------------------------
;従順上昇による[抵抗]の消滅チェック
;-------------------------------------------------
CALL JUJUN_UP_CHECK

;-------------------------------------------------
;調教ソースの表示
;-------------------------------------------------
CALL SHOW_SOURCE

;-------------------------------------------------
;数値変動の表示
;-------------------------------------------------
;相性
R = NO:PLAYER
SIF RELATION:R == 0
	LOCAL:2 = 100
;女好き、男好き、子供好き
IF (TALENT:女好き && MALE(PLAYER) == 0 && TALENT:PLAYER:小人体型 == 0) || (TALENT:男好き && MALE(PLAYER) && TALENT:PLAYER:小人体型 == 0) || (TALENT:子供好き && TALENT:PLAYER:小人体型)
	IF RELATION:R == 0
		LOCAL:2 = 150
	ELSE
		LOCAL:2 = RELATION:R + 50
		SIF LOCAL:2 > 200
			LOCAL:2 = 200
	ENDIF
;男嫌い、女嫌い(恋慕陥落で無効)
ELSEIF (TALENT:男嫌い && MALE(PLAYER) && (TALENT:恋慕 == 0 && TALENT:親愛 == 0)) || (TALENT:女嫌い && MALE(PLAYER) == 0 && (TALENT:恋慕 == 0 && TALENT:親愛 == 0))
	IF RELATION:R == 0
		LOCAL:2 = 50
	ELSE
		LOCAL:2 = RELATION:R - 50
		SIF LOCAL:2 <= 0
		LOCAL:2 = 10
	ENDIF
ELSE
	LOCAL:2 = RELATION:R
ENDIF
SIF LOCAL:2 != 0
	PRINTFORML ＜相性{C/100}.{C%100}倍＞

;同じコマンドの連続実行
SIF SELECTCOM == PREVCOM
	PRINTL ＜同一コマンド連続実行＞

;今回のコマンドを「前回のコマンド」とする
PREVCOM = SELECTCOM

;前回の調教者が助手か主人か
IF ASSIPLAY
	TFLAG:50 = 1
ELSE
	TFLAG:50 = 0
ENDIF

;気力０
SIF BASE:気力 <= 0
	PRINTL ★気力０★

;体力・気力の減少
PRINT 体力-
PRINTV LOSEBASE:体力
PRINT  気力-
PRINTVL LOSEBASE:気力

;-------------------------------------------------
;射精後の再装填処理
;-------------------------------------------------
REPEAT CHARANUM
	SIF CFLAG:COUNT:9 > 0
		CFLAG:COUNT:9 -= 1
REND

;-------------------------------------------------
;パラメータの上昇＆表示（DOWNもここで）
;-------------------------------------------------
IF FLAG:153 == 0
	UPCHECK
ELSE
	CALL UPCHECK_ANIME
ENDIF

;-------------------------------------------------
;調教者の珠ゲット
;-------------------------------------------------
CALL PLAYER_JUEL_GET


