;====================================================================
;労役指示
;-----------------------------------------
;調子に乗って条件をごっそり変えました。
;今までは恋愛系＝コンサートと屋台とか、服従系＝レンタルと便所とか素質によって
;実行できる労役が決まっていたものが、奴隷の能力によって実行できる労役が決まるようになります。
;ただし、全ての労役において、どの方向にでも陥落している必要はあります。
;
;-----------------------------------------
;====================================================================
;-------------------------------------------------
@CHARA_WORKING
;-------------------------------------------------

D = 1
CALL DAILY_LIFE_MASTER_CHANGE
A = 0
B = 0
D = 0
E = 0
F = 0
G = 0
REPEAT CHARANUM
	;主人は除外
	SIF COUNT == MASTER
		CONTINUE
	;助手可能になってないキャラは除外
	SIF CFLAG:COUNT:1 != 2
		CONTINUE
	;すでに労役中のキャラは除外
	SIF CFLAG:COUNT:12 > 0
		CONTINUE
	;気絶しているキャラは除外
	SIF TALENT:COUNT:気絶
		CONTINUE
	;陥落してないキャラは除外
	SIF !KANRAKU2(COUNT)
		CONTINUE
	;育児部屋に移動しているキャラは除外
	C = COUNT
	CALL CHECK_CHILD_CARE
	SIF RESULT == 1
		CONTINUE
	;定食屋台とライブは、四肢欠損がある　もしくは発情期で不可
	IF !TALENT:COUNT:片腕欠損 && !TALENT:COUNT:両腕欠損 && !TALENT:COUNT:達磨 && !TALENT:COUNT:片脚欠損 && !TALENT:COUNT:両足欠損 && !TALENT:COUNT:全抜歯 && !TALENT:COUNT:発情期
		;屋台実行可能＝奉仕精神３以上＋料理技能２以上
		SIF ABL:COUNT:奉仕精神 >= 3 && ABL:COUNT:料理技能 >= 2
			CFLAG:COUNT:151 |= 1
		;ライブ実行可能＝奉仕精神３以上＋歌唱技能２以上
		SIF ABL:COUNT:奉仕精神 >= 3 && ABL:COUNT:歌唱技能 >= 2
			CFLAG:COUNT:151 |= 2
	ENDIF
	;娼館、ショーは従順＋欲望＋奉仕精神合わせて10以上必要
	IF ABL:COUNT:従順 + ABL:COUNT:欲望 + ABL:COUNT:奉仕精神 >= 10
		;娼館実行可能＝ＣＶＡＢ感覚合計10以上
		SIF (ABL:COUNT:Ｃ感覚 + ABL:COUNT:Ｖ感覚 + ABL:COUNT:Ａ感覚 + ABL:COUNT:Ｂ感覚) >= 10
			CFLAG:COUNT:151 |= 4
		;ショー実行可能＝露出癖３以上
		SIF ABL:COUNT:露出癖 >= 3
			CFLAG:COUNT:151 |= 8
	ENDIF
	;レンタル、公衆便所は従順＋欲望＋奉仕精神合わせて15以上必要
	IF ABL:COUNT:従順 + ABL:COUNT:欲望 + ABL:COUNT:奉仕精神 >= 15
		CFLAG:COUNT:151 |= 16
		CFLAG:COUNT:151 |= 32
	ENDIF
	
	SIF CFLAG:COUNT:151 & 1
		A += 1
	SIF CFLAG:COUNT:151 & 2
		E += 1
	SIF CFLAG:COUNT:151 & 4
		B += 1
	SIF CFLAG:COUNT:151 & 8
		F += 1
	SIF CFLAG:COUNT:151 & 16
		D += 1
	SIF CFLAG:COUNT:151 & 32
		G += 1
REND

;調教者変更に対応
SIF MASTER == 0 || CFLAG:MASTER:1 == 3
	PRINTL [ 0]  - 売却
IF A && ITEM:92
	IF TIME == 0
		PRINTL [ 1]  - 定食屋台（昼の部）
	ELSE
		PRINTL [ 1]  - 定食屋台（夜の部）
	ENDIF
ENDIF
IF E
	IF TIME == 0
		PRINTL [ 2]  - 刀剣雷舞（昼の部）
	ELSE
		PRINTL [ 2]  - 刀剣雷舞（夜の部）
	ENDIF
ENDIF
SIF B
	PRINTL [ 3]  - 娼館奉公
SIF F
	PRINTL [ 4]  - 見世物小屋
SIF D && TIME == 0
	PRINTL [ 5]  - 奴隷のレンタル
SIF G && ITEM:94
	PRINTL [ 6]  - 公衆便所プレイ

PRINTL [100]- 戻る
$INPUT_LOOP
INPUT
IF RESULT == 100
	RETURN 0
ELSEIF RESULT == 0
	CALL CHARA_SELL
ELSEIF RESULT == 1 && A && ITEM:92
	CALL LUNCH_STALL
ELSEIF RESULT == 2 && E
	CALL CONCERT
ELSEIF RESULT == 3 && B
	CALL PROSTITUTION
ELSEIF RESULT == 4 && F
	CALL PROMISCUOUS_SEX_LIVE
ELSEIF RESULT == 5 && D && TIME == 0
	CALL RENTAL_SLAVE
ELSEIF RESULT == 6 && G && ITEM:94
	CALL PUBLIC_TOILET
ELSE
	GOTO INPUT_LOOP
ENDIF
D = 0
CALL DAILY_LIFE_MASTER_CHANGE

RETURN 0


;-------------------------------------------------
;奴隷売却の処理
;-------------------------------------------------
@CHARA_SELL
DRAWLINE
PRINTL 誰を売りますか？
PRINTL 
REPEAT CHARANUM
	TFLAG:COUNT = 0
	SIF COUNT == MASTER
		CONTINUE
	SIF CFLAG:COUNT:1 == 3
		CONTINUE
	SIF CFLAG:COUNT:12 > 0
		CONTINUE
	;育児部屋に移動しているキャラは除外
	C = COUNT
	CALL CHECK_CHILD_CARE
	SIF RESULT == 1
		CONTINUE
	;烙印付きは売れない
	SIF TALENT:COUNT:烙印
		CONTINUE
	IF CFLAG:COUNT:1 >= 1 && CFLAG:COUNT:1 <= 3 && CFLAG:COUNT:7 == 0
		PRINTFORM [{COUNT}] %NAME:COUNT% 
		IF ASSI == COUNT
			PRINT (助手)
		ELSEIF ISASSI:COUNT == 1
			PRINT (元助手)
		ELSEIF CFLAG:COUNT:1 == 2
			PRINT (助手可)
		ENDIF
		PRINTL 
	ENDIF
REND
PRINTFORML [999] 戻る

$INPUT_LOOP
INPUT

IF RESULT == 999
	RETURN 0
ELSEIF RESULT < 0 || RESULT >= CHARANUM
	GOTO INPUT_LOOP
ELSEIF CFLAG:RESULT:1 < 1 || CFLAG:RESULT:1 == 3 || CFLAG:RESULT:7 > 0 || CFLAG:RESULT:12 > 0 || RESULT == MASTER
	GOTO INPUT_LOOP
ELSE
	C = RESULT
	CALL CHECK_CHILD_CARE
	SIF RESULT == 1
		GOTO INPUT_LOOP
	;売却処理
	T = TARGET
	A = ASSI
	TARGET = C
ENDIF

S = 0

;ABLによる基礎値計算
V = 0
;ABL:従順をみる
IF ABL:従順 == 0
	V = 0
ELSEIF ABL:従順 == 1
	V = 1200
ELSEIF ABL:従順 == 2
	V = 1800
ELSEIF ABL:従順 == 3
	V = 2500
ELSEIF ABL:従順 == 4
	V = 3300
ELSEIF ABL:従順 == 5
	V = 4200
ELSEIF ABL:従順 == 6
	V = 6200
ELSEIF ABL:従順 == 7
	V = 9000
ELSEIF ABL:従順 == 8
	V = 13000
ELSEIF ABL:従順 == 9
	V = 18000
ELSE
	V = 25000
ENDIF
SIF V > 0
	PRINTFORML %ABLNAME:0%{ABL:従順}LV +{V}
S += V


;ABL:欲望をみる
IF ABL:欲望 == 0
	V = 0
ELSEIF ABL:欲望 == 1
	V = 1000
ELSEIF ABL:欲望 == 2
	V = 1500
ELSEIF ABL:欲望 == 3
	V = 2100
ELSEIF ABL:欲望 == 4
	V = 2800
ELSEIF ABL:欲望 == 5
	V = 3600
ELSEIF ABL:欲望 == 6
	V = 5500
ELSEIF ABL:欲望 == 7
	V = 8000
ELSEIF ABL:欲望 == 8
	V = 12000
ELSEIF ABL:欲望 == 9
	V = 16000
ELSE
	V = 22000
ENDIF
SIF V > 0
	PRINTFORML %ABLNAME:1%{ABL:欲望}LV +{V}
S += V


;ABL:技巧をみる
IF ABL:技巧 == 0
	V = 0
ELSEIF ABL:技巧 == 1
	V = 800
ELSEIF ABL:技巧 == 2
	V = 1200
ELSEIF ABL:技巧 == 3
	V = 1700
ELSEIF ABL:技巧 == 4
	V = 2300
ELSEIF ABL:技巧 == 5
	V = 3000
ELSEIF ABL:技巧 == 6
	V = 4800
ELSEIF ABL:技巧 == 7
	V = 7000
ELSEIF ABL:技巧 == 8
	V = 11000
ELSEIF ABL:技巧 == 9
	V = 15000
ELSE
	V = 21000
ENDIF
SIF V > 0
	PRINTFORML %ABLNAME:2%{ABL:技巧}LV +{V}
S += V


;ABL:Ｃ感覚をみる
IF ABL:Ｃ感覚 == 0
	V = 0
ELSEIF ABL:Ｃ感覚 == 1
	V = 800
ELSEIF ABL:Ｃ感覚 == 2
	V = 1200
ELSEIF ABL:Ｃ感覚 == 3
	V = 1700
ELSEIF ABL:Ｃ感覚 == 4
	V = 2300
ELSEIF ABL:Ｃ感覚 == 5
	V = 3000
ELSEIF ABL:Ｃ感覚 == 6
	V = 4800
ELSEIF ABL:Ｃ感覚 == 7
	V = 7000
ELSEIF ABL:Ｃ感覚 == 8
	V = 11000
ELSEIF ABL:Ｃ感覚 == 9
	V = 15000
ELSE
	V = 21000
ENDIF
SIF V > 0
	PRINTFORML %ABLNAME:3%{ABL:Ｃ感覚}LV +{V}
S += V


;ABL:Ｖ感覚をみる
IF ABL:Ｖ感覚 == 0
	V = 0
ELSEIF ABL:Ｖ感覚 == 1
	V = 800
ELSEIF ABL:Ｖ感覚 == 2
	V = 1200
ELSEIF ABL:Ｖ感覚 == 3
	V = 1700
ELSEIF ABL:Ｖ感覚 == 4
	V = 2300
ELSEIF ABL:Ｖ感覚 == 5
	V = 3000
ELSEIF ABL:Ｖ感覚 == 6
	V = 4800
ELSEIF ABL:Ｖ感覚 == 7
	V = 7000
ELSEIF ABL:Ｖ感覚 == 8
	V = 11000
ELSEIF ABL:Ｖ感覚 == 9
	V = 15000
ELSE
	V = 21000
ENDIF
SIF V > 0
	PRINTFORML %ABLNAME:4%{ABL:Ｖ感覚}LV +{V}
S += V


;ABL:Ａ感覚をみる
IF ABL:Ａ感覚 == 0
	V = 0
ELSEIF ABL:Ａ感覚 == 1
	V = 800
ELSEIF ABL:Ａ感覚 == 2
	V = 1200
ELSEIF ABL:Ａ感覚 == 3
	V = 1700
ELSEIF ABL:Ａ感覚 == 4
	V = 2300
ELSEIF ABL:Ａ感覚 == 5
	V = 3000
ELSEIF ABL:Ａ感覚 == 6
	V = 4800
ELSEIF ABL:Ａ感覚 == 7
	V = 7000
ELSEIF ABL:Ａ感覚 == 8
	V = 11000
ELSEIF ABL:Ａ感覚 == 9
	V = 15000
ELSE
	V = 21000
ENDIF
SIF V > 0
	PRINTFORML %ABLNAME:5%{ABL:Ａ感覚}LV +{V}
S += V


;ABL:Ｂ感覚をみる
IF ABL:Ｂ感覚 == 0
	V = 0
ELSEIF ABL:Ｂ感覚 == 1
	V = 800
ELSEIF ABL:Ｂ感覚 == 2
	V = 1200
ELSEIF ABL:Ｂ感覚 == 3
	V = 1700
ELSEIF ABL:Ｂ感覚 == 4
	V = 2300
ELSEIF ABL:Ｂ感覚 == 5
	V = 3000
ELSEIF ABL:Ｂ感覚 == 6
	V = 4800
ELSEIF ABL:Ｂ感覚 == 7
	V = 7000
ELSEIF ABL:Ｂ感覚 == 8
	V = 11000
ELSEIF ABL:Ｂ感覚 == 9
	V = 15000
ELSE
	V = 21000
ENDIF
SIF V > 0
	PRINTFORML %ABLNAME:6%{ABL:Ｂ感覚}LV +{V}
S += V


;ABL:奉仕精神をみる
IF ABL:奉仕精神 == 0
	V = 0
ELSEIF ABL:奉仕精神 == 1
	V = 1200
ELSEIF ABL:奉仕精神 == 2
	V = 1800
ELSEIF ABL:奉仕精神 == 3
	V = 2500
ELSEIF ABL:奉仕精神 == 4
	V = 3300
ELSEIF ABL:奉仕精神 == 5
	V = 4200
ELSEIF ABL:奉仕精神 == 6
	V = 6200
ELSEIF ABL:奉仕精神 == 7
	V = 9000
ELSEIF ABL:奉仕精神 == 8
	V = 13000
ELSEIF ABL:奉仕精神 == 9
	V = 18000
ELSE
	V = 25000
ENDIF
SIF V > 0
	PRINTFORML %ABLNAME:7%{ABL:奉仕精神}LV +{V}
S += V


;ABL:露出癖をみる
IF ABL:露出癖 == 0
	V = 0
ELSEIF ABL:露出癖 == 1
	V = 800
ELSEIF ABL:露出癖 == 2
	V = 1200
ELSEIF ABL:露出癖 == 3
	V = 1700
ELSEIF ABL:露出癖 == 4
	V = 2300
ELSEIF ABL:露出癖 == 5
	V = 3000
ELSEIF ABL:露出癖 == 6
	V = 4800
ELSEIF ABL:露出癖 == 7
	V = 7000
ELSEIF ABL:露出癖 == 8
	V = 11000
ELSEIF ABL:露出癖 == 9
	V = 15000
ELSE
	V = 21000
ENDIF
SIF V > 0
	PRINTFORML %ABLNAME:8%{ABL:露出癖}LV +{V}
S += V


;ABL:マゾっ気をみる
IF ABL:マゾっ気 == 0
	V = 0
ELSEIF ABL:マゾっ気 == 1
	V = 1000
ELSEIF ABL:マゾっ気 == 2
	V = 1500
ELSEIF ABL:マゾっ気 == 3
	V = 2100
ELSEIF ABL:マゾっ気 == 4
	V = 2800
ELSEIF ABL:マゾっ気 == 5
	V = 3600
ELSEIF ABL:マゾっ気 == 6
	V = 5500
ELSEIF ABL:マゾっ気 == 7
	V = 8000
ELSEIF ABL:マゾっ気 == 8
	V = 12000
ELSEIF ABL:マゾっ気 == 9
	V = 16000
ELSE
	V = 22000
ENDIF
SIF V > 0
	PRINTFORML %ABLNAME:9%{ABL:マゾっ気}LV +{V}
S += V


;ABL:サドっ気をみる
IF ABL:サドっ気 == 0
	V = 0
ELSEIF ABL:サドっ気 == 1
	V = 800
ELSEIF ABL:サドっ気 == 2
	V = 1200
ELSEIF ABL:サドっ気 == 3
	V = 1700
ELSEIF ABL:サドっ気 == 4
	V = 2300
ELSEIF ABL:サドっ気 == 5
	V = 3000
ELSEIF ABL:サドっ気 == 6
	V = 4800
ELSEIF ABL:サドっ気 == 7
	V = 7000
ELSEIF ABL:サドっ気 == 8
	V = 11000
ELSEIF ABL:サドっ気 == 9
	V = 15000
ELSE
	V = 21000
ENDIF
SIF V > 0
	PRINTFORML %ABLNAME:10%{ABL:サドっ気}LV +{V}
S += V


;ABL:レズっ気をみる
IF ABL:レズっ気 == 0
	V = 0
ELSEIF ABL:レズっ気 == 1
	V = 1000
ELSEIF ABL:レズっ気 == 2
	V = 1500
ELSEIF ABL:レズっ気 == 3
	V = 2100
ELSEIF ABL:レズっ気 == 4
	V = 2800
ELSEIF ABL:レズっ気 == 5
	V = 3600
ELSEIF ABL:レズっ気 == 6
	V = 5500
ELSEIF ABL:レズっ気 == 7
	V = 8000
ELSEIF ABL:レズっ気 == 8
	V = 12000
ELSEIF ABL:レズっ気 == 9
	V = 16000
ELSE
	V = 22000
ENDIF
SIF V > 0
	PRINTFORML %ABLNAME:11%{ABL:レズっ気}LV +{V}
S += V


;ABL:料理技能をみる
IF ABL:料理技能 == 0
	V = 0
ELSEIF ABL:料理技能 == 1
	V = 600
ELSEIF ABL:料理技能 == 2
	V = 1000
ELSEIF ABL:料理技能 == 3
	V = 1500
ELSEIF ABL:料理技能 == 4
	V = 2100
ELSEIF ABL:料理技能 == 5
	V = 2800
ELSEIF ABL:料理技能 == 6
	V = 4800
ELSEIF ABL:料理技能 == 7
	V = 7000
ELSEIF ABL:料理技能 == 8
	V = 11000
ELSEIF ABL:料理技能 == 9
	V = 15000
ELSE
	V = 21000
ENDIF
SIF V > 0
	PRINTFORML %ABLNAME:12%{ABL:料理技能}LV +{V}
S += V


;ABL:撮影技能をみる
IF ABL:撮影技能 == 0
	V = 0
ELSEIF ABL:撮影技能 == 1
	V = 600
ELSEIF ABL:撮影技能 == 2
	V = 1000
ELSEIF ABL:撮影技能 == 3
	V = 1500
ELSEIF ABL:撮影技能 == 4
	V = 2100
ELSEIF ABL:撮影技能 == 5
	V = 2800
ELSEIF ABL:撮影技能 == 6
	V = 4800
ELSEIF ABL:撮影技能 == 7
	V = 7000
ELSEIF ABL:撮影技能 == 8
	V = 11000
ELSEIF ABL:撮影技能 == 9
	V = 15000
ELSE
	V = 21000
ENDIF
SIF V > 0
	PRINTFORML %ABLNAME:13%{ABL:撮影技能}LV +{V}
S += V


;ABL:歌唱技能をみる
IF ABL:歌唱技能 == 0
	V = 0
ELSEIF ABL:歌唱技能 == 1
	V = 600
ELSEIF ABL:歌唱技能 == 2
	V = 1000
ELSEIF ABL:歌唱技能 == 3
	V = 1500
ELSEIF ABL:歌唱技能 == 4
	V = 2100
ELSEIF ABL:歌唱技能 == 5
	V = 2800
ELSEIF ABL:歌唱技能 == 6
	V = 4800
ELSEIF ABL:歌唱技能 == 7
	V = 7000
ELSEIF ABL:歌唱技能 == 8
	V = 11000
ELSEIF ABL:歌唱技能 == 9
	V = 15000
ELSE
	V = 21000
ENDIF
SIF V > 0
	PRINTFORML %ABLNAME:14%{ABL:歌唱技能}LV +{V}
S += V


;ABL:自慰中毒をみる
IF ABL:自慰中毒 == 0
	V = 0
ELSEIF ABL:自慰中毒 == 1
	V = 1500
ELSEIF ABL:自慰中毒 == 2
	V = 2200
ELSEIF ABL:自慰中毒 == 3
	V = 3000
ELSEIF ABL:自慰中毒 == 4
	V = 3900
ELSEIF ABL:自慰中毒 == 5
	V = 4900
ELSEIF ABL:自慰中毒 == 6
	V = 8000
ELSEIF ABL:自慰中毒 == 7
	V = 11000
ELSEIF ABL:自慰中毒 == 8
	V = 15000
ELSEIF ABL:自慰中毒 == 9
	V = 20000
ELSE
	V = 30000
ENDIF
SIF V > 0
	PRINTFORML %ABLNAME:15%{ABL:自慰中毒}LV +{V}
S += V


;ABL:精液中毒をみる
IF ABL:精液中毒 == 0
	V = 0
ELSEIF ABL:精液中毒 == 1
	V = 1500
ELSEIF ABL:精液中毒 == 2
	V = 2200
ELSEIF ABL:精液中毒 == 3
	V = 3000
ELSEIF ABL:精液中毒 == 4
	V = 3900
ELSEIF ABL:精液中毒 == 5
	V = 4900
ELSEIF ABL:精液中毒 == 6
	V = 8000
ELSEIF ABL:精液中毒 == 7
	V = 11000
ELSEIF ABL:精液中毒 == 8
	V = 15000
ELSEIF ABL:精液中毒 == 9
	V = 20000
ELSE
	V = 30000
ENDIF
SIF V > 0
	PRINTFORML %ABLNAME:16%{ABL:精液中毒}LV +{V}
S += V


;ABL:レズ中毒をみる
IF ABL:レズ中毒 == 0
	V = 0
ELSEIF ABL:レズ中毒 == 1
	V = 1500
ELSEIF ABL:レズ中毒 == 2
	V = 2200
ELSEIF ABL:レズ中毒 == 3
	V = 3000
ELSEIF ABL:レズ中毒 == 4
	V = 3900
ELSEIF ABL:レズ中毒 == 5
	V = 4900
ELSEIF ABL:レズ中毒 == 6
	V = 8000
ELSEIF ABL:レズ中毒 == 7
	V = 11000
ELSEIF ABL:レズ中毒 == 8
	V = 15000
ELSEIF ABL:レズ中毒 == 9
	V = 20000
ELSE
	V = 30000
ENDIF
SIF V > 0
	PRINTFORML %ABLNAME:17%{ABL:レズ中毒}LV +{V}
S += V


;ABL:セックス中毒をみる
IF ABL:セックス中毒 == 0
	V = 0
ELSEIF ABL:セックス中毒 == 1
	V = 1500
ELSEIF ABL:セックス中毒 == 2
	V = 2200
ELSEIF ABL:セックス中毒 == 3
	V = 3000
ELSEIF ABL:セックス中毒 == 4
	V = 3900
ELSEIF ABL:セックス中毒 == 5
	V = 4900
ELSEIF ABL:セックス中毒 == 6
	V = 8000
ELSEIF ABL:セックス中毒 == 7
	V = 11000
ELSEIF ABL:セックス中毒 == 8
	V = 15000
ELSEIF ABL:セックス中毒 == 9
	V = 20000
ELSE
	V = 30000
ENDIF
SIF V > 0
	PRINTFORML %ABLNAME:18%{ABL:セックス中毒}LV +{V}
S += V


;ABL:噴乳中毒をみる
IF ABL:噴乳中毒 == 0
	V = 0
ELSEIF ABL:噴乳中毒 == 1
	V = 1500
ELSEIF ABL:噴乳中毒 == 2
	V = 2200
ELSEIF ABL:噴乳中毒 == 3
	V = 3000
ELSEIF ABL:噴乳中毒 == 4
	V = 3900
ELSEIF ABL:噴乳中毒 == 5
	V = 4900
ELSEIF ABL:噴乳中毒 == 6
	V = 8000
ELSEIF ABL:噴乳中毒 == 7
	V = 11000
ELSEIF ABL:噴乳中毒 == 8
	V = 15000
ELSEIF ABL:噴乳中毒 == 9
	V = 20000
ELSE
	V = 30000
ENDIF
SIF V > 0
	PRINTFORML %ABLNAME:19%{ABL:噴乳中毒}LV +{V}
S += V


;ABL:ホモっ気をみる
IF ABL:ホモっ気 == 0
	V = 0
ELSEIF ABL:ホモっ気 == 1
	V = 1000
ELSEIF ABL:ホモっ気 == 2
	V = 1500
ELSEIF ABL:ホモっ気 == 3
	V = 2100
ELSEIF ABL:ホモっ気 == 4
	V = 2800
ELSEIF ABL:ホモっ気 == 5
	V = 3600
ELSEIF ABL:ホモっ気 == 6
	V = 5500
ELSEIF ABL:ホモっ気 == 7
	V = 8000
ELSEIF ABL:ホモっ気 == 8
	V = 12000
ELSEIF ABL:ホモっ気 == 9
	V = 16000
ELSE
	V = 22000
ENDIF
SIF V > 0
	PRINTFORML %ABLNAME:20%{ABL:ホモっ気}LV +{V}
S += V


;ABL:ゲイ中毒をみる
IF ABL:ゲイ中毒 == 0
	V = 0
ELSEIF ABL:ゲイ中毒 == 1
	V = 1500
ELSEIF ABL:ゲイ中毒 == 2
	V = 2200
ELSEIF ABL:ゲイ中毒 == 3
	V = 3000
ELSEIF ABL:ゲイ中毒 == 4
	V = 3900
ELSEIF ABL:ゲイ中毒 == 5
	V = 4900
ELSEIF ABL:ゲイ中毒 == 6
	V = 8000
ELSEIF ABL:ゲイ中毒 == 7
	V = 11000
ELSEIF ABL:ゲイ中毒 == 8
	V = 15000
ELSEIF ABL:ゲイ中毒 == 9
	V = 20000
ELSE
	V = 30000
ENDIF
SIF V > 0
	PRINTFORML %ABLNAME:21%{ABL:ゲイ中毒}LV +{V}
S += V


;ABL:スカ中毒をみる
IF ABL:スカ中毒 == 0
	V = 0
ELSEIF ABL:スカ中毒 == 1
	V = 1500
ELSEIF ABL:スカ中毒 == 2
	V = 2200
ELSEIF ABL:スカ中毒 == 3
	V = 3000
ELSEIF ABL:スカ中毒 == 4
	V = 3900
ELSEIF ABL:スカ中毒 == 5
	V = 4900
ELSEIF ABL:スカ中毒 == 6
	V = 8000
ELSEIF ABL:スカ中毒 == 7
	V = 11000
ELSEIF ABL:スカ中毒 == 8
	V = 15000
ELSEIF ABL:スカ中毒 == 9
	V = 20000
ELSE
	V = 30000
ENDIF
SIF V > 0
	PRINTFORML %ABLNAME:22%{ABL:スカ中毒}LV +{V}
S += V


;素質による売却額補正値計算
V = 100
FOR LOCAL, 0, 210
	IF TALENT:LOCAL
		C = 0
		LOCAL:1 = 0
		SELECTCASE LOCAL
			;処女、隷属
			CASE 0,8
				C = 100
				V += 100
			;娼婦
			CASE 7
				C = 60
				V += 60
			;服従、魅力、謎の魅力
			CASE 5,92,94
				C = 50
				V += 50
			;気丈、マゾ
			CASE 12,84
				C = 40
				V += 40
			;淫乱、一線越えない、献身的、快感の否定、淫壺、淫乳、セックス狂、サド
			;妄信、Ｃ敏感、Ｖ敏感、Ａ敏感、Ｂ敏感、爆乳、不死身、絶倫
			CASE 4,27,47,63,71,75,77,78,83,86,102,104,106,108,112,147
				SIF LOCAL == 102 && ABL:Ｃ感覚 < 3 || LOCAL == 104 && ABL:Ｖ感覚 < 3 || LOCAL == 106 && ABL:Ａ感覚 < 3 || LOCAL == 108 && ABL:Ｂ感覚 < 3
					CONTINUE
				C = 30
				V += 30
			;再生処女、反抗的、プライド高い、生意気、ツンデレ、自制心、貞操観念、痛みに強い
			;汚臭敏感、自慰狂い、尻穴狂い、小悪魔、妖狐、人気、巨乳、陥没乳首、回復早い、母乳体質
			CASE 1,11,15,16,18,20,30,41,62,74,76,87,91,111,120,130,145,149
				C = 20
				V += 20
				
				;貞操観念かつ尻穴狂いならボーナス
				IF LOCAL == 30 && TALENT:尻穴狂い == 0
					LOCAL:1 = 76
					C = 30
					V += 10
					;処女なら更にボーナス
					IF TALENT:処女
						C = 40
						V += 10
						PRINTFORML %TALENTNAME:LOCAL%と%TALENTNAME:(LOCAL:1)%と%TALENTNAME:0% ＋ {C}％
						CONTINUE
					ENDIF
				ENDIF
			;好奇心、保守的、目立ちたがり、舌使い、解放、恥じらい、濡れやすい、習得早い、おもらし癖
			;自慰しやすい、即落ち、倒錯的、指さばき、小人体型、馬並み、極、達磨
			CASE 23,24,28,33,35,42,50,52,57,58,60,73,80,117,142,180,204
				C = 10
				V += 10
				
				;小人体型かつ(巨根or馬並みor巨乳or爆乳)ならボーナス
				IF LOCAL == 142 && (TALENT:巨根 || TALENT:馬並み || TALENT:巨乳 || TALENT:爆乳)
					IF TALENT:巨根
						LOCAL:1 = 116
					ELSEIF TALENT:馬並み
						LOCAL:1 = 117
					ELSEIF TALENT:巨乳
						LOCAL:1 = 111
					ELSEIF TALENT:爆乳
						LOCAL:1 = 112
					ENDIF
					C = 20
					V += 10
				ENDIF
			;妊娠　※以下の条件を満たさない場合は加算も減算もしません
			CASE 153
				;妊娠かつ(小人体型or小柄体型)ならボーナス
				IF LOCAL == 153 && (TALENT:小人体型 || TALENT:小柄体型)
					IF TALENT:小人体型
						LOCAL:1 = 142
					ELSEIF TALENT:小柄体型
						LOCAL:1 = 100
					ENDIF
					C = 10
					V += 10
				ENDIF
			;半陰半陽、ふたなり、動物耳、カントボーイ、シーメール、神技
			CASE 137,139,143,172,173,181
				SIF LOCAL == 143 && TALENT:動物耳 >= 10
					CONTINUE
				C = 5
				V += 5
		ENDSELECT
		IF LOCAL:1 && C
			PRINTFORML %TALENTNAME:LOCAL%と%TALENTNAME:(LOCAL:1)% ＋ {C}％
		ELSEIF C
			PRINTFORML %TALENTNAME:LOCAL% ＋ {C}％
		ENDIF
		C = 0
		SELECTCASE LOCAL
			;恥薄い、濡れにくい、習得遅い、男嫌い、女嫌い、絶壁、片脚欠損
			CASE 35,43,51,82,88,110,202
				C = 10
				V -= 10
			;臆病、素直、大人しい、プライド低い、メンヘラ、無関心、感情乏しい、貞操無頓着、痛みに弱い
			;薬毒耐性、汚臭鈍感、汚れ無視、貧乳、回復遅い、
			CASE 10,13,14,17,21,22,31,38,40,56,61,64,109,131,
				C = 20
				V -= 20
				
				;貧乳かつ(小人体型or小柄体型)ならボーナス
				IF LOCAL == 109 && (TALENT:小人体型 || TALENT:小柄体型)
					IF TALENT:小人体型
						LOCAL:1 = 142
					ELSEIF TALENT:小柄体型
						LOCAL:1 = 100
					ENDIF
					C = 10
					V += 10
				ENDIF
			;快感に素直、Ｃ鈍感、Ｖ鈍感、Ａ鈍感、Ｂ鈍感、幼児／幼児退行、片腕欠損、両足欠損
			CASE 70,101,103,105,107,150,200,203
				SIF LOCAL == 101 && ABL:Ｃ感覚 >= 4 || LOCAL == 103 && ABL:Ｖ感覚 >= 4 || LOCAL == 105 && ABL:Ａ感覚 >= 4 || LOCAL == 107 && ABL:Ｂ感覚 >= 4
					CONTINUE
				C = 30
				V -= 30
				
				;幼児／幼児退行で小人体型でないならボーナス
				IF LOCAL == 150 && TALENT:小人体型 == 0
					LOCAL:1 = 142
					C = 20
					V += 10
				ENDIF
			;恋慕、両腕欠損
			CASE 3,201
				C = 50
				V -= 50
			;親愛
			CASE 6
				C = 80
				V -= 80
		ENDSELECT
		IF LOCAL:1 && C
			PRINTFORML %TALENTNAME:LOCAL%と%TALENTNAME:(LOCAL:1)% － {C}％
		ELSEIF C
			PRINTFORML %TALENTNAME:LOCAL% － {C}％
		ENDIF
	ENDIF
NEXT

;元助手
IF ISASSI:TARGET == 1
	C = 100
	V -= 100
	PRINTFORML 元助手 －{C}％
ENDIF

;補正値が0以下の場合は1にする
SIF V <= 0
	V = 1

PRINTFORML 最終倍率 {V}％

;補正値の適用
S *= V
S /= 100

;崩壊,狂気,妊娠は売却額をかなり低くする（従順によって、80％まで回復）
IF TALENT:崩壊 || TALENT:狂気 || TALENT:妊娠
PRINTL 
	IF TALENT:崩壊
		S *= ABL:従順
		TIMES S , 0.08
		Z = ABL:従順
		Z *= 8
		PRINTFORML %TALENTNAME:9% ×{Z}％
	ELSEIF TALENT:狂気
		S *= ABL:従順
		TIMES S , 0.08
		Z = ABL:従順
		Z *= 8
		PRINTFORML %TALENTNAME:141% ×{Z}％
	ELSEIF TALENT:妊娠
		S *= ABL:従順
		TIMES S , 0.08
		Z = ABL:従順
		Z *= 8
		PRINTFORML %TALENTNAME:153% ×{Z}％
	ENDIF
PRINTL 
ENDIF


;難易度処理
;EASY
IF FLAG:4 == 1
	PRINTFORML 難易度:EASY ×120％
	TIMES S , 1.20
;NORMAL
ELSEIF FLAG:4 == 2
	TIMES S , 1.00
;HARD
ELSEIF FLAG:4 == 3
	PRINTFORML 難易度:HARD ×80％
	TIMES S , 0.80
ENDIF

;売却確認
PRINTFORML %NAME:TARGET%は{S}朱で売れそうです
PRINTL 売却しますか？
PRINTL [0] はい
PRINTL [1] いいえ
$INPUT_LOOPSALE
INPUT
IF RESULT == 0
	;売却時のイベント口上
	TFLAG:13 = 18
	CALL KOJO_MESSAGE_EVENT
	;売却額
	IF S > 0
		PRINTFORMW 結果、%NAME:TARGET%は{S}朱で売れました
		MONEY += S
	ELSEIF S == 0
		PRINTFORMW 結果、%NAME:TARGET%は業者に引き取られました
	ENDIF
	
	;調教者変更用
	CALL SELLOUT_MASTER_CHANGE

	;売却後エピソード登録処理
	CALL SET_AFTERWARDS

	;売却後エピソード表示
	CALL SHOW_AFTERWARDS
	

	;対象が子供だった場合現在の子供の数フラグ－
	IF NO:TARGET >= 890 && NO:TARGET <= 899
		FLAG:33--
		;手元に番号被りの別の子供がいるかどうかチェック
		LOCAL = 0
		REPEAT CHARANUM
			SIF COUNT != TARGET && NO:COUNT == NO:TARGET
				LOCAL = COUNT
		REND
		;売却する子供に対する相性をリセット
		IF !LOCAL
			REPEAT CHARANUM
				RELATION:COUNT:(NO:TARGET) = 0
			REND
		ENDIF
	ENDIF
	Z = TARGET
	DELCHARA Z
	TARGET = -1
	ASSI = -1
	IF T != -1
		IF T > Z
			TARGET = T-1
		ELSE
			TARGET = T
		ENDIF
	ENDIF
	
	IF A != -1
		IF A > Z
			ASSI = A-1
		ELSE
			ASSI = A
		ENDIF
	ENDIF

	SIF Z == T
		TARGET = -1
	SIF Z == A
		ASSI = -1

ELSEIF RESULT == 1
	TARGET = T
	RETURN 0
ELSE
	GOTO INPUT_LOOPSALE
ENDIF


;-------------------------------------------------
;ビデオの重複使用を処理するために、予め値段の加算を行っておく
;-------------------------------------------------
@PRICE_VIDEO

P = 0

REPEAT TFLAG:70
	A = COUNT + 11
	SELECTCASE FLAG:A
		CASE 0,1,10,11,20,30,31,40,50,51,52,70,131,220,221,223,225,226,227,228,300 TO 306,314,315,316,318,319,400 TO 402,526,
			P += 100
		CASE 12,14,18,32,42,76,81 TO 83,152 TO 154,222,224,240,241,243,245,403,404,407,410 TO 412,500 TO 502
			P += 150
		CASE 13,15,21 TO 24,33 TO 36,44,53,54
			P += 200
		CASE 17,71 TO 75,77,80,84 TO 87,130,134 TO 142,144,150,242,246,244,280,282 TO 284,314,317,320,321,503,504,528
			P += 300
		CASE 3,8,100 TO 105,110 TO 115,263,264,281,285,311,313,405,406,420 TO 422,505,506,516
			P += 400
		CASE 4 TO 7,16,25,44,55,56,60 TO 62,106,116,143,145,151,155,160,161,180 TO 185,262,265 TO 271,286,511,512
			P += 500
		CASE 430,431,440,441,507 TO 510,513 TO 525
			P += 600
		CASE 340 TO 360,362 TO 364,366,367,380,382,517,518
			P += 700
		CASE 156,162,322,361,365,368 TO 370,381,383,390 TO 392,527
			P += 1000
		CASEELSE
			P += 10
	ENDSELECT
REND

;処女喪失シーンがあれば加算
IF TFLAG:39
	P += 5000
	PRINTFORML ビデオには%CALLNAME%の処女喪失シーンが記録されている
ENDIF

O = 100
;素質:処女を見る
SIF TALENT:処女
	O += 20
;素質:無関心を見る
SIF TALENT:無関心
	O -= 30
;素質:感情乏しいを見る
SIF TALENT:感情乏しい
	O -= 30
;素質:恥じらいを見る
SIF TALENT:恥じらい
	O += 10
;素質:小柄体系を見る
SIF TALENT:小柄体型
	O += 20
;素質:絶壁を見る
SIF TALENT:絶壁
	O -= 10
;素質:巨乳を見る
SIF TALENT:巨乳
	O += 20
;素質:爆乳を見る
SIF TALENT:爆乳
	O += 10
;素質:陥没乳首を見る
SIF TALENT:陥没乳首
	O += 10
;素質:動物耳を見る
SIF TALENT:動物耳
	O += 10
;素質:人気を見る
SIF TALENT:人気
	O += 20
;素質:謎の魅力を見る
SIF TALENT:謎の魅力
	O += 30
;素質:魅力を見る
SIF TALENT:魅力
	O += 20
;素質:発情期を見る
SIF TALENT:発情期
	O += 10
;-----------------------------------------------------------

;奴隷の被写経験を見る
SIF EXP:TARGET:被写経験 >= EXPLV:3
	O += 10

;撮影者を見る
;主人
IF FLAG:22 == 1
	;撮影技能を見る
	IF ABL:MASTER:撮影技能 >= 5
		O += 100
	ELSEIF ABL:MASTER:撮影技能 == 4
		O += 50
	ELSEIF ABL:MASTER:撮影技能 == 3
		O += 20
	ELSEIF ABL:MASTER:撮影技能 <= 1
		O -= 20
	ENDIF
;助手
ELSEIF FLAG:22 == 2
	;撮影技能を見る
	IF ABL:ASSI:撮影技能 >= 5
		O += 100
	ELSEIF ABL:ASSI:撮影技能 == 4
		O += 50
	ELSEIF ABL:ASSI:撮影技能 == 3
		O += 20
	ELSEIF ABL:ASSI:撮影技能 <= 1
		O -= 20
	ENDIF
ENDIF

;倍率処理
SIF O < 0
	O = 0

P *= O
P /= 100

;難易度処理
;EASY
IF FLAG:4 == 1
	TIMES P , 1.20
;NORMAL
ELSEIF FLAG:4 == 2
	TIMES P , 1.00
;HARD
ELSEIF FLAG:4 == 3
	TIMES P , 0.80
ENDIF

TFLAG:36 += P
TFLAG:70 = 0


;-------------------------------------------------
;調教時に録画したビデオの売却
;TODO 価格設定再考・状況による価格をプラスできるか(処女開通時など)
;-------------------------------------------------
@SELL_VIDEO

;撮影中のまま売却まで来た場合はテープの数を減らす
;テープの減数は撮影後処理のため、さらにビデオの値段および経験もここで処理をする
IF TEQUIP:ビデオカメラ
	CALL PRICE_VIDEO
ENDIF

;録画してなければ終了
SIF TFLAG:36 == 0
	RETURN 0


PRINTFORML 録画したビデオは{TFLAG:36}朱程度の値が付きそうだ
PRINTL 録画したビデオをどうするか選択してください
PRINTL [0] - 売る
PRINTL [1] - 手元に残す
DRAWLINE

$INPUT_LOOP
INPUT
IF RESULT == 0
	PRINTFORML 調教時に録画したビデオを売って、{TFLAG:36}朱手に入れました
	MONEY += TFLAG:36
	TFLAG:36 = 0
	;イベント口上呼び出し(ビデオ売却時）
	TFLAG:13 = 19
	CALL KOJO_MESSAGE_EVENT
ELSEIF RESULT == 1
	PRINTFORML 調教時に録画したビデオを手元に残しておいた
	CFLAG:20 += 1
	;イベント口上呼び出し(ビデオ保有時）23は朝飯で使用
	TFLAG:13 = 24
	CALL KOJO_MESSAGE_EVENT
ELSE
	GOTO INPUT_LOOP
ENDIF
DRAWLINE



;-------------------------------------------------
@PRICE_PICTURE
;-------------------------------------------------
A = 100
B = 0
C = 0

;調教者のABL:撮影技能をみる
IF ABL:PLAYER:13 == 0
	B = 10
ELSEIF ABL:PLAYER:撮影技能 == 1
	B = 100
ELSEIF ABL:PLAYER:撮影技能 == 2
	B = 150
ELSEIF ABL:PLAYER:撮影技能 == 3
	B = 250
ELSEIF ABL:PLAYER:撮影技能 == 4
	B = 300
ELSE
	B = 500
ENDIF

;口系
;ボールギャグ装着、触手口辱
IF TEQUIP:ボールギャグ || TEQUIP:触手口辱
	A += 20
	C += 1
ENDIF
;Ａ系
;ローターＡ挿入、アナルバイブ装着、アナルビーズ装着、バルーン装着
IF TEQUIP:ローターＡ挿入 || TEQUIP:アナルバイブ || TEQUIP:アナルビーズ || TEQUIP:拡張バルーン
	A += 10
	C += 1
ENDIF
;Ｃ系
;クリキャップ装着、電動オナホール装着、陰核クリップ
IF TEQUIP:クリキャップ || TEQUIP:電動オナホール || TEQUIP:陰核クリップ
	A += 10
	C += 1
ENDIF
;Ｂ系
;二プルキャップ装着、搾乳機、乳首クリップ
IF TEQUIP:ニプルキャップ || TEQUIP:搾乳機 || TEQUIP:乳首クリップ
	A += 15
	C += 1
ENDIF
;Ｖ系
;バイブ装着、ローター挿入
IF TEQUIP:バイブ || TEQUIP:ローター挿入
	A += 15
	C += 1
ENDIF
;緊縛系
;アイマスク装着
IF TEQUIP:アイマスク
	A += 20
	C += 1
ENDIF
;縄で緊縛
IF TEQUIP:縄
	A += 25
	C += 1
ENDIF
;薬剤系
;媚薬、利尿剤
IF TEQUIP:媚薬 || TEQUIP:利尿剤
	A += 5
	C += 1
ENDIF
;場所系
;野外プレイ、羞恥プレイ中、お風呂場プレイ
IF TEQUIP:野外プレイ || TEQUIP:羞恥プレイ || TEQUIP:お風呂場
	A += 20
	C += 1
ENDIF
;状況系
;シャワー、ビデオ撮影
IF TEQUIP:シャワー || TEQUIP:ビデオカメラ
	A += 10
	C += 1
ENDIF
;触手調教
IF TEQUIP:触手
	A += 5
	C += 1
ENDIF
;着衣系他
;新妻プレイ中
IF TEQUIP:エプロン
	A += 10
	C += 1
ENDIF
;何も装着していない場合のボーナス
SIF C == 0
	A += 50

;精液の補正を設定するためCをリセット
C = 0
;精液の汚れ(口、手、ペニス、ヴァギナ、アナルの順)
SIF STAIN:PLAYER:口 & 4
	C += 1
SIF STAIN:PLAYER:手 & 4
	C += 1
SIF STAIN:PLAYER:ペニス & 4
	C += 1
SIF STAIN:PLAYER:ヴァギナ & 4
	C += 1
SIF STAIN:PLAYER:アナル & 4
	C += 1
;精液の汚れがない場合のボーナス
SIF C == 0
	A += 30


;素質:無関心を見る
SIF TALENT:無関心
	A -= 30
;素質:感情乏しいを見る
SIF TALENT:感情乏しい
	A -= 30
;素質:恥じらいを見る
SIF TALENT:恥じらい
	A += 10
;素質:小柄体系を見る
SIF TALENT:小柄体型
	A += 20
;素質:絶壁を見る
SIF TALENT:絶壁
	A -= 10
;素質:巨乳を見る
SIF TALENT:巨乳
	A += 20
;素質:爆乳を見る
SIF TALENT:爆乳
	A += 10
;素質:陥没乳首を見る
SIF TALENT:陥没乳首
	A += 10
;素質:動物耳を見る
SIF TALENT:動物耳
	A += 10
;素質:人気を見る
SIF TALENT:人気
	A += 20
;素質:謎の魅力を見る
SIF TALENT:謎の魅力
	A += 30
;素質:魅力を見る
SIF TALENT:魅力
	A += 20
;素質:発情期を見る
SIF TALENT:発情期
	A += 10

SIF A < 0
	A = 0

B *= A
B /= 100

;難易度処理
;EASY
IF FLAG:4 == 1
	TIMES B , 1.20
;NORMAL
ELSEIF FLAG:4 == 2
	TIMES B , 1.00
;HARD
ELSEIF FLAG:4 == 3
	TIMES B , 0.80
ENDIF

TFLAG:37 += B


;-------------------------------------------------
@SELL_PICTURE
;-------------------------------------------------
SIF TFLAG:73 == 0
	RETURN 0
SIF TFLAG:37 <= 0
	RETURN 0

PRINTFORMW 今回撮った{TFLAG:73}枚の写真には{TFLAG:37}の買値が付いた
MONEY += TFLAG:37

;フラグリセット。これで調教メニュー以外でも再利用できるように
TFLAG:37 = 0
TFLAG:73 = 0


;-------------------------------------------------
@SELL_MILK
;-------------------------------------------------
O = TFLAG:35 * 100
IF O > 0
	IF EXP:噴乳経験 <= EXPLV:0
		O *= 1
	ELSEIF EXP:噴乳経験 <= EXPLV:1
		O *= 2
	ELSEIF EXP:噴乳経験 <= EXPLV:2
		O *= 3
	ELSEIF EXP:噴乳経験 <= EXPLV:3
		O *= 4
	ELSEIF EXP:噴乳経験 <= EXPLV:4
		O *= 5
	ELSE
		O *= 6
	ENDIF

	;難易度処理
	;EASY
	IF FLAG:4 == 1
		TIMES O , 1.20
	;NORMAL
	ELSEIF FLAG:4 == 2
		TIMES O , 1.00
	;HARD
	ELSEIF FLAG:4 == 3
		TIMES O , 0.80
	ENDIF

	PRINTFORML 搾乳機を使って%CALLNAME%から母乳を搾り出した
	PRINTFORMW %CALLNAME%の母乳には{O}の買値が付いた
	MONEY += O
	PRINTFORMW 所持甲州金 {O}増加
ENDIF

