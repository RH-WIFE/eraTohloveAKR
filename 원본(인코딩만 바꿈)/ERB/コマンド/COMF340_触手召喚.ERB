;-------------------------------------------------
;触手召喚
;触手系コマンド
;-------------------------------------------------
@COM340

PRINTL 触手召喚
STR:0 = 触手召喚
CALL KOJO_MESSAGE_COM

;ストッキングびりびりフラグ
IF TEQUIP:特殊２ == 5 || TEQUIP:特殊２ == 6
	TFLAG:55 = 1
ENDIF

;着脱の処理
IF TEQUIP:触手 == 0
	TEQUIP:触手 = 1
	;触手系コマンドに影響する装備は外す（道具が触手扱いになるため）
	TEQUIP:ニプルキャップ = 0
	TEQUIP:クリキャップ = 0
	TEQUIP:電動オナホール = 0
	TEQUIP:バイブ = 0
	TEQUIP:アナルバイブ = 0
	TEQUIP:搾乳機 = 0
	TEQUIP:縄 = 0
	TEQUIP:ボールギャグ = 0
	TEQUIP:カテーテル = 0
;触手解除時はソース、経験の加算は行わず終了する
ELSE
	TEQUIP:触手 = 0
	;触手系コマンドの装備も解除する
	TEQUIP:ニプルキャップ = 0
	TEQUIP:クリキャップ = 0
	TEQUIP:電動オナホール = 0
	TEQUIP:バイブ = 0
	TEQUIP:アナルバイブ = 0
	TEQUIP:搾乳機 = 0
	TEQUIP:縄 = 0
	TEQUIP:触手口辱 = 0
	TEQUIP:カテーテル = 0
	RETURN 1
ENDIF



;-------------------------------------------------
;ソース追加処理
;-------------------------------------------------
;消費体力、気力
LOSEBASE:体力 += 10
LOSEBASE:気力 += 150

IF EXP:触手経験 < EXPLV:1
	TIMES LOSEBASE:体力 , 1.10
	TIMES LOSEBASE:気力 , 2.00
ELSEIF EXP:触手経験 < EXPLV:2
	TIMES LOSEBASE:体力 , 0.90
	TIMES LOSEBASE:気力 , 1.80
ELSEIF EXP:触手経験 < EXPLV:3
	TIMES LOSEBASE:体力 , 0.80
	TIMES LOSEBASE:気力 , 1.50
ELSEIF EXP:触手経験 < EXPLV:4
	TIMES LOSEBASE:体力 , 0.70
	TIMES LOSEBASE:気力 , 1.20
ELSEIF EXP:触手経験 < EXPLV:5
	TIMES LOSEBASE:体力 , 0.60
	TIMES LOSEBASE:気力 , 1.00
ELSE
	TIMES LOSEBASE:体力 , 0.50
	TIMES LOSEBASE:気力 , 0.50
ENDIF

SOURCE:恐れ += 2500
SOURCE:逸脱 += 2500
SOURCE:反発 += 2500


;-------------------------------------------------
;特殊ソース処理
;-------------------------------------------------
;触手経験は先に見ておく
IF EXP:触手経験 < EXPLV:1
	TIMES SOURCE:恐れ , 1.20
	TIMES SOURCE:逸脱 , 1.20
	TIMES SOURCE:反発 , 1.20
ELSEIF EXP:触手経験 < EXPLV:2
	TIMES SOURCE:恐れ , 0.90
	TIMES SOURCE:逸脱 , 0.90
	TIMES SOURCE:反発 , 0.90
ELSEIF EXP:触手経験 < EXPLV:3
	TIMES SOURCE:恐れ , 0.80
	TIMES SOURCE:逸脱 , 0.80
	TIMES SOURCE:反発 , 0.80
ELSEIF EXP:触手経験 < EXPLV:4
	TIMES SOURCE:恐れ , 0.70
	TIMES SOURCE:逸脱 , 0.70
	TIMES SOURCE:反発 , 0.70
ELSEIF EXP:触手経験 < EXPLV:5
	TIMES SOURCE:恐れ , 0.60
	TIMES SOURCE:逸脱 , 0.60
	TIMES SOURCE:反発 , 0.60
ELSE
	TIMES SOURCE:恐れ , 0.50
	TIMES SOURCE:逸脱 , 0.50
	TIMES SOURCE:反発 , 0.50
ENDIF


;-------------------------------------------------
;経験の処理
;-------------------------------------------------
IF EXP:触手経験 == 0
	EXP:異常経験 += 1
	PRINTL 触手初経験で異常経験＋1
ENDIF
PRINT 触手経験＋1
EXP:触手経験 += 1


RETURN 1




;-------------------------------------------------
;装着継続の処理
;-------------------------------------------------
@EQUIP_COM340
;触手召喚中
PRINTL ＜触手召喚中＞

;-------------------------------------------------
;ソース追加処理
;-------------------------------------------------
;消費体力、気力
LOSEBASE:体力 += 5
LOSEBASE:気力 += 50

SOURCE:恐れ += 1000
SOURCE:逸脱 += 1000
SOURCE:反発 += 1000


;-------------------------------------------------
;射精チェック
;-------------------------------------------------
IF MAXBASE:MASTER:尿意 != 0
	B = 1000
	;ABL:技巧をみる
	IF ABL:技巧 == 0
		TIMES B , 1.00
	ELSEIF ABL:技巧 == 1
		TIMES B , 1.10
	ELSEIF ABL:技巧 == 2
		TIMES B , 1.20
	ELSEIF ABL:技巧 == 3
		TIMES B , 1.30
	ELSEIF ABL:技巧 == 4
		TIMES B , 1.40
	ELSE
		TIMES B , 1.50
	ENDIF

	;ABL:従順をみる
	IF ABL:従順 == 0
		TIMES B , 0.80
	ELSEIF ABL:従順 == 1
		TIMES B , 0.90
	ELSEIF ABL:従順 == 2
		TIMES B , 1.00
	ELSEIF ABL:従順 == 3
		TIMES B , 1.10
	ELSEIF ABL:従順 == 4
		TIMES B , 1.20
	ELSE
		TIMES B , 1.30
	ENDIF

	;PALAM:欲情をみる
	IF PALAM:欲情 < PALAMLV:1
		TIMES B , 1.00
	ELSEIF PALAM:欲情 < PALAMLV:2
		TIMES B , 1.10
	ELSEIF PALAM:欲情 < PALAMLV:3
		TIMES B , 1.20
	ELSEIF PALAM:欲情 < PALAMLV:4
		TIMES B , 1.30
	ELSEIF PALAM:欲情 < PALAMLV:5
		TIMES B , 1.40
	ELSE
		TIMES B , 1.50
	ENDIF

	;触手挿入
	SIF TEQUIP:バイブ
		TIMES B , 1.50
	;アナル触手
	SIF TEQUIP:アナルバイブ
		TIMES B , 1.50
	;触手クリ責め
	SIF TEQUIP:クリキャップ
		TIMES B , 1.20
	;触手乳首責め
	SIF TEQUIP:ニプルキャップ
		TIMES B , 1.20
	;触手搾乳
	SIF TEQUIP:搾乳機
		TIMES B , 1.30
	;触手ペニス責め
	SIF TEQUIP:電動オナホール
		TIMES B , 1.10
	;触手緊縛
	SIF TEQUIP:縄
		TIMES B , 1.20
	;触手口辱
	SIF TEQUIP:触手口辱
		TIMES B , 1.50
	;触手尿道挿入
	SIF TEQUIP:カテーテル
		TIMES B , 1.50

	BASE:MASTER:尿意 += B
ENDIF
;-------------------------------------------------
;特殊ソース処理
;-------------------------------------------------
;触手経験は先に見ておく
IF EXP:触手経験 < EXPLV:1
	TIMES LOSEBASE:体力 , 1.20
	TIMES LOSEBASE:気力 , 1.20
	TIMES SOURCE:恐れ , 1.20
	TIMES SOURCE:逸脱 , 1.20
	TIMES SOURCE:反発 , 1.20
ELSEIF EXP:触手経験 < EXPLV:2
	TIMES LOSEBASE:体力 , 0.90
	TIMES LOSEBASE:気力 , 0.90
	TIMES SOURCE:恐れ , 0.90
	TIMES SOURCE:逸脱 , 0.90
	TIMES SOURCE:反発 , 0.90
ELSEIF EXP:触手経験 < EXPLV:3
	TIMES LOSEBASE:体力 , 0.80
	TIMES LOSEBASE:気力 , 0.80
	TIMES SOURCE:恐れ , 0.80
	TIMES SOURCE:逸脱 , 0.80
	TIMES SOURCE:反発 , 0.80
ELSEIF EXP:触手経験 < EXPLV:4
	TIMES LOSEBASE:体力 , 0.70
	TIMES LOSEBASE:気力 , 0.70
	TIMES SOURCE:恐れ , 0.70
	TIMES SOURCE:逸脱 , 0.70
	TIMES SOURCE:反発 , 0.70
ELSEIF EXP:触手経験 < EXPLV:5
	TIMES LOSEBASE:体力 , 0.60
	TIMES LOSEBASE:気力 , 0.60
	TIMES SOURCE:恐れ , 0.60
	TIMES SOURCE:逸脱 , 0.60
	TIMES SOURCE:反発 , 0.60
ELSE
	TIMES LOSEBASE:体力 , 0.50
	TIMES LOSEBASE:気力 , 0.50
	TIMES SOURCE:恐れ , 0.50
	TIMES SOURCE:逸脱 , 0.50
	TIMES SOURCE:反発 , 0.50
ENDIF


;-------------------------------------------------
;射精チェック
;-------------------------------------------------
S = BASE:MASTER:尿意
EJAC = MAXBASE:MASTER:尿意

IF  S > EJAC * 2
	E = 2
ELSEIF S > EJAC
	E = 1
ELSE
	E = 0
ENDIF

;射精時に中毒充足のソースを追加、なお触手は射精の再装填は無し
;通常射精時
SIF E == 1
	A = 200
;大量射精時
SIF E == 2
	A = 500

IF E > 0
	;精液中毒を見る
	IF ABL:精液中毒 == 1
		TIMES A , 0.00
	ELSEIF ABL:精液中毒 == 2
		TIMES A , 0.30
	ELSEIF ABL:精液中毒 == 3
		TIMES A , 0.60
	ELSEIF ABL:精液中毒 == 4
		TIMES A , 0.90
	ELSEIF ABL:精液中毒 == 5
		TIMES A , 1.20
	ELSEIF ABL:精液中毒 == 6
		TIMES A , 1.50
	ELSEIF ABL:精液中毒 == 7
		TIMES A , 1.80
	ELSEIF ABL:精液中毒 == 8
		TIMES A , 2.30
	ELSEIF ABL:精液中毒 == 9
		TIMES A , 3.00
	ELSEIF ABL:精液中毒 >= 10
		TIMES A , 5.00
	ENDIF
ENDIF

SOURCE:中毒充足 += A

;射精時の処理
;大量射精
IF E == 2
	EXP:精液経験 += 3
	PRINTL 触手大量射精
	PRINTL 精液経験＋３
	T += 1

	BASE:MASTER:尿意 -= EJAC*2
	SIF BASE:MASTER:尿意 >= EJAC
		BASE:MASTER:尿意 = EJAC-1

;通常の射精
ELSEIF E == 1
	EXP:精液経験 += 1
	PRINTL 触手射精
	PRINTL 精液経験＋１
	T += 1

	BASE:MASTER:尿意 -= EJAC
	SIF BASE:MASTER:尿意 >= EJAC
		BASE:MASTER:尿意 = EJAC-1
ENDIF

;-------------------------------------------------
;汚れの処理
;-------------------------------------------------
;触手が射精した場合の粘液汚れ
IF E > 0
	;触手挿入
	IF TEQUIP:バイブ
		STAIN:膣内 |= 32
		STAIN:ヴァギナ |= 32
	ENDIF
	;アナル触手
	IF TEQUIP:アナルバイブ
		STAIN:腸内 |= 32
		STAIN:アナル |= 32
	ENDIF
	;触手クリ責め
	SIF TEQUIP:クリキャップ
		STAIN:ヴァギナ |= 32
	;触手乳首責め、触手搾乳
	SIF TEQUIP:ニプルキャップ || TEQUIP:搾乳機
		STAIN:胸 |= 32
	;触手ペニス責め
	SIF TEQUIP:電動オナホール
		STAIN:ペニス |= 32
	;触手緊縛（全身にぶっかけるイメージ）
	IF TEQUIP:縄
		STAIN:手 |= 32
		;ペニスがあればペニス、なければヴァギナへ
		IF PENIS(TARGET)
			STAIN:ペニス |= 32
		ELSE
			STAIN:ヴァギナ |= 32
		ENDIF
		STAIN:胸 |= 32
		STAIN:髪 |= 32
	ENDIF
	;触手口辱
	SIF TEQUIP:触手口辱
		STAIN:口 |= 32
	;触手尿道挿入
	IF TEQUIP:カテーテル
		;ペニスがあればペニス、なければヴァギナへ
		IF PENIS(TARGET)
			STAIN:ペニス |= 32
		ELSE
			STAIN:ヴァギナ |= 32
		ENDIF
	ENDIF
	
	;服を着てたら全部汚しちゃいます
	SIF TEQUIP:特殊１ == 1
		STAIN:手袋 |= 32
	SIF TEQUIP:特殊２
		STAIN:足装飾 |= 32
	SIF TEQUIP:下着（下） == 5
		STAIN:下着（下） |= 32
	SIF TEQUIP:頭部装飾
		STAIN:頭部装飾 |= 32
	SIF TEQUIP:特殊３
		STAIN:目装飾 |= 32
	SIF TEQUIP:靴
		STAIN:靴 |= 32
ENDIF


;-------------------------------------------------
;経験の処理
;-------------------------------------------------
;各触手派生コマンドから集めた触手経験を一括処理
T += 1
PRINT 触手経験＋
PRINTVL T
EXP:触手経験 += T
T = 0

;触手装着中は依存度ベクトル強制変更
;依存度ベクトル
TFLAG:33 = 5

;依存度補正値(服従で1、隷属で2　強制変更なので、これまでの数値をリセット）
IF TALENT:服従 && ASSIPLAY == 0
	TFLAG:30 = 2
ELSEIF TALENT:隷属 && ASSIPLAY == 0
	TFLAG:30 = 4
ENDIF


RETURN 1





;-------------------------------------------------
;派生コマンドの処理
;-------------------------------------------------
@COM341
;触手乳首責め
JUMP COM13
RETURN 1


@COM342
;触手クリ責め
JUMP COM22
RETURN 1


@COM343
;触手ペニス責め
JUMP COM32
RETURN 1


@COM344
;触手挿入
JUMP COM43
RETURN 1


@COM345
;触手アナル
JUMP COM54
RETURN 1


@COM350
;触手口辱
PRINTL 触手口辱
STR:0 = 触手口辱
SELECTCOM = 350
CALL KOJO_MESSAGE_COM

;着脱の処理
IF TEQUIP:触手口辱 == 0
	TEQUIP:触手口辱 = 1
	
	;汚れの付加
	STAIN:口 |= 32
ELSE
	TEQUIP:触手口辱 = 0
ENDIF


@COM351
;触手緊縛
JUMP COM130
RETURN 1


@COM352
;触手浣腸
JUMP COM180
RETURN 1


@COM360
;触手搾乳
JUMP COM17
RETURN 1


@COM365
;触手尿道挿入
JUMP COM60
RETURN 1


;-------------------------------------------------
;ソース追加処理
;-------------------------------------------------
LOSEBASE:体力 += 30
LOSEBASE:気力 += 50

SOURCE:性行動 += 200
SOURCE:屈従 += 1000
SOURCE:逸脱 += 1000


;-------------------------------------------------
;汚れの処理
;-------------------------------------------------
SIF TEQUIP:触手口辱 == 1
	STAIN:口 |= 32


;-------------------------------------------------
;経験の処理
;-------------------------------------------------
;触手経験のリセット
T = 0

;フェラ経験
EXP:フェラ経験 += 1
PRINTL フェラ経験＋１
RETURN 1

;-------------------------------------------------
;装着継続の処理
;-------------------------------------------------
@EQUIP_COM350
;触手口辱中
PRINTL ＜触手口辱中＞

LOSEBASE:体力 += 5
LOSEBASE:気力 += 30

SOURCE:性行動 += 100
SOURCE:屈従 += 700
SOURCE:逸脱 += 700


;-------------------------------------------------
;経験の処理
;-------------------------------------------------
;フェラ経験
EXP:フェラ経験 += 1
PRINTL フェラ経験＋１

;触手経験加算
T += 1


RETURN 1


